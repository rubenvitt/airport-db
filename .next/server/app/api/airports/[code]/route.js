/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(() => {
var exports = {};
exports.id = "app/api/airports/[code]/route";
exports.ids = ["app/api/airports/[code]/route"];
exports.modules = {

/***/ "ioredis":
/*!**************************!*\
  !*** external "ioredis" ***!
  \**************************/
/***/ ((module) => {

"use strict";
module.exports = require("ioredis");

/***/ }),

/***/ "next/dist/compiled/next-server/app-page.runtime.dev.js":
/*!*************************************************************************!*\
  !*** external "next/dist/compiled/next-server/app-page.runtime.dev.js" ***!
  \*************************************************************************/
/***/ ((module) => {

"use strict";
module.exports = require("next/dist/compiled/next-server/app-page.runtime.dev.js");

/***/ }),

/***/ "next/dist/compiled/next-server/app-route.runtime.dev.js":
/*!**************************************************************************!*\
  !*** external "next/dist/compiled/next-server/app-route.runtime.dev.js" ***!
  \**************************************************************************/
/***/ ((module) => {

"use strict";
module.exports = require("next/dist/compiled/next-server/app-route.runtime.dev.js");

/***/ }),

/***/ "../app-render/after-task-async-storage.external":
/*!***********************************************************************************!*\
  !*** external "next/dist/server/app-render/after-task-async-storage.external.js" ***!
  \***********************************************************************************/
/***/ ((module) => {

"use strict";
module.exports = require("next/dist/server/app-render/after-task-async-storage.external.js");

/***/ }),

/***/ "../app-render/work-async-storage.external":
/*!*****************************************************************************!*\
  !*** external "next/dist/server/app-render/work-async-storage.external.js" ***!
  \*****************************************************************************/
/***/ ((module) => {

"use strict";
module.exports = require("next/dist/server/app-render/work-async-storage.external.js");

/***/ }),

/***/ "./work-unit-async-storage.external":
/*!**********************************************************************************!*\
  !*** external "next/dist/server/app-render/work-unit-async-storage.external.js" ***!
  \**********************************************************************************/
/***/ ((module) => {

"use strict";
module.exports = require("next/dist/server/app-render/work-unit-async-storage.external.js");

/***/ }),

/***/ "crypto":
/*!*************************!*\
  !*** external "crypto" ***!
  \*************************/
/***/ ((module) => {

"use strict";
module.exports = require("crypto");

/***/ }),

/***/ "fs":
/*!*********************!*\
  !*** external "fs" ***!
  \*********************/
/***/ ((module) => {

"use strict";
module.exports = require("fs");

/***/ }),

/***/ "fs/promises":
/*!******************************!*\
  !*** external "fs/promises" ***!
  \******************************/
/***/ ((module) => {

"use strict";
module.exports = require("fs/promises");

/***/ }),

/***/ "os":
/*!*********************!*\
  !*** external "os" ***!
  \*********************/
/***/ ((module) => {

"use strict";
module.exports = require("os");

/***/ }),

/***/ "path":
/*!***********************!*\
  !*** external "path" ***!
  \***********************/
/***/ ((module) => {

"use strict";
module.exports = require("path");

/***/ }),

/***/ "(rsc)/./node_modules/.pnpm/next@15.1.5_@babel+core@7.27.4_react-dom@19.1.0_react@19.1.0__react@19.1.0/node_modules/next/dist/build/webpack/loaders/next-app-loader/index.js?name=app%2Fapi%2Fairports%2F%5Bcode%5D%2Froute&page=%2Fapi%2Fairports%2F%5Bcode%5D%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fairports%2F%5Bcode%5D%2Froute.ts&appDir=%2FUsers%2Frubeen%2Fdev%2Fpersonal%2Fairport-db%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2FUsers%2Frubeen%2Fdev%2Fpersonal%2Fairport-db&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!":
/*!*********************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/.pnpm/next@15.1.5_@babel+core@7.27.4_react-dom@19.1.0_react@19.1.0__react@19.1.0/node_modules/next/dist/build/webpack/loaders/next-app-loader/index.js?name=app%2Fapi%2Fairports%2F%5Bcode%5D%2Froute&page=%2Fapi%2Fairports%2F%5Bcode%5D%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fairports%2F%5Bcode%5D%2Froute.ts&appDir=%2FUsers%2Frubeen%2Fdev%2Fpersonal%2Fairport-db%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2FUsers%2Frubeen%2Fdev%2Fpersonal%2Fairport-db&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D! ***!
  \*********************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************/
/***/ ((module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.a(module, async (__webpack_handle_async_dependencies__, __webpack_async_result__) => { try {\n__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   patchFetch: () => (/* binding */ patchFetch),\n/* harmony export */   routeModule: () => (/* binding */ routeModule),\n/* harmony export */   serverHooks: () => (/* binding */ serverHooks),\n/* harmony export */   workAsyncStorage: () => (/* binding */ workAsyncStorage),\n/* harmony export */   workUnitAsyncStorage: () => (/* binding */ workUnitAsyncStorage)\n/* harmony export */ });\n/* harmony import */ var next_dist_server_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/dist/server/route-modules/app-route/module.compiled */ \"(rsc)/./node_modules/.pnpm/next@15.1.5_@babel+core@7.27.4_react-dom@19.1.0_react@19.1.0__react@19.1.0/node_modules/next/dist/server/route-modules/app-route/module.compiled.js\");\n/* harmony import */ var next_dist_server_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var next_dist_server_route_kind__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next/dist/server/route-kind */ \"(rsc)/./node_modules/.pnpm/next@15.1.5_@babel+core@7.27.4_react-dom@19.1.0_react@19.1.0__react@19.1.0/node_modules/next/dist/server/route-kind.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! next/dist/server/lib/patch-fetch */ \"(rsc)/./node_modules/.pnpm/next@15.1.5_@babel+core@7.27.4_react-dom@19.1.0_react@19.1.0__react@19.1.0/node_modules/next/dist/server/lib/patch-fetch.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var _Users_rubeen_dev_personal_airport_db_app_api_airports_code_route_ts__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./app/api/airports/[code]/route.ts */ \"(rsc)/./app/api/airports/[code]/route.ts\");\nvar __webpack_async_dependencies__ = __webpack_handle_async_dependencies__([_Users_rubeen_dev_personal_airport_db_app_api_airports_code_route_ts__WEBPACK_IMPORTED_MODULE_3__]);\n_Users_rubeen_dev_personal_airport_db_app_api_airports_code_route_ts__WEBPACK_IMPORTED_MODULE_3__ = (__webpack_async_dependencies__.then ? (await __webpack_async_dependencies__)() : __webpack_async_dependencies__)[0];\n\n\n\n\n// We inject the nextConfigOutput here so that we can use them in the route\n// module.\nconst nextConfigOutput = \"\"\nconst routeModule = new next_dist_server_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__.AppRouteRouteModule({\n    definition: {\n        kind: next_dist_server_route_kind__WEBPACK_IMPORTED_MODULE_1__.RouteKind.APP_ROUTE,\n        page: \"/api/airports/[code]/route\",\n        pathname: \"/api/airports/[code]\",\n        filename: \"route\",\n        bundlePath: \"app/api/airports/[code]/route\"\n    },\n    resolvedPagePath: \"/Users/rubeen/dev/personal/airport-db/app/api/airports/[code]/route.ts\",\n    nextConfigOutput,\n    userland: _Users_rubeen_dev_personal_airport_db_app_api_airports_code_route_ts__WEBPACK_IMPORTED_MODULE_3__\n});\n// Pull out the exports that we need to expose from the module. This should\n// be eliminated when we've moved the other routes to the new format. These\n// are used to hook into the route.\nconst { workAsyncStorage, workUnitAsyncStorage, serverHooks } = routeModule;\nfunction patchFetch() {\n    return (0,next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__.patchFetch)({\n        workAsyncStorage,\n        workUnitAsyncStorage\n    });\n}\n\n\n//# sourceMappingURL=app-route.js.map\n__webpack_async_result__();\n} catch(e) { __webpack_async_result__(e); } });//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvLnBucG0vbmV4dEAxNS4xLjVfQGJhYmVsK2NvcmVANy4yNy40X3JlYWN0LWRvbUAxOS4xLjBfcmVhY3RAMTkuMS4wX19yZWFjdEAxOS4xLjAvbm9kZV9tb2R1bGVzL25leHQvZGlzdC9idWlsZC93ZWJwYWNrL2xvYWRlcnMvbmV4dC1hcHAtbG9hZGVyL2luZGV4LmpzP25hbWU9YXBwJTJGYXBpJTJGYWlycG9ydHMlMkYlNUJjb2RlJTVEJTJGcm91dGUmcGFnZT0lMkZhcGklMkZhaXJwb3J0cyUyRiU1QmNvZGUlNUQlMkZyb3V0ZSZhcHBQYXRocz0mcGFnZVBhdGg9cHJpdmF0ZS1uZXh0LWFwcC1kaXIlMkZhcGklMkZhaXJwb3J0cyUyRiU1QmNvZGUlNUQlMkZyb3V0ZS50cyZhcHBEaXI9JTJGVXNlcnMlMkZydWJlZW4lMkZkZXYlMkZwZXJzb25hbCUyRmFpcnBvcnQtZGIlMkZhcHAmcGFnZUV4dGVuc2lvbnM9dHN4JnBhZ2VFeHRlbnNpb25zPXRzJnBhZ2VFeHRlbnNpb25zPWpzeCZwYWdlRXh0ZW5zaW9ucz1qcyZyb290RGlyPSUyRlVzZXJzJTJGcnViZWVuJTJGZGV2JTJGcGVyc29uYWwlMkZhaXJwb3J0LWRiJmlzRGV2PXRydWUmdHNjb25maWdQYXRoPXRzY29uZmlnLmpzb24mYmFzZVBhdGg9JmFzc2V0UHJlZml4PSZuZXh0Q29uZmlnT3V0cHV0PSZwcmVmZXJyZWRSZWdpb249Jm1pZGRsZXdhcmVDb25maWc9ZTMwJTNEISIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7Ozs7OztBQUErRjtBQUN2QztBQUNxQjtBQUNzQjtBQUNuRztBQUNBO0FBQ0E7QUFDQSx3QkFBd0IseUdBQW1CO0FBQzNDO0FBQ0EsY0FBYyxrRUFBUztBQUN2QjtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0EsWUFBWTtBQUNaLENBQUM7QUFDRDtBQUNBO0FBQ0E7QUFDQSxRQUFRLHNEQUFzRDtBQUM5RDtBQUNBLFdBQVcsNEVBQVc7QUFDdEI7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUMwRjs7QUFFMUYscUMiLCJzb3VyY2VzIjpbIiJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBBcHBSb3V0ZVJvdXRlTW9kdWxlIH0gZnJvbSBcIm5leHQvZGlzdC9zZXJ2ZXIvcm91dGUtbW9kdWxlcy9hcHAtcm91dGUvbW9kdWxlLmNvbXBpbGVkXCI7XG5pbXBvcnQgeyBSb3V0ZUtpbmQgfSBmcm9tIFwibmV4dC9kaXN0L3NlcnZlci9yb3V0ZS1raW5kXCI7XG5pbXBvcnQgeyBwYXRjaEZldGNoIGFzIF9wYXRjaEZldGNoIH0gZnJvbSBcIm5leHQvZGlzdC9zZXJ2ZXIvbGliL3BhdGNoLWZldGNoXCI7XG5pbXBvcnQgKiBhcyB1c2VybGFuZCBmcm9tIFwiL1VzZXJzL3J1YmVlbi9kZXYvcGVyc29uYWwvYWlycG9ydC1kYi9hcHAvYXBpL2FpcnBvcnRzL1tjb2RlXS9yb3V0ZS50c1wiO1xuLy8gV2UgaW5qZWN0IHRoZSBuZXh0Q29uZmlnT3V0cHV0IGhlcmUgc28gdGhhdCB3ZSBjYW4gdXNlIHRoZW0gaW4gdGhlIHJvdXRlXG4vLyBtb2R1bGUuXG5jb25zdCBuZXh0Q29uZmlnT3V0cHV0ID0gXCJcIlxuY29uc3Qgcm91dGVNb2R1bGUgPSBuZXcgQXBwUm91dGVSb3V0ZU1vZHVsZSh7XG4gICAgZGVmaW5pdGlvbjoge1xuICAgICAgICBraW5kOiBSb3V0ZUtpbmQuQVBQX1JPVVRFLFxuICAgICAgICBwYWdlOiBcIi9hcGkvYWlycG9ydHMvW2NvZGVdL3JvdXRlXCIsXG4gICAgICAgIHBhdGhuYW1lOiBcIi9hcGkvYWlycG9ydHMvW2NvZGVdXCIsXG4gICAgICAgIGZpbGVuYW1lOiBcInJvdXRlXCIsXG4gICAgICAgIGJ1bmRsZVBhdGg6IFwiYXBwL2FwaS9haXJwb3J0cy9bY29kZV0vcm91dGVcIlxuICAgIH0sXG4gICAgcmVzb2x2ZWRQYWdlUGF0aDogXCIvVXNlcnMvcnViZWVuL2Rldi9wZXJzb25hbC9haXJwb3J0LWRiL2FwcC9hcGkvYWlycG9ydHMvW2NvZGVdL3JvdXRlLnRzXCIsXG4gICAgbmV4dENvbmZpZ091dHB1dCxcbiAgICB1c2VybGFuZFxufSk7XG4vLyBQdWxsIG91dCB0aGUgZXhwb3J0cyB0aGF0IHdlIG5lZWQgdG8gZXhwb3NlIGZyb20gdGhlIG1vZHVsZS4gVGhpcyBzaG91bGRcbi8vIGJlIGVsaW1pbmF0ZWQgd2hlbiB3ZSd2ZSBtb3ZlZCB0aGUgb3RoZXIgcm91dGVzIHRvIHRoZSBuZXcgZm9ybWF0LiBUaGVzZVxuLy8gYXJlIHVzZWQgdG8gaG9vayBpbnRvIHRoZSByb3V0ZS5cbmNvbnN0IHsgd29ya0FzeW5jU3RvcmFnZSwgd29ya1VuaXRBc3luY1N0b3JhZ2UsIHNlcnZlckhvb2tzIH0gPSByb3V0ZU1vZHVsZTtcbmZ1bmN0aW9uIHBhdGNoRmV0Y2goKSB7XG4gICAgcmV0dXJuIF9wYXRjaEZldGNoKHtcbiAgICAgICAgd29ya0FzeW5jU3RvcmFnZSxcbiAgICAgICAgd29ya1VuaXRBc3luY1N0b3JhZ2VcbiAgICB9KTtcbn1cbmV4cG9ydCB7IHJvdXRlTW9kdWxlLCB3b3JrQXN5bmNTdG9yYWdlLCB3b3JrVW5pdEFzeW5jU3RvcmFnZSwgc2VydmVySG9va3MsIHBhdGNoRmV0Y2gsICB9O1xuXG4vLyMgc291cmNlTWFwcGluZ1VSTD1hcHAtcm91dGUuanMubWFwIl0sIm5hbWVzIjpbXSwiaWdub3JlTGlzdCI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/.pnpm/next@15.1.5_@babel+core@7.27.4_react-dom@19.1.0_react@19.1.0__react@19.1.0/node_modules/next/dist/build/webpack/loaders/next-app-loader/index.js?name=app%2Fapi%2Fairports%2F%5Bcode%5D%2Froute&page=%2Fapi%2Fairports%2F%5Bcode%5D%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fairports%2F%5Bcode%5D%2Froute.ts&appDir=%2FUsers%2Frubeen%2Fdev%2Fpersonal%2Fairport-db%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2FUsers%2Frubeen%2Fdev%2Fpersonal%2Fairport-db&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!\n");

/***/ }),

/***/ "(rsc)/./node_modules/.pnpm/next@15.1.5_@babel+core@7.27.4_react-dom@19.1.0_react@19.1.0__react@19.1.0/node_modules/next/dist/build/webpack/loaders/next-flight-client-entry-loader.js?server=true!":
/*!****************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/.pnpm/next@15.1.5_@babel+core@7.27.4_react-dom@19.1.0_react@19.1.0__react@19.1.0/node_modules/next/dist/build/webpack/loaders/next-flight-client-entry-loader.js?server=true! ***!
  \****************************************************************************************************************************************************************************************************/
/***/ (() => {



/***/ }),

/***/ "(ssr)/./node_modules/.pnpm/next@15.1.5_@babel+core@7.27.4_react-dom@19.1.0_react@19.1.0__react@19.1.0/node_modules/next/dist/build/webpack/loaders/next-flight-client-entry-loader.js?server=true!":
/*!****************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/.pnpm/next@15.1.5_@babel+core@7.27.4_react-dom@19.1.0_react@19.1.0__react@19.1.0/node_modules/next/dist/build/webpack/loaders/next-flight-client-entry-loader.js?server=true! ***!
  \****************************************************************************************************************************************************************************************************/
/***/ (() => {



/***/ }),

/***/ "(rsc)/./app/api/airports/[code]/route.ts":
/*!******************************************!*\
  !*** ./app/api/airports/[code]/route.ts ***!
  \******************************************/
/***/ ((module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.a(module, async (__webpack_handle_async_dependencies__, __webpack_async_result__) => { try {\n__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   GET: () => (/* binding */ GET)\n/* harmony export */ });\n/* harmony import */ var next_server__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/server */ \"(rsc)/./node_modules/.pnpm/next@15.1.5_@babel+core@7.27.4_react-dom@19.1.0_react@19.1.0__react@19.1.0/node_modules/next/dist/api/server.js\");\n/* harmony import */ var _src_server_services_airportCache__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../../../src/server/services/airportCache */ \"(rsc)/./src/server/services/airportCache.ts\");\nvar __webpack_async_dependencies__ = __webpack_handle_async_dependencies__([_src_server_services_airportCache__WEBPACK_IMPORTED_MODULE_1__]);\n_src_server_services_airportCache__WEBPACK_IMPORTED_MODULE_1__ = (__webpack_async_dependencies__.then ? (await __webpack_async_dependencies__)() : __webpack_async_dependencies__)[0];\n\n\nconst API_NINJAS_URL = 'https://api.api-ninjas.com/v1';\nconst API_NINJAS_KEY = process.env.API_NINJAS_KEY || 'yCht2E3WowDAz3v2Hn28BQ==7hYVDsQwPCIwiGBN';\n// Helper function to call API Ninjas\nasync function fetchFromApiNinjas(iata, icao) {\n    if (!API_NINJAS_KEY) {\n        throw new Error('API Ninjas API key is not configured');\n    }\n    const apiUrl = new URL(`${API_NINJAS_URL}/airports`);\n    if (iata) apiUrl.searchParams.append('iata', iata);\n    if (icao) apiUrl.searchParams.append('icao', icao);\n    console.log('Calling API Ninjas:', apiUrl.toString());\n    const response = await fetch(apiUrl.toString(), {\n        headers: {\n            'X-Api-Key': API_NINJAS_KEY\n        }\n    });\n    console.log('API Ninjas response:', response.status, response.statusText);\n    if (!response.ok) {\n        const errorText = await response.text();\n        console.error('API Ninjas error response:', errorText);\n        throw new Error(`API request failed: ${response.status} ${response.statusText}`);\n    }\n    const data = await response.json();\n    console.log('API Ninjas data:', data);\n    return data;\n}\nasync function GET(request, { params }) {\n    try {\n        // Initialize airport cache if not already done\n        await _src_server_services_airportCache__WEBPACK_IMPORTED_MODULE_1__.airportCache.initialize();\n        const { code: pathCode } = params;\n        if (!pathCode) {\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                error: 'Airport code is required'\n            }, {\n                status: 400\n            });\n        }\n        const upperCode = pathCode.toUpperCase();\n        // Validate code format (3 or 4 letters)\n        if (!/^[A-Z]{3,4}$/.test(upperCode)) {\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                error: 'Airport code must be 3 or 4 letters'\n            }, {\n                status: 400\n            });\n        }\n        console.log('=== AIRPORT BY CODE ENDPOINT ===');\n        console.log('Airport code request:', {\n            pathCode: upperCode\n        });\n        // Determine if it's IATA (3 chars) or ICAO (4 chars)\n        const iata = upperCode.length === 3 ? upperCode : null;\n        const icao = upperCode.length === 4 ? upperCode : null;\n        let airport = null;\n        let cached = false;\n        // Try cache first\n        const cachedResult = await _src_server_services_airportCache__WEBPACK_IMPORTED_MODULE_1__.airportCache.get(upperCode);\n        if (cachedResult) {\n            airport = cachedResult.data;\n            cached = true;\n        } else {\n            // Call external API\n            const airports = await fetchFromApiNinjas(iata, icao);\n            airport = airports[0] || null;\n            // Cache the result\n            if (airport) {\n                if (airport.iata) await _src_server_services_airportCache__WEBPACK_IMPORTED_MODULE_1__.airportCache.set(airport.iata, airport);\n                if (airport.icao) await _src_server_services_airportCache__WEBPACK_IMPORTED_MODULE_1__.airportCache.set(airport.icao, airport);\n            }\n        }\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            airport,\n            source: cached ? 'cache' : 'api',\n            cached\n        });\n    } catch (error) {\n        console.error('Error in airport by code API:', error);\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            error: 'Internal server error'\n        }, {\n            status: 500\n        });\n    }\n}\n\n__webpack_async_result__();\n} catch(e) { __webpack_async_result__(e); } });//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9hcHAvYXBpL2FpcnBvcnRzL1tjb2RlXS9yb3V0ZS50cyIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7QUFBdUQ7QUFDb0I7QUFHM0UsTUFBTUUsaUJBQWlCO0FBQ3ZCLE1BQU1DLGlCQUFpQkMsUUFBUUMsR0FBRyxDQUFDRixjQUFjLElBQUk7QUFFckQscUNBQXFDO0FBQ3JDLGVBQWVHLG1CQUFtQkMsSUFBb0IsRUFBRUMsSUFBb0I7SUFDMUUsSUFBSSxDQUFDTCxnQkFBZ0I7UUFDbkIsTUFBTSxJQUFJTSxNQUFNO0lBQ2xCO0lBRUEsTUFBTUMsU0FBUyxJQUFJQyxJQUFJLEdBQUdULGVBQWUsU0FBUyxDQUFDO0lBQ25ELElBQUlLLE1BQU1HLE9BQU9FLFlBQVksQ0FBQ0MsTUFBTSxDQUFDLFFBQVFOO0lBQzdDLElBQUlDLE1BQU1FLE9BQU9FLFlBQVksQ0FBQ0MsTUFBTSxDQUFDLFFBQVFMO0lBRTdDTSxRQUFRQyxHQUFHLENBQUMsdUJBQXVCTCxPQUFPTSxRQUFRO0lBRWxELE1BQU1DLFdBQVcsTUFBTUMsTUFBTVIsT0FBT00sUUFBUSxJQUFJO1FBQzlDRyxTQUFTO1lBQ1AsYUFBYWhCO1FBQ2Y7SUFDRjtJQUVBVyxRQUFRQyxHQUFHLENBQUMsd0JBQXdCRSxTQUFTRyxNQUFNLEVBQUVILFNBQVNJLFVBQVU7SUFFeEUsSUFBSSxDQUFDSixTQUFTSyxFQUFFLEVBQUU7UUFDaEIsTUFBTUMsWUFBWSxNQUFNTixTQUFTTyxJQUFJO1FBQ3JDVixRQUFRVyxLQUFLLENBQUMsOEJBQThCRjtRQUM1QyxNQUFNLElBQUlkLE1BQU0sQ0FBQyxvQkFBb0IsRUFBRVEsU0FBU0csTUFBTSxDQUFDLENBQUMsRUFBRUgsU0FBU0ksVUFBVSxFQUFFO0lBQ2pGO0lBRUEsTUFBTUssT0FBTyxNQUFNVCxTQUFTVSxJQUFJO0lBQ2hDYixRQUFRQyxHQUFHLENBQUMsb0JBQW9CVztJQUNoQyxPQUFPQTtBQUNUO0FBRU8sZUFBZUUsSUFDcEJDLE9BQW9CLEVBQ3BCLEVBQUVDLE1BQU0sRUFBZ0M7SUFFeEMsSUFBSTtRQUNGLCtDQUErQztRQUMvQyxNQUFNN0IsMkVBQVlBLENBQUM4QixVQUFVO1FBRTdCLE1BQU0sRUFBRUMsTUFBTUMsUUFBUSxFQUFFLEdBQUdIO1FBRTNCLElBQUksQ0FBQ0csVUFBVTtZQUNiLE9BQU9qQyxxREFBWUEsQ0FBQzJCLElBQUksQ0FDdEI7Z0JBQUVGLE9BQU87WUFBMkIsR0FDcEM7Z0JBQUVMLFFBQVE7WUFBSTtRQUVsQjtRQUVBLE1BQU1jLFlBQVlELFNBQVNFLFdBQVc7UUFFdEMsd0NBQXdDO1FBQ3hDLElBQUksQ0FBQyxlQUFlQyxJQUFJLENBQUNGLFlBQVk7WUFDbkMsT0FBT2xDLHFEQUFZQSxDQUFDMkIsSUFBSSxDQUN0QjtnQkFBRUYsT0FBTztZQUFzQyxHQUMvQztnQkFBRUwsUUFBUTtZQUFJO1FBRWxCO1FBRUFOLFFBQVFDLEdBQUcsQ0FBQztRQUNaRCxRQUFRQyxHQUFHLENBQUMseUJBQXlCO1lBQUVrQixVQUFVQztRQUFVO1FBRTNELHFEQUFxRDtRQUNyRCxNQUFNM0IsT0FBTzJCLFVBQVVHLE1BQU0sS0FBSyxJQUFJSCxZQUFZO1FBQ2xELE1BQU0xQixPQUFPMEIsVUFBVUcsTUFBTSxLQUFLLElBQUlILFlBQVk7UUFFbEQsSUFBSUksVUFBVTtRQUNkLElBQUlDLFNBQVM7UUFFYixrQkFBa0I7UUFDbEIsTUFBTUMsZUFBZSxNQUFNdkMsMkVBQVlBLENBQUN3QyxHQUFHLENBQUNQO1FBQzVDLElBQUlNLGNBQWM7WUFDaEJGLFVBQVVFLGFBQWFkLElBQUk7WUFDM0JhLFNBQVM7UUFDWCxPQUFPO1lBQ0wsb0JBQW9CO1lBQ3BCLE1BQU1HLFdBQVcsTUFBTXBDLG1CQUFtQkMsTUFBTUM7WUFDaEQ4QixVQUFVSSxRQUFRLENBQUMsRUFBRSxJQUFJO1lBRXpCLG1CQUFtQjtZQUNuQixJQUFJSixTQUFTO2dCQUNYLElBQUlBLFFBQVEvQixJQUFJLEVBQUUsTUFBTU4sMkVBQVlBLENBQUMwQyxHQUFHLENBQUNMLFFBQVEvQixJQUFJLEVBQUUrQjtnQkFDdkQsSUFBSUEsUUFBUTlCLElBQUksRUFBRSxNQUFNUCwyRUFBWUEsQ0FBQzBDLEdBQUcsQ0FBQ0wsUUFBUTlCLElBQUksRUFBRThCO1lBQ3pEO1FBQ0Y7UUFFQSxPQUFPdEMscURBQVlBLENBQUMyQixJQUFJLENBQUM7WUFDdkJXO1lBQ0FNLFFBQVFMLFNBQVMsVUFBVTtZQUMzQkE7UUFDRjtJQUVGLEVBQUUsT0FBT2QsT0FBTztRQUNkWCxRQUFRVyxLQUFLLENBQUMsaUNBQWlDQTtRQUMvQyxPQUFPekIscURBQVlBLENBQUMyQixJQUFJLENBQ3RCO1lBQUVGLE9BQU87UUFBd0IsR0FDakM7WUFBRUwsUUFBUTtRQUFJO0lBRWxCO0FBQ0YiLCJzb3VyY2VzIjpbIi9Vc2Vycy9ydWJlZW4vZGV2L3BlcnNvbmFsL2FpcnBvcnQtZGIvYXBwL2FwaS9haXJwb3J0cy9bY29kZV0vcm91dGUudHMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgTmV4dFJlcXVlc3QsIE5leHRSZXNwb25zZSB9IGZyb20gJ25leHQvc2VydmVyJ1xuaW1wb3J0IHsgYWlycG9ydENhY2hlIH0gZnJvbSAnLi4vLi4vLi4vLi4vc3JjL3NlcnZlci9zZXJ2aWNlcy9haXJwb3J0Q2FjaGUnXG5pbXBvcnQgdHlwZSB7IEFpcnBvcnQgfSBmcm9tICcuLi8uLi8uLi8uLi9zcmMvdHlwZXMvYWlycG9ydCdcblxuY29uc3QgQVBJX05JTkpBU19VUkwgPSAnaHR0cHM6Ly9hcGkuYXBpLW5pbmphcy5jb20vdjEnXG5jb25zdCBBUElfTklOSkFTX0tFWSA9IHByb2Nlc3MuZW52LkFQSV9OSU5KQVNfS0VZIHx8ICd5Q2h0MkUzV293REF6M3YySG4yOEJRPT03aFlWRHNRd1BDSXdpR0JOJ1xuXG4vLyBIZWxwZXIgZnVuY3Rpb24gdG8gY2FsbCBBUEkgTmluamFzXG5hc3luYyBmdW5jdGlvbiBmZXRjaEZyb21BcGlOaW5qYXMoaWF0YT86IHN0cmluZyB8IG51bGwsIGljYW8/OiBzdHJpbmcgfCBudWxsKTogUHJvbWlzZTxBaXJwb3J0W10+IHtcbiAgaWYgKCFBUElfTklOSkFTX0tFWSkge1xuICAgIHRocm93IG5ldyBFcnJvcignQVBJIE5pbmphcyBBUEkga2V5IGlzIG5vdCBjb25maWd1cmVkJylcbiAgfVxuXG4gIGNvbnN0IGFwaVVybCA9IG5ldyBVUkwoYCR7QVBJX05JTkpBU19VUkx9L2FpcnBvcnRzYClcbiAgaWYgKGlhdGEpIGFwaVVybC5zZWFyY2hQYXJhbXMuYXBwZW5kKCdpYXRhJywgaWF0YSlcbiAgaWYgKGljYW8pIGFwaVVybC5zZWFyY2hQYXJhbXMuYXBwZW5kKCdpY2FvJywgaWNhbylcblxuICBjb25zb2xlLmxvZygnQ2FsbGluZyBBUEkgTmluamFzOicsIGFwaVVybC50b1N0cmluZygpKVxuXG4gIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgZmV0Y2goYXBpVXJsLnRvU3RyaW5nKCksIHtcbiAgICBoZWFkZXJzOiB7XG4gICAgICAnWC1BcGktS2V5JzogQVBJX05JTkpBU19LRVksXG4gICAgfSxcbiAgfSlcblxuICBjb25zb2xlLmxvZygnQVBJIE5pbmphcyByZXNwb25zZTonLCByZXNwb25zZS5zdGF0dXMsIHJlc3BvbnNlLnN0YXR1c1RleHQpXG5cbiAgaWYgKCFyZXNwb25zZS5vaykge1xuICAgIGNvbnN0IGVycm9yVGV4dCA9IGF3YWl0IHJlc3BvbnNlLnRleHQoKVxuICAgIGNvbnNvbGUuZXJyb3IoJ0FQSSBOaW5qYXMgZXJyb3IgcmVzcG9uc2U6JywgZXJyb3JUZXh0KVxuICAgIHRocm93IG5ldyBFcnJvcihgQVBJIHJlcXVlc3QgZmFpbGVkOiAke3Jlc3BvbnNlLnN0YXR1c30gJHtyZXNwb25zZS5zdGF0dXNUZXh0fWApXG4gIH1cblxuICBjb25zdCBkYXRhID0gYXdhaXQgcmVzcG9uc2UuanNvbigpXG4gIGNvbnNvbGUubG9nKCdBUEkgTmluamFzIGRhdGE6JywgZGF0YSlcbiAgcmV0dXJuIGRhdGFcbn1cblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIEdFVChcbiAgcmVxdWVzdDogTmV4dFJlcXVlc3QsXG4gIHsgcGFyYW1zIH06IHsgcGFyYW1zOiB7IGNvZGU6IHN0cmluZyB9IH1cbikge1xuICB0cnkge1xuICAgIC8vIEluaXRpYWxpemUgYWlycG9ydCBjYWNoZSBpZiBub3QgYWxyZWFkeSBkb25lXG4gICAgYXdhaXQgYWlycG9ydENhY2hlLmluaXRpYWxpemUoKVxuXG4gICAgY29uc3QgeyBjb2RlOiBwYXRoQ29kZSB9ID0gcGFyYW1zXG4gICAgXG4gICAgaWYgKCFwYXRoQ29kZSkge1xuICAgICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKFxuICAgICAgICB7IGVycm9yOiAnQWlycG9ydCBjb2RlIGlzIHJlcXVpcmVkJyB9LFxuICAgICAgICB7IHN0YXR1czogNDAwIH1cbiAgICAgIClcbiAgICB9XG5cbiAgICBjb25zdCB1cHBlckNvZGUgPSBwYXRoQ29kZS50b1VwcGVyQ2FzZSgpXG4gICAgXG4gICAgLy8gVmFsaWRhdGUgY29kZSBmb3JtYXQgKDMgb3IgNCBsZXR0ZXJzKVxuICAgIGlmICghL15bQS1aXXszLDR9JC8udGVzdCh1cHBlckNvZGUpKSB7XG4gICAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oXG4gICAgICAgIHsgZXJyb3I6ICdBaXJwb3J0IGNvZGUgbXVzdCBiZSAzIG9yIDQgbGV0dGVycycgfSxcbiAgICAgICAgeyBzdGF0dXM6IDQwMCB9XG4gICAgICApXG4gICAgfVxuICAgIFxuICAgIGNvbnNvbGUubG9nKCc9PT0gQUlSUE9SVCBCWSBDT0RFIEVORFBPSU5UID09PScpXG4gICAgY29uc29sZS5sb2coJ0FpcnBvcnQgY29kZSByZXF1ZXN0OicsIHsgcGF0aENvZGU6IHVwcGVyQ29kZSB9KVxuICAgIFxuICAgIC8vIERldGVybWluZSBpZiBpdCdzIElBVEEgKDMgY2hhcnMpIG9yIElDQU8gKDQgY2hhcnMpXG4gICAgY29uc3QgaWF0YSA9IHVwcGVyQ29kZS5sZW5ndGggPT09IDMgPyB1cHBlckNvZGUgOiBudWxsXG4gICAgY29uc3QgaWNhbyA9IHVwcGVyQ29kZS5sZW5ndGggPT09IDQgPyB1cHBlckNvZGUgOiBudWxsXG4gICAgXG4gICAgbGV0IGFpcnBvcnQgPSBudWxsXG4gICAgbGV0IGNhY2hlZCA9IGZhbHNlXG4gICAgXG4gICAgLy8gVHJ5IGNhY2hlIGZpcnN0XG4gICAgY29uc3QgY2FjaGVkUmVzdWx0ID0gYXdhaXQgYWlycG9ydENhY2hlLmdldCh1cHBlckNvZGUpXG4gICAgaWYgKGNhY2hlZFJlc3VsdCkge1xuICAgICAgYWlycG9ydCA9IGNhY2hlZFJlc3VsdC5kYXRhXG4gICAgICBjYWNoZWQgPSB0cnVlXG4gICAgfSBlbHNlIHtcbiAgICAgIC8vIENhbGwgZXh0ZXJuYWwgQVBJXG4gICAgICBjb25zdCBhaXJwb3J0cyA9IGF3YWl0IGZldGNoRnJvbUFwaU5pbmphcyhpYXRhLCBpY2FvKVxuICAgICAgYWlycG9ydCA9IGFpcnBvcnRzWzBdIHx8IG51bGxcbiAgICAgIFxuICAgICAgLy8gQ2FjaGUgdGhlIHJlc3VsdFxuICAgICAgaWYgKGFpcnBvcnQpIHtcbiAgICAgICAgaWYgKGFpcnBvcnQuaWF0YSkgYXdhaXQgYWlycG9ydENhY2hlLnNldChhaXJwb3J0LmlhdGEsIGFpcnBvcnQpXG4gICAgICAgIGlmIChhaXJwb3J0LmljYW8pIGF3YWl0IGFpcnBvcnRDYWNoZS5zZXQoYWlycG9ydC5pY2FvLCBhaXJwb3J0KVxuICAgICAgfVxuICAgIH1cbiAgICBcbiAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oe1xuICAgICAgYWlycG9ydCxcbiAgICAgIHNvdXJjZTogY2FjaGVkID8gJ2NhY2hlJyA6ICdhcGknLFxuICAgICAgY2FjaGVkXG4gICAgfSlcbiAgICBcbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICBjb25zb2xlLmVycm9yKCdFcnJvciBpbiBhaXJwb3J0IGJ5IGNvZGUgQVBJOicsIGVycm9yKVxuICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbihcbiAgICAgIHsgZXJyb3I6ICdJbnRlcm5hbCBzZXJ2ZXIgZXJyb3InIH0sXG4gICAgICB7IHN0YXR1czogNTAwIH1cbiAgICApXG4gIH1cbn0iXSwibmFtZXMiOlsiTmV4dFJlc3BvbnNlIiwiYWlycG9ydENhY2hlIiwiQVBJX05JTkpBU19VUkwiLCJBUElfTklOSkFTX0tFWSIsInByb2Nlc3MiLCJlbnYiLCJmZXRjaEZyb21BcGlOaW5qYXMiLCJpYXRhIiwiaWNhbyIsIkVycm9yIiwiYXBpVXJsIiwiVVJMIiwic2VhcmNoUGFyYW1zIiwiYXBwZW5kIiwiY29uc29sZSIsImxvZyIsInRvU3RyaW5nIiwicmVzcG9uc2UiLCJmZXRjaCIsImhlYWRlcnMiLCJzdGF0dXMiLCJzdGF0dXNUZXh0Iiwib2siLCJlcnJvclRleHQiLCJ0ZXh0IiwiZXJyb3IiLCJkYXRhIiwianNvbiIsIkdFVCIsInJlcXVlc3QiLCJwYXJhbXMiLCJpbml0aWFsaXplIiwiY29kZSIsInBhdGhDb2RlIiwidXBwZXJDb2RlIiwidG9VcHBlckNhc2UiLCJ0ZXN0IiwibGVuZ3RoIiwiYWlycG9ydCIsImNhY2hlZCIsImNhY2hlZFJlc3VsdCIsImdldCIsImFpcnBvcnRzIiwic2V0Iiwic291cmNlIl0sImlnbm9yZUxpc3QiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./app/api/airports/[code]/route.ts\n");

/***/ }),

/***/ "(rsc)/./src/lib/cache/observability/index.ts":
/*!**********************************************!*\
  !*** ./src/lib/cache/observability/index.ts ***!
  \**********************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   CacheLogger: () => (/* reexport safe */ _logger__WEBPACK_IMPORTED_MODULE_1__.CacheLogger),\n/* harmony export */   CacheMetricsCollector: () => (/* reexport safe */ _metrics__WEBPACK_IMPORTED_MODULE_0__.CacheMetricsCollector),\n/* harmony export */   SimpleLatencyTracker: () => (/* reexport safe */ _metrics__WEBPACK_IMPORTED_MODULE_0__.SimpleLatencyTracker),\n/* harmony export */   StructuredLogger: () => (/* reexport safe */ _logger__WEBPACK_IMPORTED_MODULE_1__.StructuredLogger),\n/* harmony export */   formatMetricsForPrometheus: () => (/* reexport safe */ _metrics__WEBPACK_IMPORTED_MODULE_0__.formatMetricsForPrometheus),\n/* harmony export */   generateCorrelationId: () => (/* reexport safe */ _logger__WEBPACK_IMPORTED_MODULE_1__.generateCorrelationId),\n/* harmony export */   jsonTransport: () => (/* reexport safe */ _logger__WEBPACK_IMPORTED_MODULE_1__.jsonTransport),\n/* harmony export */   prettyTransport: () => (/* reexport safe */ _logger__WEBPACK_IMPORTED_MODULE_1__.prettyTransport)\n/* harmony export */ });\n/* harmony import */ var _metrics__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./metrics */ \"(rsc)/./src/lib/cache/observability/metrics.ts\");\n/* harmony import */ var _logger__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./logger */ \"(rsc)/./src/lib/cache/observability/logger.ts\");\n// Cache observability exports\n\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9zcmMvbGliL2NhY2hlL29ic2VydmFiaWxpdHkvaW5kZXgudHMiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7OztBQUFBLDhCQUE4QjtBQUNMO0FBQ0QiLCJzb3VyY2VzIjpbIi9Vc2Vycy9ydWJlZW4vZGV2L3BlcnNvbmFsL2FpcnBvcnQtZGIvc3JjL2xpYi9jYWNoZS9vYnNlcnZhYmlsaXR5L2luZGV4LnRzIl0sInNvdXJjZXNDb250ZW50IjpbIi8vIENhY2hlIG9ic2VydmFiaWxpdHkgZXhwb3J0c1xuZXhwb3J0ICogZnJvbSAnLi9tZXRyaWNzJ1xuZXhwb3J0ICogZnJvbSAnLi9sb2dnZXInIl0sIm5hbWVzIjpbXSwiaWdub3JlTGlzdCI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./src/lib/cache/observability/index.ts\n");

/***/ }),

/***/ "(rsc)/./src/lib/cache/observability/logger.ts":
/*!***********************************************!*\
  !*** ./src/lib/cache/observability/logger.ts ***!
  \***********************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   CacheLogger: () => (/* binding */ CacheLogger),\n/* harmony export */   StructuredLogger: () => (/* binding */ StructuredLogger),\n/* harmony export */   generateCorrelationId: () => (/* binding */ generateCorrelationId),\n/* harmony export */   jsonTransport: () => (/* binding */ jsonTransport),\n/* harmony export */   prettyTransport: () => (/* binding */ prettyTransport)\n/* harmony export */ });\n// Structured logging for cache operations\n// Provides consistent, queryable logs with correlation IDs\nclass StructuredLogger {\n    constructor(module, context = {}, transport){\n        this.module = module;\n        this.context = context;\n        this.transport = transport || this.defaultTransport;\n    }\n    debug(message, metadata) {\n        this.log('debug', message, metadata);\n    }\n    info(message, metadata) {\n        this.log('info', message, metadata);\n    }\n    warn(message, metadata) {\n        this.log('warn', message, metadata);\n    }\n    error(message, error, metadata) {\n        const errorInfo = error ? {\n            name: error.name,\n            message: error.message,\n            stack: error.stack\n        } : undefined;\n        this.log('error', message, metadata, errorInfo);\n    }\n    child(context) {\n        return new StructuredLogger(this.module, {\n            ...this.context,\n            ...context\n        }, this.transport);\n    }\n    log(level, message, metadata, error) {\n        const entry = {\n            timestamp: new Date().toISOString(),\n            level,\n            message,\n            module: this.module,\n            context: this.context,\n            metadata,\n            error\n        };\n        this.transport(entry);\n    }\n    defaultTransport(entry) {\n        const { level, message, ...rest } = entry;\n        // Format for console output\n        const prefix = `[${entry.timestamp}] [${entry.module}] ${level.toUpperCase()}`;\n        const contextStr = entry.context?.correlationId ? ` [${entry.context.correlationId}]` : '';\n        switch(level){\n            case 'debug':\n                console.debug(`${prefix}${contextStr}:`, message, rest);\n                break;\n            case 'info':\n                console.info(`${prefix}${contextStr}:`, message, rest);\n                break;\n            case 'warn':\n                console.warn(`${prefix}${contextStr}:`, message, rest);\n                break;\n            case 'error':\n                console.error(`${prefix}${contextStr}:`, message, rest);\n                break;\n        }\n    }\n}\n// Cache-specific logger with operation tracking\nclass CacheLogger extends StructuredLogger {\n    constructor(context = {}, transport){\n        super('cache', context, transport);\n    }\n    logOperation(operation, key, duration, success, metadata) {\n        const level = success ? 'debug' : 'warn';\n        const message = `Cache ${operation} for key: ${key}`;\n        this.log(level, message, {\n            ...metadata,\n            operation,\n            key,\n            duration,\n            success\n        });\n    }\n    logCacheHit(key, metadata) {\n        this.debug('Cache hit', {\n            ...metadata,\n            operation: 'get',\n            key,\n            result: 'hit'\n        });\n    }\n    logCacheMiss(key, metadata) {\n        this.debug('Cache miss', {\n            ...metadata,\n            operation: 'get',\n            key,\n            result: 'miss'\n        });\n    }\n    logCacheSet(key, ttl, size, metadata) {\n        this.debug('Cache set', {\n            ...metadata,\n            operation: 'set',\n            key,\n            ttl,\n            size\n        });\n    }\n    logCacheError(operation, key, error, metadata) {\n        this.error(`Cache ${operation} failed for key: ${key}`, error, {\n            ...metadata,\n            operation,\n            key\n        });\n    }\n    log(level, message, metadata, error) {\n        // Override to add operation tracking\n        const entry = {\n            timestamp: new Date().toISOString(),\n            level,\n            message,\n            module: 'cache',\n            operation: metadata?.operation,\n            duration: metadata?.duration,\n            context: this.context,\n            metadata,\n            error\n        };\n        this.transport(entry);\n    }\n}\n// JSON formatter for production logging\nfunction jsonTransport(entry) {\n    console.log(JSON.stringify(entry));\n}\n// Pretty formatter for development\nfunction prettyTransport(entry) {\n    const { level, message, module, operation, duration, context, metadata, error } = entry;\n    const parts = [\n        `[${entry.timestamp}]`,\n        `[${module}]`,\n        level.toUpperCase().padEnd(5)\n    ];\n    if (context?.correlationId) {\n        parts.push(`[${context.correlationId.substring(0, 8)}]`);\n    }\n    if (operation) {\n        parts.push(`[${operation}]`);\n    }\n    parts.push(message);\n    if (duration !== undefined) {\n        parts.push(`(${duration}ms)`);\n    }\n    const logMessage = parts.join(' ');\n    // Log based on level\n    switch(level){\n        case 'debug':\n            console.debug(logMessage, metadata || '');\n            break;\n        case 'info':\n            console.info(logMessage, metadata || '');\n            break;\n        case 'warn':\n            console.warn(logMessage, metadata || '');\n            if (error) console.warn(error);\n            break;\n        case 'error':\n            console.error(logMessage, metadata || '');\n            if (error) console.error(error);\n            break;\n    }\n}\n// Helper to generate correlation IDs\nfunction generateCorrelationId() {\n    return `${Date.now()}-${Math.random().toString(36).substring(2, 9)}`;\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9zcmMvbGliL2NhY2hlL29ic2VydmFiaWxpdHkvbG9nZ2VyLnRzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7O0FBQUEsMENBQTBDO0FBQzFDLDJEQUEyRDtBQW9DcEQsTUFBTUE7SUFLWEMsWUFDRUMsTUFBYyxFQUNkQyxVQUFzQixDQUFDLENBQUMsRUFDeEJDLFNBQXFDLENBQ3JDO1FBQ0EsSUFBSSxDQUFDRixNQUFNLEdBQUdBO1FBQ2QsSUFBSSxDQUFDQyxPQUFPLEdBQUdBO1FBQ2YsSUFBSSxDQUFDQyxTQUFTLEdBQUdBLGFBQWEsSUFBSSxDQUFDQyxnQkFBZ0I7SUFDckQ7SUFFQUMsTUFBTUMsT0FBZSxFQUFFQyxRQUE4QixFQUFRO1FBQzNELElBQUksQ0FBQ0MsR0FBRyxDQUFDLFNBQVNGLFNBQVNDO0lBQzdCO0lBRUFFLEtBQUtILE9BQWUsRUFBRUMsUUFBOEIsRUFBUTtRQUMxRCxJQUFJLENBQUNDLEdBQUcsQ0FBQyxRQUFRRixTQUFTQztJQUM1QjtJQUVBRyxLQUFLSixPQUFlLEVBQUVDLFFBQThCLEVBQVE7UUFDMUQsSUFBSSxDQUFDQyxHQUFHLENBQUMsUUFBUUYsU0FBU0M7SUFDNUI7SUFFQUksTUFBTUwsT0FBZSxFQUFFSyxLQUFhLEVBQUVKLFFBQThCLEVBQVE7UUFDMUUsTUFBTUssWUFBWUQsUUFBUTtZQUN4QkUsTUFBTUYsTUFBTUUsSUFBSTtZQUNoQlAsU0FBU0ssTUFBTUwsT0FBTztZQUN0QlEsT0FBT0gsTUFBTUcsS0FBSztRQUNwQixJQUFJQztRQUVKLElBQUksQ0FBQ1AsR0FBRyxDQUFDLFNBQVNGLFNBQVNDLFVBQVVLO0lBQ3ZDO0lBRUFJLE1BQU1kLE9BQW1CLEVBQVU7UUFDakMsT0FBTyxJQUFJSCxpQkFDVCxJQUFJLENBQUNFLE1BQU0sRUFDWDtZQUFFLEdBQUcsSUFBSSxDQUFDQyxPQUFPO1lBQUUsR0FBR0EsT0FBTztRQUFDLEdBQzlCLElBQUksQ0FBQ0MsU0FBUztJQUVsQjtJQUVRSyxJQUNOUyxLQUFlLEVBQ2ZYLE9B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QU1FLElBQUksQ0FBQyxDQUFDLENBQUMsRUFBRWYsU0FBUyxHQUFHLENBQUM7SUFDOUI7SUFFQSxNQUFNaUIsYUFBYUosTUFBTUssSUFBSSxDQUFDO0lBRTlCLHFCQUFxQjtJQUNyQixPQUFRakM7UUFDTixLQUFLO1lBQ0hVLFFBQVF0QixLQUFLLENBQUM0QyxZQUFZMUMsWUFBWTtZQUN0QztRQUNGLEtBQUs7WUFDSG9CLFFBQVFsQixJQUFJLENBQUN3QyxZQUFZMUMsWUFBWTtZQUNyQztRQUNGLEtBQUs7WUFDSG9CLFFBQVFqQixJQUFJLENBQUN1QyxZQUFZMUMsWUFBWTtZQUNyQyxJQUFJSSxPQUFPZ0IsUUFBUWpCLElBQUksQ0FBQ0M7WUFDeEI7UUFDRixLQUFLO1lBQ0hnQixRQUFRaEIsS0FBSyxDQUFDc0MsWUFBWTFDLFlBQVk7WUFDdEMsSUFBSUksT0FBT2dCLFFBQVFoQixLQUFLLENBQUNBO1lBQ3pCO0lBQ0o7QUFDRjtBQUVBLHFDQUFxQztBQUM5QixTQUFTd0M7SUFDZCxPQUFPLEdBQUcvQixLQUFLZ0MsR0FBRyxHQUFHLENBQUMsRUFBRUMsS0FBS0MsTUFBTSxHQUFHQyxRQUFRLENBQUMsSUFBSVAsU0FBUyxDQUFDLEdBQUcsSUFBSTtBQUN0RSIsInNvdXJjZXMiOlsiL1VzZXJzL3J1YmVlbi9kZXYvcGVyc29uYWwvYWlycG9ydC1kYi9zcmMvbGliL2NhY2hlL29ic2VydmFiaWxpdHkvbG9nZ2VyLnRzIl0sInNvdXJjZXNDb250ZW50IjpbIi8vIFN0cnVjdHVyZWQgbG9nZ2luZyBmb3IgY2FjaGUgb3BlcmF0aW9uc1xuLy8gUHJvdmlkZXMgY29uc2lzdGVudCwgcXVlcnlhYmxlIGxvZ3Mgd2l0aCBjb3JyZWxhdGlvbiBJRHNcblxuZXhwb3J0IHR5cGUgTG9nTGV2ZWwgPSAnZGVidWcnIHwgJ2luZm8nIHwgJ3dhcm4nIHwgJ2Vycm9yJ1xuXG5leHBvcnQgaW50ZXJmYWNlIExvZ0NvbnRleHQge1xuICBjb3JyZWxhdGlvbklkPzogc3RyaW5nXG4gIHVzZXJJZD86IHN0cmluZ1xuICBzZXNzaW9uSWQ/OiBzdHJpbmdcbiAgcmVxdWVzdElkPzogc3RyaW5nXG4gIFtrZXk6IHN0cmluZ106IGFueVxufVxuXG5leHBvcnQgaW50ZXJmYWNlIExvZ0VudHJ5IHtcbiAgdGltZXN0YW1wOiBzdHJpbmdcbiAgbGV2ZWw6IExvZ0xldmVsXG4gIG1lc3NhZ2U6IHN0cmluZ1xuICBtb2R1bGU6IHN0cmluZ1xuICBvcGVyYXRpb24/OiBzdHJpbmdcbiAgZHVyYXRpb24/OiBudW1iZXJcbiAgY29udGV4dD86IExvZ0NvbnRleHRcbiAgZXJyb3I/OiB7XG4gICAgbmFtZTogc3RyaW5nXG4gICAgbWVzc2FnZTogc3RyaW5nXG4gICAgc3RhY2s/OiBzdHJpbmdcbiAgfVxuICBtZXRhZGF0YT86IFJlY29yZDxzdHJpbmcsIGFueT5cbn1cblxuZXhwb3J0IGludGVyZmFjZSBMb2dnZXIge1xuICBkZWJ1ZzogKG1lc3NhZ2U6IHN0cmluZywgbWV0YWRhdGE/OiBSZWNvcmQ8c3RyaW5nLCBhbnk+KSA9PiB2b2lkXG4gIGluZm86IChtZXNzYWdlOiBzdHJpbmcsIG1ldGFkYXRhPzogUmVjb3JkPHN0cmluZywgYW55PikgPT4gdm9pZFxuICB3YXJuOiAobWVzc2FnZTogc3RyaW5nLCBtZXRhZGF0YT86IFJlY29yZDxzdHJpbmcsIGFueT4pID0+IHZvaWRcbiAgZXJyb3I6IChtZXNzYWdlOiBzdHJpbmcsIGVycm9yPzogRXJyb3IsIG1ldGFkYXRhPzogUmVjb3JkPHN0cmluZywgYW55PikgPT4gdm9pZFxuICBjaGlsZDogKGNvbnRleHQ6IExvZ0NvbnRleHQpID0+IExvZ2dlclxufVxuXG5leHBvcnQgY2xhc3MgU3RydWN0dXJlZExvZ2dlciBpbXBsZW1lbnRzIExvZ2dlciB7XG4gIHByaXZhdGUgY29udGV4dDogTG9nQ29udGV4dFxuICBwcml2YXRlIG1vZHVsZTogc3RyaW5nXG4gIHByaXZhdGUgdHJhbnNwb3J0OiAoZW50cnk6IExvZ0VudHJ5KSA9PiB2b2lkXG4gIFxuICBjb25zdHJ1Y3RvcihcbiAgICBtb2R1bGU6IHN0cmluZyxcbiAgICBjb250ZXh0OiBMb2dDb250ZXh0ID0ge30sXG4gICAgdHJhbnNwb3J0PzogKGVudHJ5OiBMb2dFbnRyeSkgPT4gdm9pZFxuICApIHtcbiAgICB0aGlzLm1vZHVsZSA9IG1vZHVsZVxuICAgIHRoaXMuY29udGV4dCA9IGNvbnRleHRcbiAgICB0aGlzLnRyYW5zcG9ydCA9IHRyYW5zcG9ydCB8fCB0aGlzLmRlZmF1bHRUcmFuc3BvcnRcbiAgfVxuICBcbiAgZGVidWcobWVzc2FnZTogc3RyaW5nLCBtZXRhZGF0YT86IFJlY29yZDxzdHJpbmcsIGFueT4pOiB2b2lkIHtcbiAgICB0aGlzLmxvZygnZGVidWcnLCBtZXNzYWdlLCBtZXRhZGF0YSlcbiAgfVxuICBcbiAgaW5mbyhtZXNzYWdlOiBzdHJpbmcsIG1ldGFkYXRhPzogUmVjb3JkPHN0cmluZywgYW55Pik6IHZvaWQge1xuICAgIHRoaXMubG9nKCdpbmZvJywgbWVzc2FnZSwgbWV0YWRhdGEpXG4gIH1cbiAgXG4gIHdhcm4obWVzc2FnZTogc3RyaW5nLCBtZXRhZGF0YT86IFJlY29yZDxzdHJpbmcsIGFueT4pOiB2b2lkIHtcbiAgICB0aGlzLmxvZygnd2FybicsIG1lc3NhZ2UsIG1ldGFkYXRhKVxuICB9XG4gIFxuICBlcnJvcihtZXNzYWdlOiBzdHJpbmcsIGVycm9yPzogRXJyb3IsIG1ldGFkYXRhPzogUmVjb3JkPHN0cmluZywgYW55Pik6IHZvaWQge1xuICAgIGNvbnN0IGVycm9ySW5mbyA9IGVycm9yID8ge1xuICAgICAgbmFtZTogZXJyb3IubmFtZSxcbiAgICAgIG1lc3NhZ2U6IGVycm9yLm1lc3NhZ2UsXG4gICAgICBzdGFjazogZXJyb3Iuc3RhY2tcbiAgICB9IDogdW5kZWZpbmVkXG4gICAgXG4gICAgdGhpcy5sb2coJ2Vycm9yJywgbWVzc2FnZSwgbWV0YWRhdGEsIGVycm9ySW5mbylcbiAgfVxuICBcbiAgY2hpbGQoY29udGV4dDogTG9nQ29udGV4dCk6IExvZ2dlciB7XG4gICAgcmV0dXJuIG5ldyBTdHJ1Y3R1cmVkTG9nZ2VyKFxuICAgICAgdGhpcy5tb2R1bGUsXG4gICAgICB7IC4uLnRoaXMuY29udGV4dCwgLi4uY29udGV4dCB9LFxuICAgICAgdGhpcy50cmFuc3BvcnRcbiAgICApXG4gIH1cbiAgXG4gIHByaXZhdGUgbG9nKFxuICAgIGxldmVsOiBMb2dMZXZlbCxcbiAgICBtZXNzYWdlOiBzdHJpbmcsXG4gICAgbWV0YWRhdGE/OiBSZWNvcmQ8c3RyaW5nLCBhbnk+LFxuICAgIGVycm9yPzogTG9nRW50cnlbJ2Vycm9yJ11cbiAgKTogdm9pZCB7XG4gICAgY29uc3QgZW50cnk6IExvZ0VudHJ5ID0ge1xuICAgICAgdGltZXN0YW1wOiBuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKCksXG4gICAgICBsZXZlbCxcbiAgICAgIG1lc3NhZ2UsXG4gICAgICBtb2R1bGU6IHRoaXMubW9kdWxlLFxuICAgICAgY29udGV4dDogdGhpcy5jb250ZXh0LFxuICAgICAgbWV0YWRhdGEsXG4gICAgICBlcnJvclxuICAgIH1cbiAgICBcbiAgICB0aGlzLnRyYW5zcG9ydChlbnRyeSlcbiAgfVxuICBcbiAgcHJpdmF0ZSBkZWZhdWx0VHJhbnNwb3J0KGVudHJ5OiBMb2dFbnRyeSk6IHZvaWQge1xuICAgIGNvbnN0IHsgbGV2ZWwsIG1lc3NhZ2UsIC4uLnJlc3QgfSA9IGVudHJ5XG4gICAgXG4gICAgLy8gRm9ybWF0IGZvciBjb25zb2xlIG91dHB1dFxuICAgIGNvbnN0IHByZWZpeCA9IGBbJHtlbnRyeS50aW1lc3RhbXB9XSBbJHtlbnRyeS5tb2R1bGV9XSAke2xldmVsLnRvVXBwZXJDYXNlKCl9YFxuICAgIGNvbnN0IGNvbnRleHRTdHIgPSBlbnRyeS5jb250ZXh0Py5jb3JyZWxhdGlvbklkIFxuICAgICAgPyBgIFske2VudHJ5LmNvbnRleHQuY29ycmVsYXRpb25JZH1dYCBcbiAgICAgIDogJydcbiAgICBcbiAgICBzd2l0Y2ggKGxldmVsKSB7XG4gICAgICBjYXNlICdkZWJ1Zyc6XG4gICAgICAgIGNvbnNvbGUuZGVidWcoYCR7cHJlZml4fSR7Y29udGV4dFN0cn06YCwgbWVzc2FnZSwgcmVzdClcbiAgICAgICAgYnJlYWtcbiAgICAgIGNhc2UgJ2luZm8nOlxuICAgICAgICBjb25zb2xlLmluZm8oYCR7cHJlZml4fSR7Y29udGV4dFN0cn06YCwgbWVzc2FnZSwgcmVzdClcbiAgICAgICAgYnJlYWtcbiAgICAgIGNhc2UgJ3dhcm4nOlxuICAgICAgICBjb25zb2xlLndhcm4oYCR7cHJlZml4fSR7Y29udGV4dFN0cn06YCwgbWVzc2FnZSwgcmVzdClcbiAgICAgICAgYnJlYWtcbiAgICAgIGNhc2UgJ2Vycm9yJzpcbiAgICAgICAgY29uc29sZS5lcnJvcihgJHtwcmVmaXh9JHtjb250ZXh0U3RyfTpgLCBtZXNzYWdlLCByZXN0KVxuICAgICAgICBicmVha1xuICAgIH1cbiAgfVxufVxuXG4vLyBDYWNoZS1zcGVjaWZpYyBsb2dnZXIgd2l0aCBvcGVyYXRpb24gdHJhY2tpbmdcbmV4cG9ydCBjbGFzcyBDYWNoZUxvZ2dlciBleHRlbmRzIFN0cnVjdHVyZWRMb2dnZXIge1xuICBjb25zdHJ1Y3Rvcihjb250ZXh0OiBMb2dDb250ZXh0ID0ge30sIHRyYW5zcG9ydD86IChlbnRyeTogTG9nRW50cnkpID0+IHZvaWQpIHtcbiAgICBzdXBlcignY2FjaGUnLCBjb250ZXh0LCB0cmFuc3BvcnQpXG4gIH1cbiAgXG4gIGxvZ09wZXJhdGlvbihcbiAgICBvcGVyYXRpb246IHN0cmluZyxcbiAgICBrZXk6IHN0cmluZyxcbiAgICBkdXJhdGlvbjogbnVtYmVyLFxuICAgIHN1Y2Nlc3M6IGJvb2xlYW4sXG4gICAgbWV0YWRhdGE/OiBSZWNvcmQ8c3RyaW5nLCBhbnk+XG4gICk6IHZvaWQge1xuICAgIGNvbnN0IGxldmVsID0gc3VjY2VzcyA/ICdkZWJ1ZycgOiAnd2FybidcbiAgICBjb25zdCBtZXNzYWdlID0gYENhY2hlICR7b3BlcmF0aW9ufSBmb3Iga2V5OiAke2tleX1gXG4gICAgXG4gICAgdGhpcy5sb2cobGV2ZWwsIG1lc3NhZ2UsIHtcbiAgICAgIC4uLm1ldGFkYXRhLFxuICAgICAgb3BlcmF0aW9uLFxuICAgICAga2V5LFxuICAgICAgZHVyYXRpb24sXG4gICAgICBzdWNjZXNzXG4gICAgfSlcbiAgfVxuICBcbiAgbG9nQ2FjaGVIaXQoa2V5OiBzdHJpbmcsIG1ldGFkYXRhPzogUmVjb3JkPHN0cmluZywgYW55Pik6IHZvaWQge1xuICAgIHRoaXMuZGVidWcoJ0NhY2hlIGhpdCcsIHtcbiAgICAgIC4uLm1ldGFkYXRhLFxuICAgICAgb3BlcmF0aW9uOiAnZ2V0JyxcbiAgICAgIGtleSxcbiAgICAgIHJlc3VsdDogJ2hpdCdcbiAgICB9KVxuICB9XG4gIFxuICBsb2dDYWNoZU1pc3Moa2V5OiBzdHJpbmcsIG1ldGFkYXRhPzogUmVjb3JkPHN0cmluZywgYW55Pik6IHZvaWQge1xuICAgIHRoaXMuZGVidWcoJ0NhY2hlIG1pc3MnLCB7XG4gICAgICAuLi5tZXRhZGF0YSxcbiAgICAgIG9wZXJhdGlvbjogJ2dldCcsXG4gICAgICBrZXksXG4gICAgICByZXN1bHQ6ICdtaXNzJ1xuICAgIH0pXG4gIH1cbiAgXG4gIGxvZ0NhY2hlU2V0KGtleTogc3RyaW5nLCB0dGw6IG51bWJlciwgc2l6ZTogbnVtYmVyLCBtZXRhZGF0YT86IFJlY29yZDxzdHJpbmcsIGFueT4pOiB2b2lkIHtcbiAgICB0aGlzLmRlYnVnKCdDYWNoZSBzZXQnLCB7XG4gICAgICAuLi5tZXRhZGF0YSxcbiAgICAgIG9wZXJhdGlvbjogJ3NldCcsXG4gICAgICBrZXksXG4gICAgICB0dGwsXG4gICAgICBzaXplXG4gICAgfSlcbiAgfVxuICBcbiAgbG9nQ2FjaGVFcnJvcihcbiAgICBvcGVyYXRpb246IHN0cmluZyxcbiAgICBrZXk6IHN0cmluZyxcbiAgICBlcnJvcjogRXJyb3IsXG4gICAgbWV0YWRhdGE/OiBSZWNvcmQ8c3RyaW5nLCBhbnk+XG4gICk6IHZvaWQge1xuICAgIHRoaXMuZXJyb3IoYENhY2hlICR7b3BlcmF0aW9ufSBmYWlsZWQgZm9yIGtleTogJHtrZXl9YCwgZXJyb3IsIHtcbiAgICAgIC4uLm1ldGFkYXRhLFxuICAgICAgb3BlcmF0aW9uLFxuICAgICAga2V5XG4gICAgfSlcbiAgfVxuICBcbiAgcHJpdmF0ZSBsb2coXG4gICAgbGV2ZWw6IExvZ0xldmVsLFxuICAgIG1lc3NhZ2U6IHN0cmluZyxcbiAgICBtZXRhZGF0YT86IFJlY29yZDxzdHJpbmcsIGFueT4sXG4gICAgZXJyb3I/OiBMb2dFbnRyeVsnZXJyb3InXVxuICApOiB2b2lkIHtcbiAgICAvLyBPdmVycmlkZSB0byBhZGQgb3BlcmF0aW9uIHRyYWNraW5nXG4gICAgY29uc3QgZW50cnk6IExvZ0VudHJ5ID0ge1xuICAgICAgdGltZXN0YW1wOiBuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKCksXG4gICAgICBsZXZlbCxcbiAgICAgIG1lc3NhZ2UsXG4gICAgICBtb2R1bGU6ICdjYWNoZScsXG4gICAgICBvcGVyYXRpb246IG1ldGFkYXRhPy5vcGVyYXRpb24sXG4gICAgICBkdXJhdGlvbjogbWV0YWRhdGE/LmR1cmF0aW9uLFxuICAgICAgY29udGV4dDogdGhpcy5jb250ZXh0LFxuICAgICAgbWV0YWRhdGEsXG4gICAgICBlcnJvclxuICAgIH1cbiAgICBcbiAgICAvLyBDYWxsIHBhcmVudCB0cmFuc3BvcnRcbiAgICA7KHRoaXMgYXMgYW55KS50cmFuc3BvcnQoZW50cnkpXG4gIH1cbn1cblxuLy8gSlNPTiBmb3JtYXR0ZXIgZm9yIHByb2R1Y3Rpb24gbG9nZ2luZ1xuZXhwb3J0IGZ1bmN0aW9uIGpzb25UcmFuc3BvcnQoZW50cnk6IExvZ0VudHJ5KTogdm9pZCB7XG4gIGNvbnNvbGUubG9nKEpTT04uc3RyaW5naWZ5KGVudHJ5KSlcbn1cblxuLy8gUHJldHR5IGZvcm1hdHRlciBmb3IgZGV2ZWxvcG1lbnRcbmV4cG9ydCBmdW5jdGlvbiBwcmV0dHlUcmFuc3BvcnQoZW50cnk6IExvZ0VudHJ5KTogdm9pZCB7XG4gIGNvbnN0IHsgbGV2ZWwsIG1lc3NhZ2UsIG1vZHVsZSwgb3BlcmF0aW9uLCBkdXJhdGlvbiwgY29udGV4dCwgbWV0YWRhdGEsIGVycm9yIH0gPSBlbnRyeVxuICBcbiAgY29uc3QgcGFydHMgPSBbXG4gICAgYFske2VudHJ5LnRpbWVzdGFtcH1dYCxcbiAgICBgWyR7bW9kdWxlfV1gLFxuICAgIGxldmVsLnRvVXBwZXJDYXNlKCkucGFkRW5kKDUpXG4gIF1cbiAgXG4gIGlmIChjb250ZXh0Py5jb3JyZWxhdGlvbklkKSB7XG4gICAgcGFydHMucHVzaChgWyR7Y29udGV4dC5jb3JyZWxhdGlvbklkLnN1YnN0cmluZygwLCA4KX1dYClcbiAgfVxuICBcbiAgaWYgKG9wZXJhdGlvbikge1xuICAgIHBhcnRzLnB1c2goYFske29wZXJhdGlvbn1dYClcbiAgfVxuICBcbiAgcGFydHMucHVzaChtZXNzYWdlKVxuICBcbiAgaWYgKGR1cmF0aW9uICE9PSB1bmRlZmluZWQpIHtcbiAgICBwYXJ0cy5wdXNoKGAoJHtkdXJhdGlvbn1tcylgKVxuICB9XG4gIFxuICBjb25zdCBsb2dNZXNzYWdlID0gcGFydHMuam9pbignICcpXG4gIFxuICAvLyBMb2cgYmFzZWQgb24gbGV2ZWxcbiAgc3dpdGNoIChsZXZlbCkge1xuICAgIGNhc2UgJ2RlYnVnJzpcbiAgICAgIGNvbnNvbGUuZGVidWcobG9nTWVzc2FnZSwgbWV0YWRhdGEgfHwgJycpXG4gICAgICBicmVha1xuICAgIGNhc2UgJ2luZm8nOlxuICAgICAgY29uc29sZS5pbmZvKGxvZ01lc3NhZ2UsIG1ldGFkYXRhIHx8ICcnKVxuICAgICAgYnJlYWtcbiAgICBjYXNlICd3YXJuJzpcbiAgICAgIGNvbnNvbGUud2Fybihsb2dNZXNzYWdlLCBtZXRhZGF0YSB8fCAnJylcbiAgICAgIGlmIChlcnJvcikgY29uc29sZS53YXJuKGVycm9yKVxuICAgICAgYnJlYWtcbiAgICBjYXNlICdlcnJvcic6XG4gICAgICBjb25zb2xlLmVycm9yKGxvZ01lc3NhZ2UsIG1ldGFkYXRhIHx8ICcnKVxuICAgICAgaWYgKGVycm9yKSBjb25zb2xlLmVycm9yKGVycm9yKVxuICAgICAgYnJlYWtcbiAgfVxufVxuXG4vLyBIZWxwZXIgdG8gZ2VuZXJhdGUgY29ycmVsYXRpb24gSURzXG5leHBvcnQgZnVuY3Rpb24gZ2VuZXJhdGVDb3JyZWxhdGlvbklkKCk6IHN0cmluZyB7XG4gIHJldHVybiBgJHtEYXRlLm5vdygpfS0ke01hdGgucmFuZG9tKCkudG9TdHJpbmcoMzYpLnN1YnN0cmluZygyLCA5KX1gXG59Il0sIm5hbWVzIjpbIlN0cnVjdHVyZWRMb2dnZXIiLCJjb25zdHJ1Y3RvciIsIm1vZHVsZSIsImNvbnRleHQiLCJ0cmFuc3BvcnQiLCJkZWZhdWx0VHJhbnNwb3J0IiwiZGVidWciLCJtZXNzYWdlIiwibWV0YWRhdGEiLCJsb2ciLCJpbmZvIiwid2FybiIsImVycm9yIiwiZXJyb3JJbmZvIiwibmFtZSIsInN0YWNrIiwidW5kZWZpbmVkIiwiY2hpbGQiLCJsZXZlbCIsImVudHJ5IiwidGltZXN0YW1wIiwiRGF0ZSIsInRvSVNPU3RyaW5nIiwicmVzdCIsInByZWZpeCIsInRvVXBwZXJDYXNlIiwiY29udGV4dFN0ciIsImNvcnJlbGF0aW9uSWQiLCJjb25zb2xlIiwiQ2FjaGVMb2dnZXIiLCJsb2dPcGVyYXRpb24iLCJvcGVyYXRpb24iLCJrZXkiLCJkdXJhdGlvbiIsInN1Y2Nlc3MiLCJsb2dDYWNoZUhpdCIsInJlc3VsdCIsImxvZ0NhY2hlTWlzcyIsImxvZ0NhY2hlU2V0IiwidHRsIiwic2l6ZSIsImxvZ0NhY2hlRXJyb3IiLCJqc29uVHJhbnNwb3J0IiwiSlNPTiIsInN0cmluZ2lmeSIsInByZXR0eVRyYW5zcG9ydCIsInBhcnRzIiwicGFkRW5kIiwicHVzaCIsInN1YnN0cmluZyIsImxvZ01lc3NhZ2UiLCJqb2luIiwiZ2VuZXJhdGVDb3JyZWxhdGlvbklkIiwibm93IiwiTWF0aCIsInJhbmRvbSIsInRvU3RyaW5nIl0sImlnbm9yZUxpc3QiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./src/lib/cache/observability/logger.ts\n");

/***/ }),

/***/ "(rsc)/./src/lib/cache/observability/metrics.ts":
/*!************************************************!*\
  !*** ./src/lib/cache/observability/metrics.ts ***!
  \************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   CacheMetricsCollector: () => (/* binding */ CacheMetricsCollector),\n/* harmony export */   SimpleLatencyTracker: () => (/* binding */ SimpleLatencyTracker),\n/* harmony export */   formatMetricsForPrometheus: () => (/* binding */ formatMetricsForPrometheus)\n/* harmony export */ });\n// Cache observability metrics implementation\n// Provides performance tracking, monitoring, and structured logging\nclass SimpleLatencyTracker {\n    record(duration) {\n        this.samples.push(duration);\n        if (this.samples.length > this.maxSamples) {\n            this.samples.shift();\n        }\n    }\n    getAverage() {\n        if (this.samples.length === 0) return 0;\n        const sum = this.samples.reduce((a, b)=>a + b, 0);\n        return sum / this.samples.length;\n    }\n    getPercentile(percentile) {\n        if (this.samples.length === 0) return 0;\n        const sorted = [\n            ...this.samples\n        ].sort((a, b)=>a - b);\n        const index = Math.ceil(percentile / 100 * sorted.length) - 1;\n        return sorted[Math.max(0, index)];\n    }\n    reset() {\n        this.samples = [];\n    }\n    constructor(){\n        this.samples = [];\n        this.maxSamples = 1000;\n    }\n}\nclass CacheMetricsCollector {\n    constructor(initialStats){\n        this.getLatency = new SimpleLatencyTracker();\n        this.setLatency = new SimpleLatencyTracker();\n        this.hourlyWindow = [];\n        this.HOUR_IN_MS = 60 * 60 * 1000;\n        this.stats = initialStats;\n    }\n    recordOperation(operation, duration, success) {\n        if (operation === 'get') {\n            this.getLatency.record(duration);\n        } else {\n            this.setLatency.record(duration);\n        }\n        if (!success) {\n            this.stats.errors++;\n        }\n    }\n    recordEvent(event) {\n        const now = Date.now();\n        // Update stats based on event type\n        switch(event.type){\n            case 'hit':\n                this.stats.hits++;\n                break;\n            case 'miss':\n                this.stats.misses++;\n                break;\n            case 'stale-hit':\n                this.stats.staleHits++;\n                break;\n            case 'error':\n                this.stats.errors++;\n                break;\n        }\n        // Record for hourly metrics\n        this.hourlyWindow.push({\n            timestamp: now,\n            event: event.type\n        });\n        // Clean up old entries\n        this.cleanupHourlyWindow(now);\n    }\n    getMetrics() {\n        const totalOps = this.stats.hits + this.stats.misses;\n        const now = Date.now();\n        this.cleanupHourlyWindow(now);\n        const lastHour = this.calculateHourlyMetrics();\n        return {\n            // Performance metrics\n            hitRate: totalOps > 0 ? this.stats.hits / totalOps : 0,\n            missRate: totalOps > 0 ? this.stats.misses / totalOps : 0,\n            staleRate: this.stats.hits > 0 ? this.stats.staleHits / this.stats.hits : 0,\n            errorRate: totalOps > 0 ? this.stats.errors / totalOps : 0,\n            // Latency metrics\n            avgGetLatency: this.getLatency.getAverage(),\n            avgSetLatency: this.setLatency.getAverage(),\n            p95GetLatency: this.getLatency.getPercentile(95),\n            p95SetLatency: this.setLatency.getPercentile(95),\n            // Size metrics\n            totalSize: this.stats.size,\n            entryCount: this.stats.entries,\n            avgEntrySize: this.stats.entries > 0 ? this.stats.size / this.stats.entries : 0,\n            // Operation counts\n            totalGets: this.stats.hits + this.stats.misses,\n            totalSets: 0,\n            totalDeletes: 0,\n            totalErrors: this.stats.errors,\n            // Time-based metrics\n            lastHour\n        };\n    }\n    updateStats(stats) {\n        Object.assign(this.stats, stats);\n    }\n    reset() {\n        this.stats = {\n            hits: 0,\n            misses: 0,\n            staleHits: 0,\n            errors: 0,\n            size: 0,\n            entries: 0,\n            lastReset: Date.now()\n        };\n        this.getLatency.reset();\n        this.setLatency.reset();\n        this.hourlyWindow = [];\n    }\n    cleanupHourlyWindow(now) {\n        const hourAgo = now - this.HOUR_IN_MS;\n        this.hourlyWindow = this.hourlyWindow.filter((entry)=>entry.timestamp > hourAgo);\n    }\n    calculateHourlyMetrics() {\n        const counts = {\n            hits: 0,\n            misses: 0,\n            sets: 0,\n            errors: 0\n        };\n        for (const entry of this.hourlyWindow){\n            switch(entry.event){\n                case 'hit':\n                    counts.hits++;\n                    break;\n                case 'miss':\n                    counts.misses++;\n                    break;\n                case 'set':\n                    counts.sets++;\n                    break;\n                case 'error':\n                    counts.errors++;\n                    break;\n            }\n        }\n        return counts;\n    }\n}\n// Prometheus-style metrics formatter\nfunction formatMetricsForPrometheus(metrics, prefix = 'cache') {\n    const lines = [\n        `# HELP ${prefix}_hit_rate Cache hit rate (0-1)`,\n        `# TYPE ${prefix}_hit_rate gauge`,\n        `${prefix}_hit_rate ${metrics.hitRate.toFixed(4)}`,\n        `# HELP ${prefix}_miss_rate Cache miss rate (0-1)`,\n        `# TYPE ${prefix}_miss_rate gauge`,\n        `${prefix}_miss_rate ${metrics.missRate.toFixed(4)}`,\n        `# HELP ${prefix}_error_rate Cache error rate (0-1)`,\n        `# TYPE ${prefix}_error_rate gauge`,\n        `${prefix}_error_rate ${metrics.errorRate.toFixed(4)}`,\n        `# HELP ${prefix}_get_latency_avg Average GET latency in milliseconds`,\n        `# TYPE ${prefix}_get_latency_avg gauge`,\n        `${prefix}_get_latency_avg ${metrics.avgGetLatency.toFixed(2)}`,\n        `# HELP ${prefix}_get_latency_p95 95th percentile GET latency in milliseconds`,\n        `# TYPE ${prefix}_get_latency_p95 gauge`,\n        `${prefix}_get_latency_p95 ${metrics.p95GetLatency.toFixed(2)}`,\n        `# HELP ${prefix}_size_bytes Total cache size in bytes`,\n        `# TYPE ${prefix}_size_bytes gauge`,\n        `${prefix}_size_bytes ${metrics.totalSize}`,\n        `# HELP ${prefix}_entries Total number of cache entries`,\n        `# TYPE ${prefix}_entries gauge`,\n        `${prefix}_entries ${metrics.entryCount}`,\n        `# HELP ${prefix}_operations_total Total cache operations by type`,\n        `# TYPE ${prefix}_operations_total counter`,\n        `${prefix}_operations_total{type=\"get\"} ${metrics.totalGets}`,\n        `${prefix}_operations_total{type=\"error\"} ${metrics.totalErrors}`\n    ];\n    return lines.join('\\n');\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9zcmMvbGliL2NhY2hlL29ic2VydmFiaWxpdHkvbWV0cmljcy50cyIsIm1hcHBpbmdzIjoiOzs7Ozs7QUFBQSw2Q0FBNkM7QUFDN0Msb0VBQW9FO0FBNEM3RCxNQUFNQTtJQUlYQyxPQUFPQyxRQUFnQixFQUFRO1FBQzdCLElBQUksQ0FBQ0MsT0FBTyxDQUFDQyxJQUFJLENBQUNGO1FBQ2xCLElBQUksSUFBSSxDQUFDQyxPQUFPLENBQUNFLE1BQU0sR0FBRyxJQUFJLENBQUNDLFVBQVUsRUFBRTtZQUN6QyxJQUFJLENBQUNILE9BQU8sQ0FBQ0ksS0FBSztRQUNwQjtJQUNGO0lBRUFDLGFBQXFCO1FBQ25CLElBQUksSUFBSSxDQUFDTCxPQUFPLENBQUNFLE1BQU0sS0FBSyxHQUFHLE9BQU87UUFDdEMsTUFBTUksTUFBTSxJQUFJLENBQUNOLE9BQU8sQ0FBQ08sTUFBTSxDQUFDLENBQUNDLEdBQUdDLElBQU1ELElBQUlDLEdBQUc7UUFDakQsT0FBT0gsTUFBTSxJQUFJLENBQUNOLE9BQU8sQ0FBQ0UsTUFBTTtJQUNsQztJQUVBUSxjQUFjQyxVQUFrQixFQUFVO1FBQ3hDLElBQUksSUFBSSxDQUFDWCxPQUFPLENBQUNFLE1BQU0sS0FBSyxHQUFHLE9BQU87UUFDdEMsTUFBTVUsU0FBUztlQUFJLElBQUksQ0FBQ1osT0FBTztTQUFDLENBQUNhLElBQUksQ0FBQyxDQUFDTCxHQUFHQyxJQUFNRCxJQUFJQztRQUNwRCxNQUFNSyxRQUFRQyxLQUFLQyxJQUFJLENBQUMsYUFBYyxNQUFPSixPQUFPVixNQUFNLElBQUk7UUFDOUQsT0FBT1UsTUFBTSxDQUFDRyxLQUFLRSxHQUFHLENBQUMsR0FBR0gsT0FBTztJQUNuQztJQUVBSSxRQUFjO1FBQ1osSUFBSSxDQUFDbEIsT0FBTyxHQUFHLEVBQUU7SUFDbkI7O2FBekJRQSxVQUF5QixFQUFFO2FBQzNCRyxhQUFhOztBQXlCdkI7QUFFTyxNQUFNZ0I7SUFPWEMsWUFBWUMsWUFBd0IsQ0FBRTthQUw5QkMsYUFBYSxJ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QUM7UUFDeEQsQ0FBQyxPQUFPLEVBQUVBLE9BQU8sY0FBYyxDQUFDO1FBQ2hDLEdBQUdBLE9BQU8sU0FBUyxFQUFFRCxRQUFRakIsVUFBVSxFQUFFO1FBRXpDLENBQUMsT0FBTyxFQUFFa0IsT0FBTyxnREFBZ0QsQ0FBQztRQUNsRSxDQUFDLE9BQU8sRUFBRUEsT0FBTyx5QkFBeUIsQ0FBQztRQUMzQyxHQUFHQSxPQUFPLDhCQUE4QixFQUFFRCxRQUFRZCxTQUFTLEVBQUU7UUFDN0QsR0FBR2UsT0FBTyxnQ0FBZ0MsRUFBRUQsUUFBUVgsV0FBVyxFQUFFO0tBQ2xFO0lBRUQsT0FBT2EsTUFBTUUsSUFBSSxDQUFDO0FBQ3BCIiwic291cmNlcyI6WyIvVXNlcnMvcnViZWVuL2Rldi9wZXJzb25hbC9haXJwb3J0LWRiL3NyYy9saWIvY2FjaGUvb2JzZXJ2YWJpbGl0eS9tZXRyaWNzLnRzIl0sInNvdXJjZXNDb250ZW50IjpbIi8vIENhY2hlIG9ic2VydmFiaWxpdHkgbWV0cmljcyBpbXBsZW1lbnRhdGlvblxuLy8gUHJvdmlkZXMgcGVyZm9ybWFuY2UgdHJhY2tpbmcsIG1vbml0b3JpbmcsIGFuZCBzdHJ1Y3R1cmVkIGxvZ2dpbmdcblxuaW1wb3J0IHR5cGUgeyBDYWNoZUV2ZW50LCBDYWNoZUV2ZW50VHlwZSwgQ2FjaGVTdGF0cyB9IGZyb20gJy4uL3R5cGVzJ1xuXG5leHBvcnQgaW50ZXJmYWNlIENhY2hlTWV0cmljcyB7XG4gIC8vIFBlcmZvcm1hbmNlIG1ldHJpY3NcbiAgaGl0UmF0ZTogbnVtYmVyXG4gIG1pc3NSYXRlOiBudW1iZXJcbiAgc3RhbGVSYXRlOiBudW1iZXJcbiAgZXJyb3JSYXRlOiBudW1iZXJcbiAgXG4gIC8vIExhdGVuY3kgbWV0cmljcyAoaW4gbXMpXG4gIGF2Z0dldExhdGVuY3k6IG51bWJlclxuICBhdmdTZXRMYXRlbmN5OiBudW1iZXJcbiAgcDk1R2V0TGF0ZW5jeTogbnVtYmVyXG4gIHA5NVNldExhdGVuY3k6IG51bWJlclxuICBcbiAgLy8gU2l6ZSBtZXRyaWNzXG4gIHRvdGFsU2l6ZTogbnVtYmVyXG4gIGVudHJ5Q291bnQ6IG51bWJlclxuICBhdmdFbnRyeVNpemU6IG51bWJlclxuICBcbiAgLy8gT3BlcmF0aW9uIGNvdW50c1xuICB0b3RhbEdldHM6IG51bWJlclxuICB0b3RhbFNldHM6IG51bWJlclxuICB0b3RhbERlbGV0ZXM6IG51bWJlclxuICB0b3RhbEVycm9yczogbnVtYmVyXG4gIFxuICAvLyBUaW1lLWJhc2VkIG1ldHJpY3NcbiAgbGFzdEhvdXI6IHtcbiAgICBoaXRzOiBudW1iZXJcbiAgICBtaXNzZXM6IG51bWJlclxuICAgIHNldHM6IG51bWJlclxuICAgIGVycm9yczogbnVtYmVyXG4gIH1cbn1cblxuZXhwb3J0IGludGVyZmFjZSBMYXRlbmN5VHJhY2tlciB7XG4gIHJlY29yZDogKGR1cmF0aW9uOiBudW1iZXIpID0+IHZvaWRcbiAgZ2V0QXZlcmFnZTogKCkgPT4gbnVtYmVyXG4gIGdldFBlcmNlbnRpbGU6IChwZXJjZW50aWxlOiBudW1iZXIpID0+IG51bWJlclxuICByZXNldDogKCkgPT4gdm9pZFxufVxuXG5leHBvcnQgY2xhc3MgU2ltcGxlTGF0ZW5jeVRyYWNrZXIgaW1wbGVtZW50cyBMYXRlbmN5VHJhY2tlciB7XG4gIHByaXZhdGUgc2FtcGxlczogQXJyYXk8bnVtYmVyPiA9IFtdXG4gIHByaXZhdGUgbWF4U2FtcGxlcyA9IDEwMDBcbiAgXG4gIHJlY29yZChkdXJhdGlvbjogbnVtYmVyKTogdm9pZCB7XG4gICAgdGhpcy5zYW1wbGVzLnB1c2goZHVyYXRpb24pXG4gICAgaWYgKHRoaXMuc2FtcGxlcy5sZW5ndGggPiB0aGlzLm1heFNhbXBsZXMpIHtcbiAgICAgIHRoaXMuc2FtcGxlcy5zaGlmdCgpXG4gICAgfVxuICB9XG4gIFxuICBnZXRBdmVyYWdlKCk6IG51bWJlciB7XG4gICAgaWYgKHRoaXMuc2FtcGxlcy5sZW5ndGggPT09IDApIHJldHVybiAwXG4gICAgY29uc3Qgc3VtID0gdGhpcy5zYW1wbGVzLnJlZHVjZSgoYSwgYikgPT4gYSArIGIsIDApXG4gICAgcmV0dXJuIHN1bSAvIHRoaXMuc2FtcGxlcy5sZW5ndGhcbiAgfVxuICBcbiAgZ2V0UGVyY2VudGlsZShwZXJjZW50aWxlOiBudW1iZXIpOiBudW1iZXIge1xuICAgIGlmICh0aGlzLnNhbXBsZXMubGVuZ3RoID09PSAwKSByZXR1cm4gMFxuICAgIGNvbnN0IHNvcnRlZCA9IFsuLi50aGlzLnNhbXBsZXNdLnNvcnQoKGEsIGIpID0+IGEgLSBiKVxuICAgIGNvbnN0IGluZGV4ID0gTWF0aC5jZWlsKChwZXJjZW50aWxlIC8gMTAwKSAqIHNvcnRlZC5sZW5ndGgpIC0gMVxuICAgIHJldHVybiBzb3J0ZWRbTWF0aC5tYXgoMCwgaW5kZXgpXVxuICB9XG4gIFxuICByZXNldCgpOiB2b2lkIHtcbiAgICB0aGlzLnNhbXBsZXMgPSBbXVxuICB9XG59XG5cbmV4cG9ydCBjbGFzcyBDYWNoZU1ldHJpY3NDb2xsZWN0b3Ige1xuICBwcml2YXRlIHN0YXRzOiBDYWNoZVN0YXRzXG4gIHByaXZhdGUgZ2V0TGF0ZW5jeSA9IG5ldyBTaW1wbGVMYXRlbmN5VHJhY2tlcigpXG4gIHByaXZhdGUgc2V0TGF0ZW5jeSA9IG5ldyBTaW1wbGVMYXRlbmN5VHJhY2tlcigpXG4gIHByaXZhdGUgaG91cmx5V2luZG93OiBBcnJheTx7IHRpbWVzdGFtcDogbnVtYmVyOyBldmVudDogQ2FjaGVFdmVudFR5cGUgfT4gPSBbXVxuICBwcml2YXRlIHJlYWRvbmx5IEhPVVJfSU5fTVMgPSA2MCAqIDYwICogMTAwMFxuICBcbiAgY29uc3RydWN0b3IoaW5pdGlhbFN0YXRzOiBDYWNoZVN0YXRzKSB7XG4gICAgdGhpcy5zdGF0cyA9IGluaXRpYWxTdGF0c1xuICB9XG4gIFxuICByZWNvcmRPcGVyYXRpb24oXG4gICAgb3BlcmF0aW9uOiAnZ2V0JyB8ICdzZXQnLFxuICAgIGR1cmF0aW9uOiBudW1iZXIsXG4gICAgc3VjY2VzczogYm9vbGVhblxuICApOiB2b2lkIHtcbiAgICBpZiAob3BlcmF0aW9uID09PSAnZ2V0Jykge1xuICAgICAgdGhpcy5nZXRMYXRlbmN5LnJlY29yZChkdXJhdGlvbilcbiAgICB9IGVsc2Uge1xuICAgICAgdGhpcy5zZXRMYXRlbmN5LnJlY29yZChkdXJhdGlvbilcbiAgICB9XG4gICAgXG4gICAgaWYgKCFzdWNjZXNzKSB7XG4gICAgICB0aGlzLnN0YXRzLmVycm9ycysrXG4gICAgfVxuICB9XG4gIFxuICByZWNvcmRFdmVudChldmVudDogQ2FjaGVFdmVudCk6IHZvaWQge1xuICAgIGNvbnN0IG5vdyA9IERhdGUubm93KClcbiAgICBcbiAgICAvLyBVcGRhdGUgc3RhdHMgYmFzZWQgb24gZXZlbnQgdHlwZVxuICAgIHN3aXRjaCAoZXZlbnQudHlwZSkge1xuICAgICAgY2FzZSAnaGl0JzpcbiAgICAgICAgdGhpcy5zdGF0cy5oaXRzKytcbiAgICAgICAgYnJlYWtcbiAgICAgIGNhc2UgJ21pc3MnOlxuICAgICAgICB0aGlzLnN0YXRzLm1pc3NlcysrXG4gICAgICAgIGJyZWFrXG4gICAgICBjYXNlICdzdGFsZS1oaXQnOlxuICAgICAgICB0aGlzLnN0YXRzLnN0YWxlSGl0cysrXG4gICAgICAgIGJyZWFrXG4gICAgICBjYXNlICdlcnJvcic6XG4gICAgICAgIHRoaXMuc3RhdHMuZXJyb3JzKytcbiAgICAgICAgYnJlYWtcbiAgICB9XG4gICAgXG4gICAgLy8gUmVjb3JkIGZvciBob3VybHkgbWV0cmljc1xuICAgIHRoaXMuaG91cmx5V2luZG93LnB1c2goe1xuICAgICAgdGltZXN0YW1wOiBub3csXG4gICAgICBldmVudDogZXZlbnQudHlwZVxuICAgIH0pXG4gICAgXG4gICAgLy8gQ2xlYW4gdXAgb2xkIGVudHJpZXNcbiAgICB0aGlzLmNsZWFudXBIb3VybHlXaW5kb3cobm93KVxuICB9XG4gIFxuICBnZXRNZXRyaWNzKCk6IENhY2hlTWV0cmljcyB7XG4gICAgY29uc3QgdG90YWxPcHMgPSB0aGlzLnN0YXRzLmhpdHMgKyB0aGlzLnN0YXRzLm1pc3Nlc1xuICAgIGNvbnN0IG5vdyA9IERhdGUubm93KClcbiAgICBcbiAgICB0aGlzLmNsZWFudXBIb3VybHlXaW5kb3cobm93KVxuICAgIFxuICAgIGNvbnN0IGxhc3RIb3VyID0gdGhpcy5jYWxjdWxhdGVIb3VybHlNZXRyaWNzKClcbiAgICBcbiAgICByZXR1cm4ge1xuICAgICAgLy8gUGVyZm9ybWFuY2UgbWV0cmljc1xuICAgICAgaGl0UmF0ZTogdG90YWxPcHMgPiAwID8gdGhpcy5zdGF0cy5oaXRzIC8gdG90YWxPcHMgOiAwLFxuICAgICAgbWlzc1JhdGU6IHRvdGFsT3BzID4gMCA/IHRoaXMuc3RhdHMubWlzc2VzIC8gdG90YWxPcHMgOiAwLFxuICAgICAgc3RhbGVSYXRlOiB0aGlzLnN0YXRzLmhpdHMgPiAwID8gdGhpcy5zdGF0cy5zdGFsZUhpdHMgLyB0aGlzLnN0YXRzLmhpdHMgOiAwLFxuICAgICAgZXJyb3JSYXRlOiB0b3RhbE9wcyA+IDAgPyB0aGlzLnN0YXRzLmVycm9ycyAvIHRvdGFsT3BzIDogMCxcbiAgICAgIFxuICAgICAgLy8gTGF0ZW5jeSBtZXRyaWNzXG4gICAgICBhdmdHZXRMYXRlbmN5OiB0aGlzLmdldExhdGVuY3kuZ2V0QXZlcmFnZSgpLFxuICAgICAgYXZnU2V0TGF0ZW5jeTogdGhpcy5zZXRMYXRlbmN5LmdldEF2ZXJhZ2UoKSxcbiAgICAgIHA5NUdldExhdGVuY3k6IHRoaXMuZ2V0TGF0ZW5jeS5nZXRQZXJjZW50aWxlKDk1KSxcbiAgICAgIHA5NVNldExhdGVuY3k6IHRoaXMuc2V0TGF0ZW5jeS5nZXRQZXJjZW50aWxlKDk1KSxcbiAgICAgIFxuICAgICAgLy8gU2l6ZSBtZXRyaWNzXG4gICAgICB0b3RhbFNpemU6IHRoaXMuc3RhdHMuc2l6ZSxcbiAgICAgIGVudHJ5Q291bnQ6IHRoaXMuc3RhdHMuZW50cmllcyxcbiAgICAgIGF2Z0VudHJ5U2l6ZTogdGhpcy5zdGF0cy5lbnRyaWVzID4gMCA/IHRoaXMuc3RhdHMuc2l6ZSAvIHRoaXMuc3RhdHMuZW50cmllcyA6IDAsXG4gICAgICBcbiAgICAgIC8vIE9wZXJhdGlvbiBjb3VudHNcbiAgICAgIHRvdGFsR2V0czogdGhpcy5zdGF0cy5oaXRzICsgdGhpcy5zdGF0cy5taXNzZXMsXG4gICAgICB0b3RhbFNldHM6IDAsIC8vIFdvdWxkIG5lZWQgdG8gdHJhY2sgdGhpcyBzZXBhcmF0ZWx5XG4gICAgICB0b3RhbERlbGV0ZXM6IDAsIC8vIFdvdWxkIG5lZWQgdG8gdHJhY2sgdGhpcyBzZXBhcmF0ZWx5XG4gICAgICB0b3RhbEVycm9yczogdGhpcy5zdGF0cy5lcnJvcnMsXG4gICAgICBcbiAgICAgIC8vIFRpbWUtYmFzZWQgbWV0cmljc1xuICAgICAgbGFzdEhvdXJcbiAgICB9XG4gIH1cbiAgXG4gIHVwZGF0ZVN0YXRzKHN0YXRzOiBQYXJ0aWFsPENhY2hlU3RhdHM+KTogdm9pZCB7XG4gICAgT2JqZWN0LmFzc2lnbih0aGlzLnN0YXRzLCBzdGF0cylcbiAgfVxuICBcbiAgcmVzZXQoKTogdm9pZCB7XG4gICAgdGhpcy5zdGF0cyA9IHtcbiAgICAgIGhpdHM6IDAsXG4gICAgICBtaXNzZXM6IDAsXG4gICAgICBzdGFsZUhpdHM6IDAsXG4gICAgICBlcnJvcnM6IDAsXG4gICAgICBzaXplOiAwLFxuICAgICAgZW50cmllczogMCxcbiAgICAgIGxhc3RSZXNldDogRGF0ZS5ub3coKVxuICAgIH1cbiAgICB0aGlzLmdldExhdGVuY3kucmVzZXQoKVxuICAgIHRoaXMuc2V0TGF0ZW5jeS5yZXNldCgpXG4gICAgdGhpcy5ob3VybHlXaW5kb3cgPSBbXVxuICB9XG4gIFxuICBwcml2YXRlIGNsZWFudXBIb3VybHlXaW5kb3cobm93OiBudW1iZXIpOiB2b2lkIHtcbiAgICBjb25zdCBob3VyQWdvID0gbm93IC0gdGhpcy5IT1VSX0lOX01TXG4gICAgdGhpcy5ob3VybHlXaW5kb3cgPSB0aGlzLmhvdXJseVdpbmRvdy5maWx0ZXIoXG4gICAgICBlbnRyeSA9PiBlbnRyeS50aW1lc3RhbXAgPiBob3VyQWdvXG4gICAgKVxuICB9XG4gIFxuICBwcml2YXRlIGNhbGN1bGF0ZUhvdXJseU1ldHJpY3MoKSB7XG4gICAgY29uc3QgY291bnRzID0ge1xuICAgICAgaGl0czogMCxcbiAgICAgIG1pc3NlczogMCxcbiAgICAgIHNldHM6IDAsXG4gICAgICBlcnJvcnM6IDBcbiAgICB9XG4gICAgXG4gICAgZm9yIChjb25zdCBlbnRyeSBvZiB0aGlzLmhvdXJseVdpbmRvdykge1xuICAgICAgc3dpdGNoIChlbnRyeS5ldmVudCkge1xuICAgICAgICBjYXNlICdoaXQnOlxuICAgICAgICAgIGNvdW50cy5oaXRzKytcbiAgICAgICAgICBicmVha1xuICAgICAgICBjYXNlICdtaXNzJzpcbiAgICAgICAgICBjb3VudHMubWlzc2VzKytcbiAgICAgICAgICBicmVha1xuICAgICAgICBjYXNlICdzZXQnOlxuICAgICAgICAgIGNvdW50cy5zZXRzKytcbiAgICAgICAgICBicmVha1xuICAgICAgICBjYXNlICdlcnJvcic6XG4gICAgICAgICAgY291bnRzLmVycm9ycysrXG4gICAgICAgICAgYnJlYWtcbiAgICAgIH1cbiAgICB9XG4gICAgXG4gICAgcmV0dXJuIGNvdW50c1xuICB9XG59XG5cbi8vIFByb21ldGhldXMtc3R5bGUgbWV0cmljcyBmb3JtYXR0ZXJcbmV4cG9ydCBmdW5jdGlvbiBmb3JtYXRNZXRyaWNzRm9yUHJvbWV0aGV1cyhcbiAgbWV0cmljczogQ2FjaGVNZXRyaWNzLFxuICBwcmVmaXggPSAnY2FjaGUnXG4pOiBzdHJpbmcge1xuICBjb25zdCBsaW5lczogQXJyYXk8c3RyaW5nPiA9IFtcbiAgICBgIyBIRUxQICR7cHJlZml4fV9oaXRfcmF0ZSBDYWNoZSBoaXQgcmF0ZSAoMC0xKWAsXG4gICAgYCMgVFlQRSAke3ByZWZpeH1faGl0X3JhdGUgZ2F1Z2VgLFxuICAgIGAke3ByZWZpeH1faGl0X3JhdGUgJHttZXRyaWNzLmhpdFJhdGUudG9GaXhlZCg0KX1gLFxuICAgIFxuICAgIGAjIEhFTFAgJHtwcmVmaXh9X21pc3NfcmF0ZSBDYWNoZSBtaXNzIHJhdGUgKDAtMSlgLFxuICAgIGAjIFRZUEUgJHtwcmVmaXh9X21pc3NfcmF0ZSBnYXVnZWAsXG4gICAgYCR7cHJlZml4fV9taXNzX3JhdGUgJHttZXRyaWNzLm1pc3NSYXRlLnRvRml4ZWQoNCl9YCxcbiAgICBcbiAgICBgIyBIRUxQICR7cHJlZml4fV9lcnJvcl9yYXRlIENhY2hlIGVycm9yIHJhdGUgKDAtMSlgLFxuICAgIGAjIFRZUEUgJHtwcmVmaXh9X2Vycm9yX3JhdGUgZ2F1Z2VgLFxuICAgIGAke3ByZWZpeH1fZXJyb3JfcmF0ZSAke21ldHJpY3MuZXJyb3JSYXRlLnRvRml4ZWQoNCl9YCxcbiAgICBcbiAgICBgIyBIRUxQICR7cHJlZml4fV9nZXRfbGF0ZW5jeV9hdmcgQXZlcmFnZSBHRVQgbGF0ZW5jeSBpbiBtaWxsaXNlY29uZHNgLFxuICAgIGAjIFRZUEUgJHtwcmVmaXh9X2dldF9sYXRlbmN5X2F2ZyBnYXVnZWAsXG4gICAgYCR7cHJlZml4fV9nZXRfbGF0ZW5jeV9hdmcgJHttZXRyaWNzLmF2Z0dldExhdGVuY3kudG9GaXhlZCgyKX1gLFxuICAgIFxuICAgIGAjIEhFTFAgJHtwcmVmaXh9X2dldF9sYXRlbmN5X3A5NSA5NXRoIHBlcmNlbnRpbGUgR0VUIGxhdGVuY3kgaW4gbWlsbGlzZWNvbmRzYCxcbiAgICBgIyBUWVBFICR7cHJlZml4fV9nZXRfbGF0ZW5jeV9wOTUgZ2F1Z2VgLFxuICAgIGAke3ByZWZpeH1fZ2V0X2xhdGVuY3lfcDk1ICR7bWV0cmljcy5wOTVHZXRMYXRlbmN5LnRvRml4ZWQoMil9YCxcbiAgICBcbiAgICBgIyBIRUxQICR7cHJlZml4fV9zaXplX2J5dGVzIFRvdGFsIGNhY2hlIHNpemUgaW4gYnl0ZXNgLFxuICAgIGAjIFRZUEUgJHtwcmVmaXh9X3NpemVfYnl0ZXMgZ2F1Z2VgLFxuICAgIGAke3ByZWZpeH1fc2l6ZV9ieXRlcyAke21ldHJpY3MudG90YWxTaXplfWAsXG4gICAgXG4gICAgYCMgSEVMUCAke3ByZWZpeH1fZW50cmllcyBUb3RhbCBudW1iZXIgb2YgY2FjaGUgZW50cmllc2AsXG4gICAgYCMgVFlQRSAke3ByZWZpeH1fZW50cmllcyBnYXVnZWAsXG4gICAgYCR7cHJlZml4fV9lbnRyaWVzICR7bWV0cmljcy5lbnRyeUNvdW50fWAsXG4gICAgXG4gICAgYCMgSEVMUCAke3ByZWZpeH1fb3BlcmF0aW9uc190b3RhbCBUb3RhbCBjYWNoZSBvcGVyYXRpb25zIGJ5IHR5cGVgLFxuICAgIGAjIFRZUEUgJHtwcmVmaXh9X29wZXJhdGlvbnNfdG90YWwgY291bnRlcmAsXG4gICAgYCR7cHJlZml4fV9vcGVyYXRpb25zX3RvdGFse3R5cGU9XCJnZXRcIn0gJHttZXRyaWNzLnRvdGFsR2V0c31gLFxuICAgIGAke3ByZWZpeH1fb3BlcmF0aW9uc190b3RhbHt0eXBlPVwiZXJyb3JcIn0gJHttZXRyaWNzLnRvdGFsRXJyb3JzfWAsXG4gIF1cbiAgXG4gIHJldHVybiBsaW5lcy5qb2luKCdcXG4nKVxufSJdLCJuYW1lcyI6WyJTaW1wbGVMYXRlbmN5VHJhY2tlciIsInJlY29yZCIsImR1cmF0aW9uIiwic2FtcGxlcyIsInB1c2giLCJsZW5ndGgiLCJtYXhTYW1wbGVzIiwic2hpZnQiLCJnZXRBdmVyYWdlIiwic3VtIiwicmVkdWNlIiwiYSIsImIiLCJnZXRQZXJjZW50aWxlIiwicGVyY2VudGlsZSIsInNvcnRlZCIsInNvcnQiLCJpbmRleCIsIk1hdGgiLCJjZWlsIiwibWF4IiwicmVzZXQiLCJDYWNoZU1ldHJpY3NDb2xsZWN0b3IiLCJjb25zdHJ1Y3RvciIsImluaXRpYWxTdGF0cyIsImdldExhdGVuY3kiLCJzZXRMYXRlbmN5IiwiaG91cmx5V2luZG93IiwiSE9VUl9JTl9NUyIsInN0YXRzIiwicmVjb3JkT3BlcmF0aW9uIiwib3BlcmF0aW9uIiwic3VjY2VzcyIsImVycm9ycyIsInJlY29yZEV2ZW50IiwiZXZlbnQiLCJub3ciLCJEYXRlIiwidHlwZSIsImhpdHMiLCJtaXNzZXMiLCJzdGFsZUhpdHMiLCJ0aW1lc3RhbXAiLCJjbGVhbnVwSG91cmx5V2luZG93IiwiZ2V0TWV0cmljcyIsInRvdGFsT3BzIiwibGFzdEhvdXIiLCJjYWxjdWxhdGVIb3VybHlNZXRyaWNzIiwiaGl0UmF0ZSIsIm1pc3NSYXRlIiwic3RhbGVSYXRlIiwiZXJyb3JSYXRlIiwiYXZnR2V0TGF0ZW5jeSIsImF2Z1NldExhdGVuY3kiLCJwOTVHZXRMYXRlbmN5IiwicDk1U2V0TGF0ZW5jeSIsInRvdGFsU2l6ZSIsInNpemUiLCJlbnRyeUNvdW50IiwiZW50cmllcyIsImF2Z0VudHJ5U2l6ZSIsInRvdGFsR2V0cyIsInRvdGFsU2V0cyIsInRvdGFsRGVsZXRlcyIsInRvdGFsRXJyb3JzIiwidXBkYXRlU3RhdHMiLCJPYmplY3QiLCJhc3NpZ24iLCJsYXN0UmVzZXQiLCJob3VyQWdvIiwiZmlsdGVyIiwiZW50cnkiLCJjb3VudHMiLCJzZXRzIiwiZm9ybWF0TWV0cmljc0ZvclByb21ldGhldXMiLCJtZXRyaWNzIiwicHJlZml4IiwibGluZXMiLCJ0b0ZpeGVkIiwiam9pbiJdLCJpZ25vcmVMaXN0IjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./src/lib/cache/observability/metrics.ts\n");

/***/ }),

/***/ "(rsc)/./src/server/services/airportCache.ts":
/*!*********************************************!*\
  !*** ./src/server/services/airportCache.ts ***!
  \*********************************************/
/***/ ((module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.a(module, async (__webpack_handle_async_dependencies__, __webpack_async_result__) => { try {\n__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   airportCache: () => (/* binding */ airportCache)\n/* harmony export */ });\n/* harmony import */ var _redisClient__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./redisClient */ \"(rsc)/./src/server/services/redisClient.ts\");\n/* harmony import */ var _concurrencyManager__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./concurrencyManager */ \"(rsc)/./src/server/services/concurrencyManager.ts\");\n/* harmony import */ var _inMemoryCache__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./inMemoryCache */ \"(rsc)/./src/server/services/inMemoryCache.ts\");\n/* harmony import */ var _circuitBreaker__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./circuitBreaker */ \"(rsc)/./src/server/services/circuitBreaker.ts\");\n/* harmony import */ var _lib_cache_observability__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../lib/cache/observability */ \"(rsc)/./src/lib/cache/observability/index.ts\");\nvar __webpack_async_dependencies__ = __webpack_handle_async_dependencies__([_redisClient__WEBPACK_IMPORTED_MODULE_0__, _concurrencyManager__WEBPACK_IMPORTED_MODULE_1__]);\n([_redisClient__WEBPACK_IMPORTED_MODULE_0__, _concurrencyManager__WEBPACK_IMPORTED_MODULE_1__] = __webpack_async_dependencies__.then ? (await __webpack_async_dependencies__)() : __webpack_async_dependencies__);\n// Airport caching service implementation\n\n\n\n\n\nconst DEFAULT_TTL = parseInt(process.env.AIRPORT_CACHE_TTL || '2592000', 10) // 30 days\n;\nconst CACHE_PREFIX = 'airport:';\nconst STATS_KEY = 'airport:stats';\nconst USE_IN_MEMORY_FALLBACK = process.env.USE_IN_MEMORY_CACHE_FALLBACK !== 'false';\nconst logger = new _lib_cache_observability__WEBPACK_IMPORTED_MODULE_4__.StructuredLogger('airport-cache', {},  false ? 0 : _lib_cache_observability__WEBPACK_IMPORTED_MODULE_4__.prettyTransport);\nclass AirportCacheService {\n    constructor(){\n        this.redis = null;\n        this.fallbackMode = false;\n        this.exponentialBackoff = new _circuitBreaker__WEBPACK_IMPORTED_MODULE_3__.ExponentialBackoff(parseInt(process.env.REDIS_BACKOFF_BASE_DELAY || '1000', 10), parseInt(process.env.REDIS_BACKOFF_MAX_DELAY || '30000', 10), parseInt(process.env.REDIS_BACKOFF_MAX_ATTEMPTS || '3', 10));\n    }\n    async initialize() {\n        this.redis = await (0,_redisClient__WEBPACK_IMPORTED_MODULE_0__.getRedisClient)();\n        if (!this.redis) {\n            logger.warn('Redis not available, operating in fallback mode');\n            this.fallbackMode = true;\n        }\n        // Initialize in-memory cache if fallback is enabled\n        if (USE_IN_MEMORY_FALLBACK) {\n            await _inMemoryCache__WEBPACK_IMPORTED_MODULE_2__.inMemoryAirportCache.initialize();\n        }\n        await _concurrencyManager__WEBPACK_IMPORTED_MODULE_1__.concurrencyManager.initialize();\n    }\n    getCacheKey(code) {\n        return `${CACHE_PREFIX}${code.toUpperCase()}`;\n    }\n    async get(code) {\n        const key = this.getCacheKey(code);\n        const circuitBreaker = (0,_redisClient__WEBPACK_IMPORTED_MODULE_0__.getRedisCircuitBreaker)();\n        // If Redis is in fallback mode or circuit is open, try in-memory cache\n        if (this.fallbackMode || !this.redis || circuitBreaker && circuitBreaker.getState() === _circuitBreaker__WEBPACK_IMPORTED_MODULE_3__.CircuitState.OPEN) {\n            if (USE_IN_MEMORY_FALLBACK) {\n                logger.debug('Using in-memory cache fallback', {\n                    code\n                });\n                const result = await _inMemoryCache__WEBPACK_IMPORTED_MODULE_2__.inMemoryAirportCache.get(key);\n                if (result) {\n                    await this.incrementStat('hits');\n                    return result;\n                }\n            }\n            await this.incrementStat('misses');\n            return null;\n        }\n        try {\n            // Try Redis with exponential backoff\n            const cached = await this.exponentialBackoff.execute(async ()=>{\n                if (!this.redis) throw new Error('Redis client not available');\n                return await this.redis.get(key);\n            });\n            if (!cached) {\n                // Check in-memory cache as second level\n                if (USE_IN_MEMORY_FALLBACK) {\n                    const inMemoryResult = await _inMemoryCache__WEBPACK_IMPORTED_MODULE_2__.inMemoryAirportCache.get(key);\n                    if (inMemoryResult) {\n                        await this.incrementStat('hits');\n                        logger.debug('Cache hit from in-memory fallback', {\n                            code\n                        });\n                        return inMemoryResult;\n                    }\n                }\n                await this.incrementStat('misses');\n                return null;\n            }\n            await this.incrementStat('hits');\n            const result = JSON.parse(cached);\n            // Update in-memory cache with Redis data\n            if (USE_IN_MEMORY_FALLBACK && result) {\n                await _inMemoryCache__WEBPACK_IMPORTED_MODULE_2__.inMemoryAirportCache.set(key, result.data, DEFAULT_TTL);\n            }\n            return result;\n        } catch (error) {\n            logger.error('Cache get error, falling back to in-memory', error);\n            await this.incrementStat('errors');\n            // Fallback to in-memory cache on error\n            if (USE_IN_MEMORY_FALLBACK) {\n                const result = await _inMemoryCache__WEBPACK_IMPORTED_MODULE_2__.inMemoryAirportCache.get(key);\n                if (result) {\n                    logger.info('Successfully retrieved from in-memory cache after Redis error', {\n                        code\n                    });\n                    return result;\n                }\n            }\n            return null;\n        }\n    }\n    async set(code, airport, ttl = DEFAULT_TTL) {\n        const key = this.getCacheKey(code);\n        const now = Date.now();\n        const cacheItem = {\n            data: airport,\n            source: 'cache',\n            fetchedAt: now,\n            expiresAt: now + ttl * 1000\n        };\n        // Always update in-memory cache if enabled\n        if (USE_IN_MEMORY_FALLBACK) {\n            await _inMemoryCache__WEBPACK_IMPORTED_MODULE_2__.inMemoryAirportCache.set(key, airport, ttl);\n        }\n        // Skip Redis if in fallback mode\n        if (this.fallbackMode || !this.redis) {\n            logger.debug('Skipping Redis set due to fallback mode', {\n                code\n            });\n            return;\n        }\n        const circuitBreaker = (0,_redisClient__WEBPACK_IMPORTED_MODULE_0__.getRedisCircuitBreaker)();\n        if (circuitBreaker && circuitBreaker.getState() === _circuitBreaker__WEBPACK_IMPORTED_MODULE_3__.CircuitState.OPEN) {\n            logger.debug('Skipping Redis set due to open circuit', {\n                code\n            });\n            return;\n        }\n        try {\n            // Try to set in Redis with exponential backoff\n            await this.exponentialBackoff.execute(async ()=>{\n                if (!this.redis) throw new Error('Redis client not available');\n                await this.redis.setex(key, ttl, JSON.stringify(cacheItem));\n            });\n            logger.debug('Successfully cached airport in Redis', {\n                code,\n                ttl\n            });\n        } catch (error) {\n            logger.error('Cache set error, data saved to in-memory cache only', error);\n            await this.incrementStat('errors');\n        }\n    }\n    async delete(code) {\n        if (this.fallbackMode || !this.redis) {\n            return false;\n        }\n        try {\n            const key = this.getCacheKey(code);\n            const result = await this.redis.del(key);\n            return result === 1;\n        } catch (error) {\n            console.error('Cache delete error:', error);\n            return false;\n        }\n    }\n    async exists(code) {\n        if (this.fallbackMode || !this.redis) {\n            return false;\n        }\n        try {\n            const key = this.getCacheKey(code);\n            const result = await this.redis.exists(key);\n            return result === 1;\n        } catch (error) {\n            console.error('Cache exists error:', error);\n            return false;\n        }\n    }\n    async clear(pattern) {\n        if (this.fallbackMode || !this.redis) {\n            return 0;\n        }\n        try {\n            const searchPattern = pattern ? `${CACHE_PREFIX}${pattern}*` : `${CACHE_PREFIX}*`;\n            const keys = await this.redis.keys(searchPattern);\n            if (keys.length === 0) {\n                return 0;\n            }\n            const result = await this.redis.del(...keys);\n            return result;\n        } catch (error) {\n            console.error('Cache clear error:', error);\n            return 0;\n        }\n    }\n    async getStats() {\n        // Get in-memory stats first\n        let inMemoryStats = null;\n        if (USE_IN_MEMORY_FALLBACK) {\n            inMemoryStats = await _inMemoryCache__WEBPACK_IMPORTED_MODULE_2__.inMemoryAirportCache.getStats();\n        }\n        if (this.fallbackMode || !this.redis) {\n            return inMemoryStats || {\n                hits: 0,\n                misses: 0,\n                errors: 0,\n                lastReset: Date.now()\n            };\n        }\n        try {\n            const stats = await this.redis.hgetall(STATS_KEY);\n            const redisStats = {\n                hits: parseInt(stats.hits || '0', 10),\n                misses: parseInt(stats.misses || '0', 10),\n                errors: parseInt(stats.errors || '0', 10),\n                lastReset: parseInt(stats.lastReset || Date.now().toString(), 10)\n            };\n            // If we have both, return Redis stats as primary\n            // In-memory stats are just for fallback tracking\n            return redisStats;\n        } catch (error) {\n            logger.error('Get stats error, returning in-memory stats', error);\n            return inMemoryStats || {\n                hits: 0,\n                misses: 0,\n                errors: 0,\n                lastReset: Date.now()\n            };\n        }\n    }\n    async incrementStat(stat) {\n        // Always track stats in in-memory cache if available\n        if (USE_IN_MEMORY_FALLBACK) {\n            const stats = await _inMemoryCache__WEBPACK_IMPORTED_MODULE_2__.inMemoryAirportCache.getStats();\n            if (stat === 'hits') stats.hits++;\n            else if (stat === 'misses') stats.misses++;\n            else if (stat === 'errors') stats.errors++;\n        }\n        if (this.fallbackMode || !this.redis) {\n            return;\n        }\n        const circuitBreaker = (0,_redisClient__WEBPACK_IMPORTED_MODULE_0__.getRedisCircuitBreaker)();\n        if (circuitBreaker && circuitBreaker.getState() === _circuitBreaker__WEBPACK_IMPORTED_MODULE_3__.CircuitState.OPEN) {\n            return;\n        }\n        try {\n            await this.redis.hincrby(STATS_KEY, stat, 1);\n            await this.redis.hset(STATS_KEY, 'lastUpdated', Date.now());\n        } catch (error) {\n            logger.error('Increment stat error', error);\n        }\n    }\n    async resetStats() {\n        if (this.fallbackMode || !this.redis) {\n            return;\n        }\n        try {\n            await this.redis.del(STATS_KEY);\n            await this.redis.hset(STATS_KEY, 'lastReset', Date.now());\n        } catch (error) {\n            console.error('Reset stats error:', error);\n        }\n    }\n}\n// Export singleton instance\nconst airportCache = new AirportCacheService();\n\n__webpack_async_result__();\n} catch(e) { __webpack_async_result__(e); } });//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9zcmMvc2VydmVyL3NlcnZpY2VzL2FpcnBvcnRDYWNoZS50cyIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7QUFBQSx5Q0FBeUM7QUFHNkI7QUFDYjtBQUNIO0FBQ2E7QUFDNkI7QUFJaEcsTUFBTVMsY0FBY0MsU0FBU0MsUUFBUUMsR0FBRyxDQUFDQyxpQkFBaUIsSUFBSSxXQUFXLElBQUksVUFBVTs7QUFDdkYsTUFBTUMsZUFBZTtBQUNyQixNQUFNQyxZQUFZO0FBQ2xCLE1BQU1DLHlCQUF5QkwsUUFBUUMsR0FBRyxDQUFDSyw0QkFBNEIsS0FBSztBQUU1RSxNQUFNQyxTQUFTLElBQUlaLHNFQUFnQkEsQ0FDakMsaUJBQ0EsQ0FBQyxHQUNESyxNQUFxQyxHQUFHSixDQUFhQSxHQUFHQyxxRUFBZUE7QUFHekUsTUFBTVc7SUFLSkMsYUFBYzthQUpOQyxRQUFzQjthQUN0QkMsZUFBZTtRQUlyQixJQUFJLENBQUNDLGtCQUFrQixHQUFHLElBQUluQiwrREFBa0JBLENBQzlDTSxTQUFTQyxRQUFRQyxHQUFHLENBQUNZLHdCQUF3QixJQUFJLFFBQVEsS0FDekRkLFNBQVNDLFFBQVFDLEdBQUcsQ0FBQ2EsdUJBQXVCLElBQUksU0FBUyxLQUN6RGYsU0FBU0MsUUFBUUMsR0FBRyxDQUFDYywwQkFBMEIsSUFBSSxLQUFLO0lBRTVEO0lBRUEsTUFBTUMsYUFBNEI7UUFDaEMsSUFBSSxDQUFDTixLQUFLLEdBQUcsTUFBTXJCLDREQUFjQTtRQUNqQyxJQUFJLENBQUMsSUFBSSxDQUFDcUIsS0FBSyxFQUFFO1lBQ2ZILE9BQU9VLElBQUksQ0FBQztZQUNaLElBQUksQ0FBQ04sWUFBWSxHQUFHO1FBQ3RCO1FBRUEsb0RBQW9EO1FBQ3BELElBQUlOLHdCQUF3QjtZQUMxQixNQUFNYixnRUFBb0JBLENBQUN3QixVQUFVO1FBQ3ZDO1FBRUEsTUFBTXpCLG1FQUFrQkEsQ0FBQ3lCLFVBQVU7SUFDckM7SUFFUUUsWUFBWUMsSUFBWSxFQUFVO1FBQ3hDLE9BQU8sR0FBR2hC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OUIseURBQVlBLENBQUMrQixJQUFJLEVBQUU7WUFDckU7UUFDRjtRQUVBLElBQUk7WUFDRixNQUFNLElBQUksQ0FBQ2YsS0FBSyxDQUFDMkQsT0FBTyxDQUFDakUsV0FBV2dFLE1BQU07WUFDMUMsTUFBTSxJQUFJLENBQUMxRCxLQUFLLENBQUM0RCxJQUFJLENBQUNsRSxXQUFXLGVBQWVzQyxLQUFLRCxHQUFHO1FBQzFELEVBQUUsT0FBT0osT0FBTztZQUNkOUIsT0FBTzhCLEtBQUssQ0FBQyx3QkFBd0JBO1FBQ3ZDO0lBQ0Y7SUFFQSxNQUFNa0MsYUFBNEI7UUFDaEMsSUFBSSxJQUFJLENBQUM1RCxZQUFZLElBQUksQ0FBQyxJQUFJLENBQUNELEtBQUssRUFBRTtZQUNwQztRQUNGO1FBRUEsSUFBSTtZQUNGLE1BQU0sSUFBSSxDQUFDQSxLQUFLLENBQUN3QyxHQUFHLENBQUM5QztZQUNyQixNQUFNLElBQUksQ0FBQ00sS0FBSyxDQUFDNEQsSUFBSSxDQUFDbEUsV0FBVyxhQUFhc0MsS0FBS0QsR0FBRztRQUN4RCxFQUFFLE9BQU9KLE9BQU87WUFDZGMsUUFBUWQsS0FBSyxDQUFDLHNCQUFzQkE7UUFDdEM7SUFDRjtBQUNGO0FBRUEsNEJBQTRCO0FBQ3JCLE1BQU1tQyxlQUFlLElBQUloRSxzQkFBcUIiLCJzb3VyY2VzIjpbIi9Vc2Vycy9ydWJlZW4vZGV2L3BlcnNvbmFsL2FpcnBvcnQtZGIvc3JjL3NlcnZlci9zZXJ2aWNlcy9haXJwb3J0Q2FjaGUudHMiXSwic291cmNlc0NvbnRlbnQiOlsiLy8gQWlycG9ydCBjYWNoaW5nIHNlcnZpY2UgaW1wbGVtZW50YXRpb25cblxuaW1wb3J0IHR5cGUgeyBSZWRpcyB9IGZyb20gJ2lvcmVkaXMnXG5pbXBvcnQgeyBnZXRSZWRpc0NsaWVudCwgZ2V0UmVkaXNDaXJjdWl0QnJlYWtlciB9IGZyb20gJy4vcmVkaXNDbGllbnQnXG5pbXBvcnQgeyBjb25jdXJyZW5jeU1hbmFnZXIgfSBmcm9tICcuL2NvbmN1cnJlbmN5TWFuYWdlcidcbmltcG9ydCB7IGluTWVtb3J5QWlycG9ydENhY2hlIH0gZnJvbSAnLi9pbk1lbW9yeUNhY2hlJ1xuaW1wb3J0IHsgRXhwb25lbnRpYWxCYWNrb2ZmLCBDaXJjdWl0U3RhdGUgfSBmcm9tICcuL2NpcmN1aXRCcmVha2VyJ1xuaW1wb3J0IHsgU3RydWN0dXJlZExvZ2dlciwganNvblRyYW5zcG9ydCwgcHJldHR5VHJhbnNwb3J0IH0gZnJvbSAnLi4vLi4vbGliL2NhY2hlL29ic2VydmFiaWxpdHknXG5pbXBvcnQgdHlwZSB7IEFpcnBvcnQgfSBmcm9tICcuLi8uLi90eXBlcy9haXJwb3J0J1xuaW1wb3J0IHR5cGUgeyBDYWNoZUl0ZW0sIENhY2hlU3RhdHMsIENhY2hlU2VydmljZSB9IGZyb20gJy4uLy4uL3R5cGVzL2NhY2hlJ1xuXG5jb25zdCBERUZBVUxUX1RUTCA9IHBhcnNlSW50KHByb2Nlc3MuZW52LkFJUlBPUlRfQ0FDSEVfVFRMIHx8ICcyNTkyMDAwJywgMTApIC8vIDMwIGRheXNcbmNvbnN0IENBQ0hFX1BSRUZJWCA9ICdhaXJwb3J0OidcbmNvbnN0IFNUQVRTX0tFWSA9ICdhaXJwb3J0OnN0YXRzJ1xuY29uc3QgVVNFX0lOX01FTU9SWV9GQUxMQkFDSyA9IHByb2Nlc3MuZW52LlVTRV9JTl9NRU1PUllfQ0FDSEVfRkFMTEJBQ0sgIT09ICdmYWxzZSdcblxuY29uc3QgbG9nZ2VyID0gbmV3IFN0cnVjdHVyZWRMb2dnZXIoXG4gICdhaXJwb3J0LWNhY2hlJyxcbiAge30sXG4gIHByb2Nlc3MuZW52Lk5PREVfRU5WID09PSAncHJvZHVjdGlvbicgPyBqc29uVHJhbnNwb3J0IDogcHJldHR5VHJhbnNwb3J0XG4pXG5cbmNsYXNzIEFpcnBvcnRDYWNoZVNlcnZpY2UgaW1wbGVtZW50cyBDYWNoZVNlcnZpY2U8QWlycG9ydD4ge1xuICBwcml2YXRlIHJlZGlzOiBSZWRpcyB8IG51bGwgPSBudWxsXG4gIHByaXZhdGUgZmFsbGJhY2tNb2RlID0gZmFsc2VcbiAgcHJpdmF0ZSBleHBvbmVudGlhbEJhY2tvZmY6IEV4cG9uZW50aWFsQmFja29mZlxuXG4gIGNvbnN0cnVjdG9yKCkge1xuICAgIHRoaXMuZXhwb25lbnRpYWxCYWNrb2ZmID0gbmV3IEV4cG9uZW50aWFsQmFja29mZihcbiAgICAgIHBhcnNlSW50KHByb2Nlc3MuZW52LlJFRElTX0JBQ0tPRkZfQkFTRV9ERUxBWSB8fCAnMTAwMCcsIDEwKSxcbiAgICAgIHBhcnNlSW50KHByb2Nlc3MuZW52LlJFRElTX0JBQ0tPRkZfTUFYX0RFTEFZIHx8ICczMDAwMCcsIDEwKSxcbiAgICAgIHBhcnNlSW50KHByb2Nlc3MuZW52LlJFRElTX0JBQ0tPRkZfTUFYX0FUVEVNUFRTIHx8ICczJywgMTApXG4gICAgKVxuICB9XG5cbiAgYXN5bmMgaW5pdGlhbGl6ZSgpOiBQcm9taXNlPHZvaWQ+IHtcbiAgICB0aGlzLnJlZGlzID0gYXdhaXQgZ2V0UmVkaXNDbGllbnQoKVxuICAgIGlmICghdGhpcy5yZWRpcykge1xuICAgICAgbG9nZ2VyLndhcm4oJ1JlZGlzIG5vdCBhdmFpbGFibGUsIG9wZXJhdGluZyBpbiBmYWxsYmFjayBtb2RlJylcbiAgICAgIHRoaXMuZmFsbGJhY2tNb2RlID0gdHJ1ZVxuICAgIH1cbiAgICBcbiAgICAvLyBJbml0aWFsaXplIGluLW1lbW9yeSBjYWNoZSBpZiBmYWxsYmFjayBpcyBlbmFibGVkXG4gICAgaWYgKFVTRV9JTl9NRU1PUllfRkFMTEJBQ0spIHtcbiAgICAgIGF3YWl0IGluTWVtb3J5QWlycG9ydENhY2hlLmluaXRpYWxpemUoKVxuICAgIH1cbiAgICBcbiAgICBhd2FpdCBjb25jdXJyZW5jeU1hbmFnZXIuaW5pdGlhbGl6ZSgpXG4gIH1cblxuICBwcml2YXRlIGdldENhY2hlS2V5KGNvZGU6IHN0cmluZyk6IHN0cmluZyB7XG4gICAgcmV0dXJuIGAke0NBQ0hFX1BSRUZJWH0ke2NvZGUudG9VcHBlckNhc2UoKX1gXG4gIH1cblxuICBhc3luYyBnZXQoY29kZTogc3RyaW5nKTogUHJvbWlzZTxDYWNoZUl0ZW08QWlycG9ydD4gfCBudWxsPiB7XG4gICAgY29uc3Qga2V5ID0gdGhpcy5nZXRDYWNoZUtleShjb2RlKVxuICAgIGNvbnN0IGNpcmN1aXRCcmVha2VyID0gZ2V0UmVkaXNDaXJjdWl0QnJlYWtlcigpXG5cbiAgICAvLyBJZiBSZWRpcyBpcyBpbiBmYWxsYmFjayBtb2RlIG9yIGNpcmN1aXQgaXMgb3BlbiwgdHJ5IGluLW1lbW9yeSBjYWNoZVxuICAgIGlmICh0aGlzLmZhbGxiYWNrTW9kZSB8fCAhdGhpcy5yZWRpcyB8fCBcbiAgICAgICAgKGNpcmN1aXRCcmVha2VyICYmIGNpcmN1aXRCcmVha2VyLmdldFN0YXRlKCkgPT09IENpcmN1aXRTdGF0ZS5PUEVOKSkge1xuICAgICAgXG4gICAgICBpZiAoVVNFX0lOX01FTU9SWV9GQUxMQkFDSykge1xuICAgICAgICBsb2dnZXIuZGVidWcoJ1VzaW5nIGluLW1lbW9yeSBjYWNoZSBmYWxsYmFjaycsIHsgY29kZSB9KVxuICAgICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBpbk1lbW9yeUFpcnBvcnRDYWNoZS5nZXQoa2V5KVxuICAgICAgICBpZiAocmVzdWx0KSB7XG4gICAgICAgICAgYXdhaXQgdGhpcy5pbmNyZW1lbnRTdGF0KCdoaXRzJylcbiAgICAgICAgICByZXR1cm4gcmVzdWx0XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIFxuICAgICAgYXdhaXQgdGhpcy5pbmNyZW1lbnRTdGF0KCdtaXNzZXMnKVxuICAgICAgcmV0dXJuIG51bGxcbiAgICB9XG5cbiAgICB0cnkge1xuICAgICAgLy8gVHJ5IFJlZGlzIHdpdGggZXhwb25lbnRpYWwgYmFja29mZlxuICAgICAgY29uc3QgY2FjaGVkID0gYXdhaXQgdGhpcy5leHBvbmVudGlhbEJhY2tvZmYuZXhlY3V0ZShhc3luYyAoKSA9PiB7XG4gICAgICAgIGlmICghdGhpcy5yZWRpcykgdGhyb3cgbmV3IEVycm9yKCdSZWRpcyBjbGllbnQgbm90IGF2YWlsYWJsZScpXG4gICAgICAgIHJldHVybiBhd2FpdCB0aGlzLnJlZGlzLmdldChrZXkpXG4gICAgICB9KVxuXG4gICAgICBpZiAoIWNhY2hlZCkge1xuICAgICAgICAvLyBDaGVjayBpbi1tZW1vcnkgY2FjaGUgYXMgc2Vjb25kIGxldmVsXG4gICAgICAgIGlmIChVU0VfSU5fTUVNT1JZX0ZBTExCQUNLKSB7XG4gICAgICAgICAgY29uc3QgaW5NZW1vcnlSZXN1bHQgPSBhd2FpdCBpbk1lbW9yeUFpcnBvcnRDYWNoZS5nZXQoa2V5KVxuICAgICAgICAgIGlmIChpbk1lbW9yeVJlc3VsdCkge1xuICAgICAgICAgICAgYXdhaXQgdGhpcy5pbmNyZW1lbnRTdGF0KCdoaXRzJylcbiAgICAgICAgICAgIGxvZ2dlci5kZWJ1ZygnQ2FjaGUgaGl0IGZyb20gaW4tbWVtb3J5IGZhbGxiYWNrJywgeyBjb2RlIH0pXG4gICAgICAgICAgICByZXR1cm4gaW5NZW1vcnlSZXN1bHRcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgXG4gICAgICAgIGF3YWl0IHRoaXMuaW5jcmVtZW50U3RhdCgnbWlzc2VzJylcbiAgICAgICAgcmV0dXJuIG51bGxcbiAgICAgIH1cblxuICAgICAgYXdhaXQgdGhpcy5pbmNyZW1lbnRTdGF0KCdoaXRzJylcbiAgICAgIGNvbnN0IHJlc3VsdCA9IEpTT04ucGFyc2UoY2FjaGVkKSBhcyBDYWNoZUl0ZW08QWlycG9ydD5cbiAgICAgIFxuICAgICAgLy8gVXBkYXRlIGluLW1lbW9yeSBjYWNoZSB3aXRoIFJlZGlzIGRhdGFcbiAgICAgIGlmIChVU0VfSU5fTUVNT1JZX0ZBTExCQUNLICYmIHJlc3VsdCkge1xuICAgICAgICBhd2FpdCBpbk1lbW9yeUFpcnBvcnRDYWNoZS5zZXQoa2V5LCByZXN1bHQuZGF0YSwgREVGQVVMVF9UVEwpXG4gICAgICB9XG4gICAgICBcbiAgICAgIHJldHVybiByZXN1bHRcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgbG9nZ2VyLmVycm9yKCdDYWNoZSBnZXQgZXJyb3IsIGZhbGxpbmcgYmFjayB0byBpbi1tZW1vcnknLCBlcnJvciBhcyBFcnJvcilcbiAgICAgIGF3YWl0IHRoaXMuaW5jcmVtZW50U3RhdCgnZXJyb3JzJylcbiAgICAgIFxuICAgICAgLy8gRmFsbGJhY2sgdG8gaW4tbWVtb3J5IGNhY2hlIG9uIGVycm9yXG4gICAgICBpZiAoVVNFX0lOX01FTU9SWV9GQUxMQkFDSykge1xuICAgICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBpbk1lbW9yeUFpcnBvcnRDYWNoZS5nZXQoa2V5KVxuICAgICAgICBpZiAocmVzdWx0KSB7XG4gICAgICAgICAgbG9nZ2VyLmluZm8oJ1N1Y2Nlc3NmdWxseSByZXRyaWV2ZWQgZnJvbSBpbi1tZW1vcnkgY2FjaGUgYWZ0ZXIgUmVkaXMgZXJyb3InLCB7IGNvZGUgfSlcbiAgICAgICAgICByZXR1cm4gcmVzdWx0XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIFxuICAgICAgcmV0dXJuIG51bGxcbiAgICB9XG4gIH1cblxuICBhc3luYyBzZXQoY29kZTogc3RyaW5nLCBhaXJwb3J0OiBBaXJwb3J0LCB0dGw6IG51bWJlciA9IERFRkFVTFRfVFRMKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgY29uc3Qga2V5ID0gdGhpcy5nZXRDYWNoZUtleShjb2RlKVxuICAgIGNvbnN0IG5vdyA9IERhdGUubm93KClcbiAgICBjb25zdCBjYWNoZUl0ZW06IENhY2hlSXRlbTxBaXJwb3J0PiA9IHtcbiAgICAgIGRhdGE6IGFpcnBvcnQsXG4gICAgICBzb3VyY2U6ICdjYWNoZScsXG4gICAgICBmZXRjaGVkQXQ6IG5vdyxcbiAgICAgIGV4cGlyZXNBdDogbm93ICsgKHR0bCAqIDEwMDApLFxuICAgIH1cblxuICAgIC8vIEFsd2F5cyB1cGRhdGUgaW4tbWVtb3J5IGNhY2hlIGlmIGVuYWJsZWRcbiAgICBpZiAoVVNFX0lOX01FTU9SWV9GQUxMQkFDSykge1xuICAgICAgYXdhaXQgaW5NZW1vcnlBaXJwb3J0Q2FjaGUuc2V0KGtleSwgYWlycG9ydCwgdHRsKVxuICAgIH1cblxuICAgIC8vIFNraXAgUmVkaXMgaWYgaW4gZmFsbGJhY2sgbW9kZVxuICAgIGlmICh0aGlzLmZhbGxiYWNrTW9kZSB8fCAhdGhpcy5yZWRpcykge1xuICAgICAgbG9nZ2VyLmRlYnVnKCdTa2lwcGluZyBSZWRpcyBzZXQgZHVlIHRvIGZhbGxiYWNrIG1vZGUnLCB7IGNvZGUgfSlcbiAgICAgIHJldHVyblxuICAgIH1cblxuICAgIGNvbnN0IGNpcmN1aXRCcmVha2VyID0gZ2V0UmVkaXNDaXJjdWl0QnJlYWtlcigpXG4gICAgaWYgKGNpcmN1aXRCcmVha2VyICYmIGNpcmN1aXRCcmVha2VyLmdldFN0YXRlKCkgPT09IENpcmN1aXRTdGF0ZS5PUEVOKSB7XG4gICAgICBsb2dnZXIuZGVidWcoJ1NraXBwaW5nIFJlZGlzIHNldCBkdWUgdG8gb3BlbiBjaXJjdWl0JywgeyBjb2RlIH0pXG4gICAgICByZXR1cm5cbiAgICB9XG5cbiAgICB0cnkge1xuICAgICAgLy8gVHJ5IHRvIHNldCBpbiBSZWRpcyB3aXRoIGV4cG9uZW50aWFsIGJhY2tvZmZcbiAgICAgIGF3YWl0IHRoaXMuZXhwb25lbnRpYWxCYWNrb2ZmLmV4ZWN1dGUoYXN5bmMgKCkgPT4ge1xuICAgICAgICBpZiAoIXRoaXMucmVkaXMpIHRocm93IG5ldyBFcnJvcignUmVkaXMgY2xpZW50IG5vdCBhdmFpbGFibGUnKVxuICAgICAgICBhd2FpdCB0aGlzLnJlZGlzLnNldGV4KGtleSwgdHRsLCBKU09OLnN0cmluZ2lmeShjYWNoZUl0ZW0pKVxuICAgICAgfSlcbiAgICAgIFxuICAgICAgbG9nZ2VyLmRlYnVnKCdTdWNjZXNzZnVsbHkgY2FjaGVkIGFpcnBvcnQgaW4gUmVkaXMnLCB7IGNvZGUsIHR0bCB9KVxuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBsb2dnZXIuZXJyb3IoJ0NhY2hlIHNldCBlcnJvciwgZGF0YSBzYXZlZCB0byBpbi1tZW1vcnkgY2FjaGUgb25seScsIGVycm9yIGFzIEVycm9yKVxuICAgICAgYXdhaXQgdGhpcy5pbmNyZW1lbnRTdGF0KCdlcnJvcnMnKVxuICAgIH1cbiAgfVxuXG4gIGFzeW5jIGRlbGV0ZShjb2RlOiBzdHJpbmcpOiBQcm9taXNlPGJvb2xlYW4+IHtcbiAgICBpZiAodGhpcy5mYWxsYmFja01vZGUgfHwgIXRoaXMucmVkaXMpIHtcbiAgICAgIHJldHVybiBmYWxzZVxuICAgIH1cblxuICAgIHRyeSB7XG4gICAgICBjb25zdCBrZXkgPSB0aGlzLmdldENhY2hlS2V5KGNvZGUpXG4gICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCB0aGlzLnJlZGlzLmRlbChrZXkpXG4gICAgICByZXR1cm4gcmVzdWx0ID09PSAxXG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ0NhY2hlIGRlbGV0ZSBlcnJvcjonLCBlcnJvcilcbiAgICAgIHJldHVybiBmYWxzZVxuICAgIH1cbiAgfVxuXG4gIGFzeW5jIGV4aXN0cyhjb2RlOiBzdHJpbmcpOiBQcm9taXNlPGJvb2xlYW4+IHtcbiAgICBpZiAodGhpcy5mYWxsYmFja01vZGUgfHwgIXRoaXMucmVkaXMpIHtcbiAgICAgIHJldHVybiBmYWxzZVxuICAgIH1cblxuICAgIHRyeSB7XG4gICAgICBjb25zdCBrZXkgPSB0aGlzLmdldENhY2hlS2V5KGNvZGUpXG4gICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCB0aGlzLnJlZGlzLmV4aXN0cyhrZXkpXG4gICAgICByZXR1cm4gcmVzdWx0ID09PSAxXG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ0NhY2hlIGV4aXN0cyBlcnJvcjonLCBlcnJvcilcbiAgICAgIHJldHVybiBmYWxzZVxuICAgIH1cbiAgfVxuXG4gIGFzeW5jIGNsZWFyKHBhdHRlcm4/OiBzdHJpbmcpOiBQcm9taXNlPG51bWJlcj4ge1xuICAgIGlmICh0aGlzLmZhbGxiYWNrTW9kZSB8fCAhdGhpcy5yZWRpcykge1xuICAgICAgcmV0dXJuIDBcbiAgICB9XG5cbiAgICB0cnkge1xuICAgICAgY29uc3Qgc2VhcmNoUGF0dGVybiA9IHBhdHRlcm4gXG4gICAgICAgID8gYCR7Q0FDSEVfUFJFRklYfSR7cGF0dGVybn0qYCBcbiAgICAgICAgOiBgJHtDQUNIRV9QUkVGSVh9KmBcbiAgICAgIFxuICAgICAgY29uc3Qga2V5cyA9IGF3YWl0IHRoaXMucmVkaXMua2V5cyhzZWFyY2hQYXR0ZXJuKVxuICAgICAgaWYgKGtleXMubGVuZ3RoID09PSAwKSB7XG4gICAgICAgIHJldHVybiAwXG4gICAgICB9XG5cbiAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IHRoaXMucmVkaXMuZGVsKC4uLmtleXMpXG4gICAgICByZXR1cm4gcmVzdWx0XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ0NhY2hlIGNsZWFyIGVycm9yOicsIGVycm9yKVxuICAgICAgcmV0dXJuIDBcbiAgICB9XG4gIH1cblxuICBhc3luYyBnZXRTdGF0cygpOiBQcm9taXNlPENhY2hlU3RhdHM+IHtcbiAgICAvLyBHZXQgaW4tbWVtb3J5IHN0YXRzIGZpcnN0XG4gICAgbGV0IGluTWVtb3J5U3RhdHM6IENhY2hlU3RhdHMgfCBudWxsID0gbnVsbFxuICAgIGlmIChVU0VfSU5fTUVNT1JZX0ZBTExCQUNLKSB7XG4gICAgICBpbk1lbW9yeVN0YXRzID0gYXdhaXQgaW5NZW1vcnlBaXJwb3J0Q2FjaGUuZ2V0U3RhdHMoKVxuICAgIH1cblxuICAgIGlmICh0aGlzLmZhbGxiYWNrTW9kZSB8fCAhdGhpcy5yZWRpcykge1xuICAgICAgcmV0dXJuIGluTWVtb3J5U3RhdHMgfHwgeyBoaXRzOiAwLCBtaXNzZXM6IDAsIGVycm9yczogMCwgbGFzdFJlc2V0OiBEYXRlLm5vdygpIH1cbiAgICB9XG5cbiAgICB0cnkge1xuICAgICAgY29uc3Qgc3RhdHMgPSBhd2FpdCB0aGlzLnJlZGlzLmhnZXRhbGwoU1RBVFNfS0VZKVxuICAgICAgY29uc3QgcmVkaXNTdGF0cyA9IHtcbiAgICAgICAgaGl0czogcGFyc2VJbnQoc3RhdHMuaGl0cyB8fCAnMCcsIDEwKSxcbiAgICAgICAgbWlzc2VzOiBwYXJzZUludChzdGF0cy5taXNzZXMgfHwgJzAnLCAxMCksXG4gICAgICAgIGVycm9yczogcGFyc2VJbnQoc3RhdHMuZXJyb3JzIHx8ICcwJywgMTApLFxuICAgICAgICBsYXN0UmVzZXQ6IHBhcnNlSW50KHN0YXRzLmxhc3RSZXNldCB8fCBEYXRlLm5vdygpLnRvU3RyaW5nKCksIDEwKSxcbiAgICAgIH1cblxuICAgICAgLy8gSWYgd2UgaGF2ZSBib3RoLCByZXR1cm4gUmVkaXMgc3RhdHMgYXMgcHJpbWFyeVxuICAgICAgLy8gSW4tbWVtb3J5IHN0YXRzIGFyZSBqdXN0IGZvciBmYWxsYmFjayB0cmFja2luZ1xuICAgICAgcmV0dXJuIHJlZGlzU3RhdHNcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgbG9nZ2VyLmVycm9yKCdHZXQgc3RhdHMgZXJyb3IsIHJldHVybmluZyBpbi1tZW1vcnkgc3RhdHMnLCBlcnJvciBhcyBFcnJvcilcbiAgICAgIHJldHVybiBpbk1lbW9yeVN0YXRzIHx8IHsgaGl0czogMCwgbWlzc2VzOiAwLCBlcnJvcnM6IDAsIGxhc3RSZXNldDogRGF0ZS5ub3coKSB9XG4gICAgfVxuICB9XG5cbiAgcHJpdmF0ZSBhc3luYyBpbmNyZW1lbnRTdGF0KHN0YXQ6ICdoaXRzJyB8ICdtaXNzZXMnIHwgJ2Vycm9ycycpOiBQcm9taXNlPHZvaWQ+IHtcbiAgICAvLyBBbHdheXMgdHJhY2sgc3RhdHMgaW4gaW4tbWVtb3J5IGNhY2hlIGlmIGF2YWlsYWJsZVxuICAgIGlmIChVU0VfSU5fTUVNT1JZX0ZBTExCQUNLKSB7XG4gICAgICBjb25zdCBzdGF0cyA9IGF3YWl0IGluTWVtb3J5QWlycG9ydENhY2hlLmdldFN0YXRzKClcbiAgICAgIGlmIChzdGF0ID09PSAnaGl0cycpIHN0YXRzLmhpdHMrK1xuICAgICAgZWxzZSBpZiAoc3RhdCA9PT0gJ21pc3NlcycpIHN0YXRzLm1pc3NlcysrXG4gICAgICBlbHNlIGlmIChzdGF0ID09PSAnZXJyb3JzJykgc3RhdHMuZXJyb3JzKytcbiAgICB9XG5cbiAgICBpZiAodGhpcy5mYWxsYmFja01vZGUgfHwgIXRoaXMucmVkaXMpIHtcbiAgICAgIHJldHVyblxuICAgIH1cblxuICAgIGNvbnN0IGNpcmN1aXRCcmVha2VyID0gZ2V0UmVkaXNDaXJjdWl0QnJlYWtlcigpXG4gICAgaWYgKGNpcmN1aXRCcmVha2VyICYmIGNpcmN1aXRCcmVha2VyLmdldFN0YXRlKCkgPT09IENpcmN1aXRTdGF0ZS5PUEVOKSB7XG4gICAgICByZXR1cm5cbiAgICB9XG5cbiAgICB0cnkge1xuICAgICAgYXdhaXQgdGhpcy5yZWRpcy5oaW5jcmJ5KFNUQVRTX0tFWSwgc3RhdCwgMSlcbiAgICAgIGF3YWl0IHRoaXMucmVkaXMuaHNldChTVEFUU19LRVksICdsYXN0VXBkYXRlZCcsIERhdGUubm93KCkpXG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGxvZ2dlci5lcnJvcignSW5jcmVtZW50IHN0YXQgZXJyb3InLCBlcnJvciBhcyBFcnJvcilcbiAgICB9XG4gIH1cblxuICBhc3luYyByZXNldFN0YXRzKCk6IFByb21pc2U8dm9pZD4ge1xuICAgIGlmICh0aGlzLmZhbGxiYWNrTW9kZSB8fCAhdGhpcy5yZWRpcykge1xuICAgICAgcmV0dXJuXG4gICAgfVxuXG4gICAgdHJ5IHtcbiAgICAgIGF3YWl0IHRoaXMucmVkaXMuZGVsKFNUQVRTX0tFWSlcbiAgICAgIGF3YWl0IHRoaXMucmVkaXMuaHNldChTVEFUU19LRVksICdsYXN0UmVzZXQnLCBEYXRlLm5vdygpKVxuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBjb25zb2xlLmVycm9yKCdSZXNldCBzdGF0cyBlcnJvcjonLCBlcnJvcilcbiAgICB9XG4gIH1cbn1cblxuLy8gRXhwb3J0IHNpbmdsZXRvbiBpbnN0YW5jZVxuZXhwb3J0IGNvbnN0IGFpcnBvcnRDYWNoZSA9IG5ldyBBaXJwb3J0Q2FjaGVTZXJ2aWNlKCkiXSwibmFtZXMiOlsiZ2V0UmVkaXNDbGllbnQiLCJnZXRSZWRpc0NpcmN1aXRCcmVha2VyIiwiY29uY3VycmVuY3lNYW5hZ2VyIiwiaW5NZW1vcnlBaXJwb3J0Q2FjaGUiLCJFeHBvbmVudGlhbEJhY2tvZmYiLCJDaXJjdWl0U3RhdGUiLCJTdHJ1Y3R1cmVkTG9nZ2VyIiwianNvblRyYW5zcG9ydCIsInByZXR0eVRyYW5zcG9ydCIsIkRFRkFVTFRfVFRMIiwicGFyc2VJbnQiLCJwcm9jZXNzIiwiZW52IiwiQUlSUE9SVF9DQUNIRV9UVEwiLCJDQUNIRV9QUkVGSVgiLCJTVEFUU19LRVkiLCJVU0VfSU5fTUVNT1JZX0ZBTExCQUNLIiwiVVNFX0lOX01FTU9SWV9DQUNIRV9GQUxMQkFDSyIsImxvZ2dlciIsIkFpcnBvcnRDYWNoZVNlcnZpY2UiLCJjb25zdHJ1Y3RvciIsInJlZGlzIiwiZmFsbGJhY2tNb2RlIiwiZXhwb25lbnRpYWxCYWNrb2ZmIiwiUkVESVNfQkFDS09GRl9CQVNFX0RFTEFZIiwiUkVESVNfQkFDS09GRl9NQVhfREVMQVkiLCJSRURJU19CQUNLT0ZGX01BWF9BVFRFTVBUUyIsImluaXRpYWxpemUiLCJ3YXJuIiwiZ2V0Q2FjaGVLZXkiLCJjb2RlIiwidG9VcHBlckNhc2UiLCJnZXQiLCJrZXkiLCJjaXJjdWl0QnJlYWtlciIsImdldFN0YXRlIiwiT1BFTiIsImRlYnVnIiwicmVzdWx0IiwiaW5jcmVtZW50U3RhdCIsImNhY2hlZCIsImV4ZWN1dGUiLCJFcnJvciIsImluTWVtb3J5UmVzdWx0IiwiSlNPTiIsInBhcnNlIiwic2V0IiwiZGF0YSIsImVycm9yIiwiaW5mbyIsImFpcnBvcnQiLCJ0dGwiLCJub3ciLCJEYXRlIiwiY2FjaGVJdGVtIiwic291cmNlIiwiZmV0Y2hlZEF0IiwiZXhwaXJlc0F0Iiwic2V0ZXgiLCJzdHJpbmdpZnkiLCJkZWxldGUiLCJkZWwiLCJjb25zb2xlIiwiZXhpc3RzIiwiY2xlYXIiLCJwYXR0ZXJuIiwic2VhcmNoUGF0dGVybiIsImtleXMiLCJsZW5ndGgiLCJnZXRTdGF0cyIsImluTWVtb3J5U3RhdHMiLCJoaXRzIiwibWlzc2VzIiwiZXJyb3JzIiwibGFzdFJlc2V0Iiwic3RhdHMiLCJoZ2V0YWxsIiwicmVkaXNTdGF0cyIsInRvU3RyaW5nIiwic3RhdCIsImhpbmNyYnkiLCJoc2V0IiwicmVzZXRTdGF0cyIsImFpcnBvcnRDYWNoZSJdLCJpZ25vcmVMaXN0IjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./src/server/services/airportCache.ts\n");

/***/ }),

/***/ "(rsc)/./src/server/services/circuitBreaker.ts":
/*!***********************************************!*\
  !*** ./src/server/services/circuitBreaker.ts ***!
  \***********************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   CircuitBreaker: () => (/* binding */ CircuitBreaker),\n/* harmony export */   CircuitState: () => (/* binding */ CircuitState),\n/* harmony export */   ExponentialBackoff: () => (/* binding */ ExponentialBackoff)\n/* harmony export */ });\n/* harmony import */ var _lib_cache_observability__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../lib/cache/observability */ \"(rsc)/./src/lib/cache/observability/index.ts\");\n// Circuit breaker pattern implementation for resilient service calls\n\nconst logger = new _lib_cache_observability__WEBPACK_IMPORTED_MODULE_0__.StructuredLogger('circuit-breaker', {},  false ? 0 : _lib_cache_observability__WEBPACK_IMPORTED_MODULE_0__.prettyTransport);\nvar CircuitState = /*#__PURE__*/ function(CircuitState) {\n    CircuitState[\"CLOSED\"] = \"CLOSED\";\n    CircuitState[\"OPEN\"] = \"OPEN\";\n    CircuitState[\"HALF_OPEN\"] = \"HALF_OPEN\";\n    return CircuitState;\n}({});\nclass CircuitBreaker {\n    constructor(options){\n        this.state = \"CLOSED\";\n        this.failureCount = 0;\n        this.successCount = 0;\n        this.halfOpenRequestCount = 0;\n        this.name = options.name;\n        this.failureThreshold = options.failureThreshold || 5;\n        this.resetTimeout = options.resetTimeout || 60000 // 1 minute\n        ;\n        this.monitoringPeriod = options.monitoringPeriod || 10000 // 10 seconds\n        ;\n        this.halfOpenRequests = options.halfOpenRequests || 3;\n        this.onStateChange = options.onStateChange;\n    }\n    async execute(fn) {\n        // Check if circuit should transition from OPEN to HALF_OPEN\n        if (this.state === \"OPEN\") {\n            if (this.shouldTransitionToHalfOpen()) {\n                this.transitionTo(\"HALF_OPEN\");\n            } else {\n                throw new Error(`Circuit breaker ${this.name} is OPEN`);\n            }\n        }\n        // In HALF_OPEN state, limit the number of requests\n        if (this.state === \"HALF_OPEN\") {\n            if (this.halfOpenRequestCount >= this.halfOpenRequests) {\n                throw new Error(`Circuit breaker ${this.name} is HALF_OPEN and at request limit`);\n            }\n            this.halfOpenRequestCount++;\n        }\n        try {\n            const result = await fn();\n            this.onSuccess();\n            return result;\n        } catch (error) {\n            this.onFailure();\n            throw error;\n        }\n    }\n    onSuccess() {\n        this.failureCount = 0;\n        this.successCount++;\n        if (this.state === \"HALF_OPEN\") {\n            // If all half-open requests succeed, close the circuit\n            if (this.successCount >= this.halfOpenRequests) {\n                this.transitionTo(\"CLOSED\");\n            }\n        }\n        logger.debug('Circuit breaker request succeeded', {\n            name: this.name,\n            state: this.state,\n            successCount: this.successCount\n        });\n    }\n    onFailure() {\n        this.failureCount++;\n        this.lastFailureTime = Date.now();\n        this.successCount = 0;\n        logger.warn('Circuit breaker request failed', {\n            name: this.name,\n            state: this.state,\n            failureCount: this.failureCount,\n            threshold: this.failureThreshold\n        });\n        if (this.state === \"HALF_OPEN\") {\n            // Any failure in HALF_OPEN state reopens the circuit\n            this.transitionTo(\"OPEN\");\n        } else if (this.state === \"CLOSED\" && this.failureCount >= this.failureThreshold) {\n            // Too many failures in CLOSED state opens the circuit\n            this.transitionTo(\"OPEN\");\n        }\n    }\n    shouldTransitionToHalfOpen() {\n        if (!this.lastFailureTime) return false;\n        return Date.now() - this.lastFailureTime >= this.resetTimeout;\n    }\n    transitionTo(newState) {\n        const oldState = this.state;\n        this.state = newState;\n        // Reset counters on state transition\n        if (newState === \"HALF_OPEN\") {\n            this.halfOpenRequestCount = 0;\n            this.successCount = 0;\n        } else if (newState === \"CLOSED\") {\n            this.failureCount = 0;\n            this.successCount = 0;\n            this.halfOpenRequestCount = 0;\n        }\n        logger.info('Circuit breaker state changed', {\n            name: this.name,\n            oldState,\n            newState\n        });\n        if (this.onStateChange) {\n            this.onStateChange(oldState, newState);\n        }\n    }\n    getState() {\n        return this.state;\n    }\n    getStats() {\n        return {\n            name: this.name,\n            state: this.state,\n            failureCount: this.failureCount,\n            successCount: this.successCount,\n            lastFailureTime: this.lastFailureTime,\n            halfOpenRequestCount: this.halfOpenRequestCount\n        };\n    }\n    reset() {\n        this.transitionTo(\"CLOSED\");\n        this.failureCount = 0;\n        this.successCount = 0;\n        this.lastFailureTime = undefined;\n        this.halfOpenRequestCount = 0;\n    }\n}\n// Exponential backoff helper\nclass ExponentialBackoff {\n    constructor(baseDelay = 1000, maxDelay = 30000, maxAttempts = 5){\n        this.attempt = 0;\n        this.baseDelay = baseDelay;\n        this.maxDelay = maxDelay;\n        this.maxAttempts = maxAttempts;\n    }\n    async execute(fn) {\n        let lastError = new Error('No attempts made');\n        for(let attempt = 0; attempt < this.maxAttempts; attempt++){\n            try {\n                const result = await fn();\n                this.reset();\n                return result;\n            } catch (error) {\n                lastError = error;\n                this.attempt = attempt + 1;\n                if (this.attempt >= this.maxAttempts) {\n                    logger.error('Max retry attempts reached', {\n                        attempts: this.attempt,\n                        maxAttempts: this.maxAttempts\n                    });\n                    throw error;\n                }\n                const delay = this.getDelay();\n                logger.warn('Retrying after backoff', {\n                    attempt: this.attempt,\n                    delay,\n                    error: error instanceof Error ? error.message : 'Unknown error'\n                });\n                await this.sleep(delay);\n            }\n        }\n        throw lastError;\n    }\n    getDelay() {\n        // Exponential backoff with jitter\n        const exponentialDelay = Math.min(this.baseDelay * Math.pow(2, this.attempt - 1), this.maxDelay);\n        // Add jitter (±25%)\n        const jitter = exponentialDelay * 0.25;\n        return Math.floor(exponentialDelay + (Math.random() * 2 - 1) * jitter);\n    }\n    sleep(ms) {\n        return new Promise((resolve)=>setTimeout(resolve, ms));\n    }\n    reset() {\n        this.attempt = 0;\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9zcmMvc2VydmVyL3NlcnZpY2VzL2NpcmN1aXRCcmVha2VyLnRzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7QUFBQSxxRUFBcUU7QUFFMkI7QUFFaEcsTUFBTUcsU0FBUyxJQUFJSCxzRUFBZ0JBLENBQ2pDLG1CQUNBLENBQUMsR0FDREksTUFBcUMsR0FBR0gsQ0FBYUEsR0FBR0MscUVBQWVBO0FBR2xFLDBDQUFLRzs7OztXQUFBQTtNQUlYO0FBV00sTUFBTUM7SUFlWEMsWUFBWUMsT0FBOEIsQ0FBRTthQWJwQ0M7YUFDQUMsZUFBZTthQUNmQyxlQUFlO2FBRWZDLHVCQUF1QjtRQVU3QixJQUFJLENBQUNDLElBQUksR0FBR0wsUUFBUUssSUFBSTtRQUN4QixJQUFJLENBQUNDLGdCQUFnQixHQUFHTixRQUFRTSxnQkFBZ0IsSUFBSTtRQUNwRCxJQUFJLENBQUNDLFlBQVksR0FBR1AsUUFBUU8sWUFBWSxJQUFJLE1BQU0sV0FBVzs7UUFDN0QsSUFBSSxDQUFDQyxnQkFBZ0IsR0FBR1IsUUFBUVEsZ0JBQWdCLElBQUksTUFBTSxhQUFhOztRQUN2RSxJQUFJLENBQUNDLGdCQUFnQixHQUFHVCxRQUFRUyxnQkFBZ0IsSUFBSTtRQUNwRCxJQUFJLENBQUNDLGFBQWEsR0FBR1YsUUFBUVUsYUFBYTtJQUM1QztJQUVBLE1BQU1DLFFBQVdDLEVBQW9CLEVBQWM7UUFDakQsNERBQTREO1FBQzVELElBQUksSUFBSSxDQUFDWCxLQUFLLGFBQXdCO1lBQ3BDLElBQUksSUFBSSxDQUFDWSwwQkFBMEIsSUFBSTtnQkFDckMsSUFBSSxDQUFDQyxZQUFZO1lBQ25CLE9BQU87Z0JBQ0wsTUFBTSxJQUFJQyxNQUFNLENBQUMsZ0JBQWdCLEVBQUUsSUFBSSxDQUFDVixJQUFJLENBQUMsUUFBUSxDQUFDO1lBQ3hEO1FBQ0Y7UUFFQSxtREFBbUQ7UUFDbkQsSUFBSSxJQUFJLENBQUNKLEtBQUssa0JBQTZCO1lBQ3pDLElBQUksSUFBSSxDQUFDRyxvQkFBb0IsSUFBSSxJQUFJLENBQUNL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Q3BDYSxTQUFTLElBQUksQ0FBQ0EsT0FBTztvQkFDckJHO29CQUNBdEIsT0FBT0EsaUJBQWlCSCxRQUFRRyxNQUFNd0IsT0FBTyxHQUFHO2dCQUNsRDtnQkFFQSxNQUFNLElBQUksQ0FBQ0MsS0FBSyxDQUFDSDtZQUNuQjtRQUNGO1FBRUEsTUFBTUY7SUFDUjtJQUVRRyxXQUFtQjtRQUN6QixrQ0FBa0M7UUFDbEMsTUFBTUcsbUJBQW1CQyxLQUFLQyxHQUFHLENBQy9CLElBQUksQ0FBQ1osU0FBUyxHQUFHVyxLQUFLRSxHQUFHLENBQUMsR0FBRyxJQUFJLENBQUNWLE9BQU8sR0FBRyxJQUM1QyxJQUFJLENBQUNGLFFBQVE7UUFHZixvQkFBb0I7UUFDcEIsTUFBTWEsU0FBU0osbUJBQW1CO1FBQ2xDLE9BQU9DLEtBQUtJLEtBQUssQ0FBQ0wsbUJBQW1CLENBQUNDLEtBQUtLLE1BQU0sS0FBSyxJQUFJLEtBQUtGO0lBQ2pFO0lBRVFMLE1BQU1RLEVBQVUsRUFBaUI7UUFDdkMsT0FBTyxJQUFJQyxRQUFRQyxDQUFBQSxVQUFXQyxXQUFXRCxTQUFTRjtJQUNwRDtJQUVBcEIsUUFBYztRQUNaLElBQUksQ0FBQ00sT0FBTyxHQUFHO0lBQ2pCO0FBQ0YiLCJzb3VyY2VzIjpbIi9Vc2Vycy9ydWJlZW4vZGV2L3BlcnNvbmFsL2FpcnBvcnQtZGIvc3JjL3NlcnZlci9zZXJ2aWNlcy9jaXJjdWl0QnJlYWtlci50cyJdLCJzb3VyY2VzQ29udGVudCI6WyIvLyBDaXJjdWl0IGJyZWFrZXIgcGF0dGVybiBpbXBsZW1lbnRhdGlvbiBmb3IgcmVzaWxpZW50IHNlcnZpY2UgY2FsbHNcblxuaW1wb3J0IHsgU3RydWN0dXJlZExvZ2dlciwganNvblRyYW5zcG9ydCwgcHJldHR5VHJhbnNwb3J0IH0gZnJvbSAnLi4vLi4vbGliL2NhY2hlL29ic2VydmFiaWxpdHknXG5cbmNvbnN0IGxvZ2dlciA9IG5ldyBTdHJ1Y3R1cmVkTG9nZ2VyKFxuICAnY2lyY3VpdC1icmVha2VyJyxcbiAge30sXG4gIHByb2Nlc3MuZW52Lk5PREVfRU5WID09PSAncHJvZHVjdGlvbicgPyBqc29uVHJhbnNwb3J0IDogcHJldHR5VHJhbnNwb3J0XG4pXG5cbmV4cG9ydCBlbnVtIENpcmN1aXRTdGF0ZSB7XG4gIENMT1NFRCA9ICdDTE9TRUQnLFxuICBPUEVOID0gJ09QRU4nLFxuICBIQUxGX09QRU4gPSAnSEFMRl9PUEVOJ1xufVxuXG5leHBvcnQgaW50ZXJmYWNlIENpcmN1aXRCcmVha2VyT3B0aW9ucyB7XG4gIG5hbWU6IHN0cmluZ1xuICBmYWlsdXJlVGhyZXNob2xkPzogbnVtYmVyXG4gIHJlc2V0VGltZW91dD86IG51bWJlclxuICBtb25pdG9yaW5nUGVyaW9kPzogbnVtYmVyXG4gIGhhbGZPcGVuUmVxdWVzdHM/OiBudW1iZXJcbiAgb25TdGF0ZUNoYW5nZT86IChvbGRTdGF0ZTogQ2lyY3VpdFN0YXRlLCBuZXdTdGF0ZTogQ2lyY3VpdFN0YXRlKSA9PiB2b2lkXG59XG5cbmV4cG9ydCBjbGFzcyBDaXJjdWl0QnJlYWtlciB7XG4gIHByaXZhdGUgbmFtZTogc3RyaW5nXG4gIHByaXZhdGUgc3RhdGU6IENpcmN1aXRTdGF0ZSA9IENpcmN1aXRTdGF0ZS5DTE9TRURcbiAgcHJpdmF0ZSBmYWlsdXJlQ291bnQgPSAwXG4gIHByaXZhdGUgc3VjY2Vzc0NvdW50ID0gMFxuICBwcml2YXRlIGxhc3RGYWlsdXJlVGltZT86IG51bWJlclxuICBwcml2YXRlIGhhbGZPcGVuUmVxdWVzdENvdW50ID0gMFxuICBcbiAgLy8gQ29uZmlndXJhdGlvblxuICBwcml2YXRlIGZhaWx1cmVUaHJlc2hvbGQ6IG51bWJlclxuICBwcml2YXRlIHJlc2V0VGltZW91dDogbnVtYmVyXG4gIHByaXZhdGUgbW9uaXRvcmluZ1BlcmlvZDogbnVtYmVyXG4gIHByaXZhdGUgaGFsZk9wZW5SZXF1ZXN0czogbnVtYmVyXG4gIHByaXZhdGUgb25TdGF0ZUNoYW5nZT86IChvbGRTdGF0ZTogQ2lyY3VpdFN0YXRlLCBuZXdTdGF0ZTogQ2lyY3VpdFN0YXRlKSA9PiB2b2lkXG5cbiAgY29uc3RydWN0b3Iob3B0aW9uczogQ2lyY3VpdEJyZWFrZXJPcHRpb25zKSB7XG4gICAgdGhpcy5uYW1lID0gb3B0aW9ucy5uYW1lXG4gICAgdGhpcy5mYWlsdXJlVGhyZXNob2xkID0gb3B0aW9ucy5mYWlsdXJlVGhyZXNob2xkIHx8IDVcbiAgICB0aGlzLnJlc2V0VGltZW91dCA9IG9wdGlvbnMucmVzZXRUaW1lb3V0IHx8IDYwMDAwIC8vIDEgbWludXRlXG4gICAgdGhpcy5tb25pdG9yaW5nUGVyaW9kID0gb3B0aW9ucy5tb25pdG9yaW5nUGVyaW9kIHx8IDEwMDAwIC8vIDEwIHNlY29uZHNcbiAgICB0aGlzLmhhbGZPcGVuUmVxdWVzdHMgPSBvcHRpb25zLmhhbGZPcGVuUmVxdWVzdHMgfHwgM1xuICAgIHRoaXMub25TdGF0ZUNoYW5nZSA9IG9wdGlvbnMub25TdGF0ZUNoYW5nZVxuICB9XG5cbiAgYXN5bmMgZXhlY3V0ZTxUPihmbjogKCkgPT4gUHJvbWlzZTxUPik6IFByb21pc2U8VD4ge1xuICAgIC8vIENoZWNrIGlmIGNpcmN1aXQgc2hvdWxkIHRyYW5zaXRpb24gZnJvbSBPUEVOIHRvIEhBTEZfT1BFTlxuICAgIGlmICh0aGlzLnN0YXRlID09PSBDaXJjdWl0U3RhdGUuT1BFTikge1xuICAgICAgaWYgKHRoaXMuc2hvdWxkVHJhbnNpdGlvblRvSGFsZk9wZW4oKSkge1xuICAgICAgICB0aGlzLnRyYW5zaXRpb25UbyhDaXJjdWl0U3RhdGUuSEFMRl9PUEVOKVxuICAgICAgfSBlbHNlIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBDaXJjdWl0IGJyZWFrZXIgJHt0aGlzLm5hbWV9IGlzIE9QRU5gKVxuICAgICAgfVxuICAgIH1cblxuICAgIC8vIEluIEhBTEZfT1BFTiBzdGF0ZSwgbGltaXQgdGhlIG51bWJlciBvZiByZXF1ZXN0c1xuICAgIGlmICh0aGlzLnN0YXRlID09PSBDaXJjdWl0U3RhdGUuSEFMRl9PUEVOKSB7XG4gICAgICBpZiAodGhpcy5oYWxmT3BlblJlcXVlc3RDb3VudCA+PSB0aGlzLmhhbGZPcGVuUmVxdWVzdHMpIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBDaXJjdWl0IGJyZWFrZXIgJHt0aGlzLm5hbWV9IGlzIEhBTEZfT1BFTiBhbmQgYXQgcmVxdWVzdCBsaW1pdGApXG4gICAgICB9XG4gICAgICB0aGlzLmhhbGZPcGVuUmVxdWVzdENvdW50KytcbiAgICB9XG5cbiAgICB0cnkge1xuICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgZm4oKVxuICAgICAgdGhpcy5vblN1Y2Nlc3MoKVxuICAgICAgcmV0dXJuIHJlc3VsdFxuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICB0aGlzLm9uRmFpbHVyZSgpXG4gICAgICB0aHJvdyBlcnJvclxuICAgIH1cbiAgfVxuXG4gIHByaXZhdGUgb25TdWNjZXNzKCk6IHZvaWQge1xuICAgIHRoaXMuZmFpbHVyZUNvdW50ID0gMFxuICAgIHRoaXMuc3VjY2Vzc0NvdW50KytcblxuICAgIGlmICh0aGlzLnN0YXRlID09PSBDaXJjdWl0U3RhdGUuSEFMRl9PUEVOKSB7XG4gICAgICAvLyBJZiBhbGwgaGFsZi1vcGVuIHJlcXVlc3RzIHN1Y2NlZWQsIGNsb3NlIHRoZSBjaXJjdWl0XG4gICAgICBpZiAodGhpcy5zdWNjZXNzQ291bnQgPj0gdGhpcy5oYWxmT3BlblJlcXVlc3RzKSB7XG4gICAgICAgIHRoaXMudHJhbnNpdGlvblRvKENpcmN1aXRTdGF0ZS5DTE9TRUQpXG4gICAgICB9XG4gICAgfVxuXG4gICAgbG9nZ2VyLmRlYnVnKCdDaXJjdWl0IGJyZWFrZXIgcmVxdWVzdCBzdWNjZWVkZWQnLCB7XG4gICAgICBuYW1lOiB0aGlzLm5hbWUsXG4gICAgICBzdGF0ZTogdGhpcy5zdGF0ZSxcbiAgICAgIHN1Y2Nlc3NDb3VudDogdGhpcy5zdWNjZXNzQ291bnRcbiAgICB9KVxuICB9XG5cbiAgcHJpdmF0ZSBvbkZhaWx1cmUoKTogdm9pZCB7XG4gICAgdGhpcy5mYWlsdXJlQ291bnQrK1xuICAgIHRoaXMubGFzdEZhaWx1cmVUaW1lID0gRGF0ZS5ub3coKVxuICAgIHRoaXMuc3VjY2Vzc0NvdW50ID0gMFxuXG4gICAgbG9nZ2VyLndhcm4oJ0NpcmN1aXQgYnJlYWtlciByZXF1ZXN0IGZhaWxlZCcsIHtcbiAgICAgIG5hbWU6IHRoaXMubmFtZSxcbiAgICAgIHN0YXRlOiB0aGlzLnN0YXRlLFxuICAgICAgZmFpbHVyZUNvdW50OiB0aGlzLmZhaWx1cmVDb3VudCxcbiAgICAgIHRocmVzaG9sZDogdGhpcy5mYWlsdXJlVGhyZXNob2xkXG4gICAgfSlcblxuICAgIGlmICh0aGlzLnN0YXRlID09PSBDaXJjdWl0U3RhdGUuSEFMRl9PUEVOKSB7XG4gICAgICAvLyBBbnkgZmFpbHVyZSBpbiBIQUxGX09QRU4gc3RhdGUgcmVvcGVucyB0aGUgY2lyY3VpdFxuICAgICAgdGhpcy50cmFuc2l0aW9uVG8oQ2lyY3VpdFN0YXRlLk9QRU4pXG4gICAgfSBlbHNlIGlmICh0aGlzLnN0YXRlID09PSBDaXJjdWl0U3RhdGUuQ0xPU0VEICYmIHRoaXMuZmFpbHVyZUNvdW50ID49IHRoaXMuZmFpbHVyZVRocmVzaG9sZCkge1xuICAgICAgLy8gVG9vIG1hbnkgZmFpbHVyZXMgaW4gQ0xPU0VEIHN0YXRlIG9wZW5zIHRoZSBjaXJjdWl0XG4gICAgICB0aGlzLnRyYW5zaXRpb25UbyhDaXJjdWl0U3RhdGUuT1BFTilcbiAgICB9XG4gIH1cblxuICBwcml2YXRlIHNob3VsZFRyYW5zaXRpb25Ub0hhbGZPcGVuKCk6IGJvb2xlYW4ge1xuICAgIGlmICghdGhpcy5sYXN0RmFpbHVyZVRpbWUpIHJldHVybiBmYWxzZVxuICAgIHJldHVybiBEYXRlLm5vdygpIC0gdGhpcy5sYXN0RmFpbHVyZVRpbWUgPj0gdGhpcy5yZXNldFRpbWVvdXRcbiAgfVxuXG4gIHByaXZhdGUgdHJhbnNpdGlvblRvKG5ld1N0YXRlOiBDaXJjdWl0U3RhdGUpOiB2b2lkIHtcbiAgICBjb25zdCBvbGRTdGF0ZSA9IHRoaXMuc3RhdGVcbiAgICB0aGlzLnN0YXRlID0gbmV3U3RhdGVcblxuICAgIC8vIFJlc2V0IGNvdW50ZXJzIG9uIHN0YXRlIHRyYW5zaXRpb25cbiAgICBpZiAobmV3U3RhdGUgPT09IENpcmN1aXRTdGF0ZS5IQUxGX09QRU4pIHtcbiAgICAgIHRoaXMuaGFsZk9wZW5SZXF1ZXN0Q291bnQgPSAwXG4gICAgICB0aGlzLnN1Y2Nlc3NDb3VudCA9IDBcbiAgICB9IGVsc2UgaWYgKG5ld1N0YXRlID09PSBDaXJjdWl0U3RhdGUuQ0xPU0VEKSB7XG4gICAgICB0aGlzLmZhaWx1cmVDb3VudCA9IDBcbiAgICAgIHRoaXMuc3VjY2Vzc0NvdW50ID0gMFxuICAgICAgdGhpcy5oYWxmT3BlblJlcXVlc3RDb3VudCA9IDBcbiAgICB9XG5cbiAgICBsb2dnZXIuaW5mbygnQ2lyY3VpdCBicmVha2VyIHN0YXRlIGNoYW5nZWQnLCB7XG4gICAgICBuYW1lOiB0aGlzLm5hbWUsXG4gICAgICBvbGRTdGF0ZSxcbiAgICAgIG5ld1N0YXRlXG4gICAgfSlcblxuICAgIGlmICh0aGlzLm9uU3RhdGVDaGFuZ2UpIHtcbiAgICAgIHRoaXMub25TdGF0ZUNoYW5nZShvbGRTdGF0ZSwgbmV3U3RhdGUpXG4gICAgfVxuICB9XG5cbiAgZ2V0U3RhdGUoKTogQ2lyY3VpdFN0YXRlIHtcbiAgICByZXR1cm4gdGhpcy5zdGF0ZVxuICB9XG5cbiAgZ2V0U3RhdHMoKSB7XG4gICAgcmV0dXJuIHtcbiAgICAgIG5hbWU6IHRoaXMubmFtZSxcbiAgICAgIHN0YXRlOiB0aGlzLnN0YXRlLFxuICAgICAgZmFpbHVyZUNvdW50OiB0aGlzLmZhaWx1cmVDb3VudCxcbiAgICAgIHN1Y2Nlc3NDb3VudDogdGhpcy5zdWNjZXNzQ291bnQsXG4gICAgICBsYXN0RmFpbHVyZVRpbWU6IHRoaXMubGFzdEZhaWx1cmVUaW1lLFxuICAgICAgaGFsZk9wZW5SZXF1ZXN0Q291bnQ6IHRoaXMuaGFsZk9wZW5SZXF1ZXN0Q291bnRcbiAgICB9XG4gIH1cblxuICByZXNldCgpOiB2b2lkIHtcbiAgICB0aGlzLnRyYW5zaXRpb25UbyhDaXJjdWl0U3RhdGUuQ0xPU0VEKVxuICAgIHRoaXMuZmFpbHVyZUNvdW50ID0gMFxuICAgIHRoaXMuc3VjY2Vzc0NvdW50ID0gMFxuICAgIHRoaXMubGFzdEZhaWx1cmVUaW1lID0gdW5kZWZpbmVkXG4gICAgdGhpcy5oYWxmT3BlblJlcXVlc3RDb3VudCA9IDBcbiAgfVxufVxuXG4vLyBFeHBvbmVudGlhbCBiYWNrb2ZmIGhlbHBlclxuZXhwb3J0IGNsYXNzIEV4cG9uZW50aWFsQmFja29mZiB7XG4gIHByaXZhdGUgYXR0ZW1wdCA9IDBcbiAgcHJpdmF0ZSBiYXNlRGVsYXk6IG51bWJlclxuICBwcml2YXRlIG1heERlbGF5OiBudW1iZXJcbiAgcHJpdmF0ZSBtYXhBdHRlbXB0czogbnVtYmVyXG5cbiAgY29uc3RydWN0b3IoXG4gICAgYmFzZURlbGF5ID0gMTAwMCxcbiAgICBtYXhEZWxheSA9IDMwMDAwLFxuICAgIG1heEF0dGVtcHRzID0gNVxuICApIHtcbiAgICB0aGlzLmJhc2VEZWxheSA9IGJhc2VEZWxheVxuICAgIHRoaXMubWF4RGVsYXkgPSBtYXhEZWxheVxuICAgIHRoaXMubWF4QXR0ZW1wdHMgPSBtYXhBdHRlbXB0c1xuICB9XG5cbiAgYXN5bmMgZXhlY3V0ZTxUPihmbjogKCkgPT4gUHJvbWlzZTxUPik6IFByb21pc2U8VD4ge1xuICAgIGxldCBsYXN0RXJyb3I6IHVua25vd24gPSBuZXcgRXJyb3IoJ05vIGF0dGVtcHRzIG1hZGUnKVxuICAgIFxuICAgIGZvciAobGV0IGF0dGVtcHQgPSAwOyBhdHRlbXB0IDwgdGhpcy5tYXhBdHRlbXB0czsgYXR0ZW1wdCsrKSB7XG4gICAgICB0cnkge1xuICAgICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBmbigpXG4gICAgICAgIHRoaXMucmVzZXQoKVxuICAgICAgICByZXR1cm4gcmVzdWx0XG4gICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICBsYXN0RXJyb3IgPSBlcnJvclxuICAgICAgICB0aGlzLmF0dGVtcHQgPSBhdHRlbXB0ICsgMVxuICAgICAgICBcbiAgICAgICAgaWYgKHRoaXMuYXR0ZW1wdCA+PSB0aGlzLm1heEF0dGVtcHRzKSB7XG4gICAgICAgICAgbG9nZ2VyLmVycm9yKCdNYXggcmV0cnkgYXR0ZW1wdHMgcmVhY2hlZCcsIHtcbiAgICAgICAgICAgIGF0dGVtcHRzOiB0aGlzLmF0dGVtcHQsXG4gICAgICAgICAgICBtYXhBdHRlbXB0czogdGhpcy5tYXhBdHRlbXB0c1xuICAgICAgICAgIH0pXG4gICAgICAgICAgdGhyb3cgZXJyb3JcbiAgICAgICAgfVxuXG4gICAgICAgIGNvbnN0IGRlbGF5ID0gdGhpcy5nZXREZWxheSgpXG4gICAgICAgIGxvZ2dlci53YXJuKCdSZXRyeWluZyBhZnRlciBiYWNrb2ZmJywge1xuICAgICAgICAgIGF0dGVtcHQ6IHRoaXMuYXR0ZW1wdCxcbiAgICAgICAgICBkZWxheSxcbiAgICAgICAgICBlcnJvcjogZXJyb3IgaW5zdGFuY2VvZiBFcnJvciA/IGVycm9yLm1lc3NhZ2UgOiAnVW5rbm93biBlcnJvcidcbiAgICAgICAgfSlcbiAgICAgICAgXG4gICAgICAgIGF3YWl0IHRoaXMuc2xlZXAoZGVsYXkpXG4gICAgICB9XG4gICAgfVxuXG4gICAgdGhyb3cgbGFzdEVycm9yXG4gIH1cblxuICBwcml2YXRlIGdldERlbGF5KCk6IG51bWJlciB7XG4gICAgLy8gRXhwb25lbnRpYWwgYmFja29mZiB3aXRoIGppdHRlclxuICAgIGNvbnN0IGV4cG9uZW50aWFsRGVsYXkgPSBNYXRoLm1pbihcbiAgICAgIHRoaXMuYmFzZURlbGF5ICogTWF0aC5wb3coMiwgdGhpcy5hdHRlbXB0IC0gMSksXG4gICAgICB0aGlzLm1heERlbGF5XG4gICAgKVxuICAgIFxuICAgIC8vIEFkZCBqaXR0ZXIgKMKxMjUlKVxuICAgIGNvbnN0IGppdHRlciA9IGV4cG9uZW50aWFsRGVsYXkgKiAwLjI1XG4gICAgcmV0dXJuIE1hdGguZmxvb3IoZXhwb25lbnRpYWxEZWxheSArIChNYXRoLnJhbmRvbSgpICogMiAtIDEpICogaml0dGVyKVxuICB9XG5cbiAgcHJpdmF0ZSBzbGVlcChtczogbnVtYmVyKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgcmV0dXJuIG5ldyBQcm9taXNlKHJlc29sdmUgPT4gc2V0VGltZW91dChyZXNvbHZlLCBtcykpXG4gIH1cblxuICByZXNldCgpOiB2b2lkIHtcbiAgICB0aGlzLmF0dGVtcHQgPSAwXG4gIH1cbn0iXSwibmFtZXMiOlsiU3RydWN0dXJlZExvZ2dlciIsImpzb25UcmFuc3BvcnQiLCJwcmV0dHlUcmFuc3BvcnQiLCJsb2dnZXIiLCJwcm9jZXNzIiwiQ2lyY3VpdFN0YXRlIiwiQ2lyY3VpdEJyZWFrZXIiLCJjb25zdHJ1Y3RvciIsIm9wdGlvbnMiLCJzdGF0ZSIsImZhaWx1cmVDb3VudCIsInN1Y2Nlc3NDb3VudCIsImhhbGZPcGVuUmVxdWVzdENvdW50IiwibmFtZSIsImZhaWx1cmVUaHJlc2hvbGQiLCJyZXNldFRpbWVvdXQiLCJtb25pdG9yaW5nUGVyaW9kIiwiaGFsZk9wZW5SZXF1ZXN0cyIsIm9uU3RhdGVDaGFuZ2UiLCJleGVjdXRlIiwiZm4iLCJzaG91bGRUcmFuc2l0aW9uVG9IYWxmT3BlbiIsInRyYW5zaXRpb25UbyIsIkVycm9yIiwicmVzdWx0Iiwib25TdWNjZXNzIiwiZXJyb3IiLCJvbkZhaWx1cmUiLCJkZWJ1ZyIsImxhc3RGYWlsdXJlVGltZSIsIkRhdGUiLCJub3ciLCJ3YXJuIiwidGhyZXNob2xkIiwibmV3U3RhdGUiLCJvbGRTdGF0ZSIsImluZm8iLCJnZXRTdGF0ZSIsImdldFN0YXRzIiwicmVzZXQiLCJ1bmRlZmluZWQiLCJFeHBvbmVudGlhbEJhY2tvZmYiLCJiYXNlRGVsYXkiLCJtYXhEZWxheSIsIm1heEF0dGVtcHRzIiwiYXR0ZW1wdCIsImxhc3RFcnJvciIsImF0dGVtcHRzIiwiZGVsYXkiLCJnZXREZWxheSIsIm1lc3NhZ2UiLCJzbGVlcCIsImV4cG9uZW50aWFsRGVsYXkiLCJNYXRoIiwibWluIiwicG93Iiwiaml0dGVyIiwiZmxvb3IiLCJyYW5kb20iLCJtcyIsIlByb21pc2UiLCJyZXNvbHZlIiwic2V0VGltZW91dCJdLCJpZ25vcmVMaXN0IjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./src/server/services/circuitBreaker.ts\n");

/***/ }),

/***/ "(rsc)/./src/server/services/concurrencyManager.ts":
/*!***************************************************!*\
  !*** ./src/server/services/concurrencyManager.ts ***!
  \***************************************************/
/***/ ((module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.a(module, async (__webpack_handle_async_dependencies__, __webpack_async_result__) => { try {\n__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   ConcurrencyManager: () => (/* binding */ ConcurrencyManager),\n/* harmony export */   concurrencyManager: () => (/* binding */ concurrencyManager)\n/* harmony export */ });\n/* harmony import */ var _redisClient__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./redisClient */ \"(rsc)/./src/server/services/redisClient.ts\");\nvar __webpack_async_dependencies__ = __webpack_handle_async_dependencies__([_redisClient__WEBPACK_IMPORTED_MODULE_0__]);\n_redisClient__WEBPACK_IMPORTED_MODULE_0__ = (__webpack_async_dependencies__.then ? (await __webpack_async_dependencies__)() : __webpack_async_dependencies__)[0];\n// Concurrency control for preventing duplicate API requests\n\nclass ConcurrencyManager {\n    async initialize() {\n        this.redis = await (0,_redisClient__WEBPACK_IMPORTED_MODULE_0__.getRedisClient)();\n    }\n    /**\n   * Acquire a distributed lock using Redis SETNX\n   */ async acquireLock(key, options = {}) {\n        const { ttl = 10, retries = 3, retryDelay = 100 } = options;\n        const lockKey = `lock:${key}`;\n        const token = `${Date.now()}-${Math.random()}`;\n        // If Redis is not available, use local locks\n        if (!this.redis) {\n            return this.acquireLocalLock(key, token);\n        }\n        for(let i = 0; i <= retries; i++){\n            try {\n                // Try to set the lock with NX (only if not exists) and EX (expiry)\n                const result = await this.redis.set(lockKey, token, 'NX', 'EX', ttl);\n                if (result === 'OK') {\n                    return {\n                        acquired: true,\n                        token\n                    };\n                }\n                // If not the last retry, wait before trying again\n                if (i < retries) {\n                    await new Promise((resolve)=>setTimeout(resolve, retryDelay));\n                }\n            } catch (error) {\n                console.error('Error acquiring lock:', error);\n                // Fall back to local lock on Redis error\n                return this.acquireLocalLock(key, token);\n            }\n        }\n        return {\n            acquired: false,\n            token: ''\n        };\n    }\n    /**\n   * Release a distributed lock\n   */ async releaseLock(key, token) {\n        const lockKey = `lock:${key}`;\n        if (!this.redis) {\n            return this.releaseLocalLock(key);\n        }\n        try {\n            // Lua script to ensure we only delete our own lock\n            const script = `\n        if redis.call(\"get\", KEYS[1]) == ARGV[1] then\n          return redis.call(\"del\", KEYS[1])\n        else\n          return 0\n        end\n      `;\n            const result = await this.redis.eval(script, 1, lockKey, token);\n            return result === 1;\n        } catch (error) {\n            console.error('Error releasing lock:', error);\n            return this.releaseLocalLock(key);\n        }\n    }\n    /**\n   * Execute a function with distributed locking\n   */ async withLock(key, fn, options = {}) {\n        const { acquired, token } = await this.acquireLock(key, options);\n        if (!acquired) {\n            throw new Error(`Failed to acquire lock for key: ${key}`);\n        }\n        try {\n            return await fn();\n        } finally{\n            await this.releaseLock(key, token);\n        }\n    }\n    /**\n   * Wait for an existing operation or start a new one\n   * This prevents duplicate operations for the same key\n   */ async deduplicateOperation(key, fn, options = {}) {\n        const operationKey = `operation:${key}`;\n        // Check if there's already an operation in progress locally\n        const existingOperation = this.localLocks.get(operationKey);\n        if (existingOperation) {\n            return existingOperation;\n        }\n        // Start a new operation with locking\n        const operation = this.withLock(key, fn, options).finally(()=>{\n            // Clean up local lock after operation completes\n            this.localLocks.delete(operationKey);\n        });\n        // Store the operation promise locally\n        this.localLocks.set(operationKey, operation);\n        return operation;\n    }\n    /**\n   * Local lock fallback when Redis is not available\n   */ acquireLocalLock(key, token) {\n        const lockKey = `lock:${key}`;\n        if (this.localLocks.has(lockKey)) {\n            return {\n                acquired: false,\n                token: ''\n            };\n        }\n        this.localLocks.set(lockKey, Promise.resolve(token));\n        return {\n            acquired: true,\n            token\n        };\n    }\n    /**\n   * Release local lock\n   */ releaseLocalLock(key) {\n        const lockKey = `lock:${key}`;\n        return this.localLocks.delete(lockKey);\n    }\n    constructor(){\n        this.redis = null;\n        this.localLocks = new Map();\n    }\n}\n// Export singleton instance\nconst concurrencyManager = new ConcurrencyManager();\n\n__webpack_async_result__();\n} catch(e) { __webpack_async_result__(e); } });//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9zcmMvc2VydmVyL3NlcnZpY2VzL2NvbmN1cnJlbmN5TWFuYWdlci50cyIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7QUFBQSw0REFBNEQ7QUFHZDtBQVF2QyxNQUFNQztJQUlYLE1BQU1DLGFBQTRCO1FBQ2hDLElBQUksQ0FBQ0MsS0FBSyxHQUFHLE1BQU1ILDREQUFjQTtJQUNuQztJQUVBOztHQUVDLEdBQ0QsTUFBTUksWUFDSkMsR0FBVyxFQUNYQyxVQUF1QixDQUFDLENBQUMsRUFDc0I7UUFDL0MsTUFBTSxFQUFFQyxNQUFNLEVBQUUsRUFBRUMsVUFBVSxDQUFDLEVBQUVDLGFBQWEsR0FBRyxFQUFFLEdBQUdIO1FBQ3BELE1BQU1JLFVBQVUsQ0FBQyxLQUFLLEVBQUVMLEtBQUs7UUFDN0IsTUFBTU0sUUFBUSxHQUFHQyxLQUFLQyxHQUFHLEdBQUcsQ0FBQyxFQUFFQyxLQUFLQyxNQUFNLElBQUk7UUFFOUMsNkNBQTZDO1FBQzdDLElBQUksQ0FBQyxJQUFJLENBQUNaLEtBQUssRUFBRTtZQUNmLE9BQU8sSUFBSSxDQUFDYSxnQkFBZ0IsQ0FBQ1gsS0FBS007UUFDcEM7UUFFQSxJQUFLLElBQUlNLElBQUksR0FBR0EsS0FBS1QsU0FBU1MsSUFBSztZQUNqQyxJQUFJO2dCQUNGLG1FQUFtRTtnQkFDbkUsTUFBTUMsU0FBUyxNQUFNLElBQUksQ0FBQ2YsS0FBSyxDQUFDZ0IsR0FBRyxDQUFDVCxTQUFTQyxPQUFPLE1BQU0sTUFBTUo7Z0JBRWhFLElBQUlXLFdBQVcsTUFBTTtvQkFDbkIsT0FBTzt3QkFBRUUsVUFBVTt3QkFBTVQ7b0JBQU07Z0JBQ2pDO2dCQUVBLGtEQUFrRDtnQkFDbEQsSUFBSU0sSUFBSVQsU0FBUztvQkFDZixNQUFNLElBQUlhLFFBQVFDLENBQUFBLFVBQVdDLFdBQVdELFNBQVNiO2dCQUNuRDtZQUNGLEVBQUUsT0FBT2UsT0FBTztnQkFDZEMsUUFBUUQsS0FBSyxDQUFDLHlCQUF5QkE7Z0JBQ3ZDLHlDQUF5QztnQkFDekMsT0FBTyxJ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cnZlci9zZXJ2aWNlcy9jb25jdXJyZW5jeU1hbmFnZXIudHMiXSwic291cmNlc0NvbnRlbnQiOlsiLy8gQ29uY3VycmVuY3kgY29udHJvbCBmb3IgcHJldmVudGluZyBkdXBsaWNhdGUgQVBJIHJlcXVlc3RzXG5cbmltcG9ydCB0eXBlIHsgUmVkaXMgfSBmcm9tICdpb3JlZGlzJ1xuaW1wb3J0IHsgZ2V0UmVkaXNDbGllbnQgfSBmcm9tICcuL3JlZGlzQ2xpZW50J1xuXG5leHBvcnQgaW50ZXJmYWNlIExvY2tPcHRpb25zIHtcbiAgdHRsPzogbnVtYmVyIC8vIExvY2sgVFRMIGluIHNlY29uZHMgKGRlZmF1bHQ6IDEwKVxuICByZXRyaWVzPzogbnVtYmVyIC8vIE51bWJlciBvZiByZXRyaWVzIChkZWZhdWx0OiAzKVxuICByZXRyeURlbGF5PzogbnVtYmVyIC8vIERlbGF5IGJldHdlZW4gcmV0cmllcyBpbiBtcyAoZGVmYXVsdDogMTAwKVxufVxuXG5leHBvcnQgY2xhc3MgQ29uY3VycmVuY3lNYW5hZ2VyIHtcbiAgcHJpdmF0ZSByZWRpczogUmVkaXMgfCBudWxsID0gbnVsbFxuICBwcml2YXRlIGxvY2FsTG9ja3MgPSBuZXcgTWFwPHN0cmluZywgUHJvbWlzZTxhbnk+PigpXG5cbiAgYXN5bmMgaW5pdGlhbGl6ZSgpOiBQcm9taXNlPHZvaWQ+IHtcbiAgICB0aGlzLnJlZGlzID0gYXdhaXQgZ2V0UmVkaXNDbGllbnQoKVxuICB9XG5cbiAgLyoqXG4gICAqIEFjcXVpcmUgYSBkaXN0cmlidXRlZCBsb2NrIHVzaW5nIFJlZGlzIFNFVE5YXG4gICAqL1xuICBhc3luYyBhY3F1aXJlTG9jayhcbiAgICBrZXk6IHN0cmluZyxcbiAgICBvcHRpb25zOiBMb2NrT3B0aW9ucyA9IHt9XG4gICk6IFByb21pc2U8eyBhY3F1aXJlZDogYm9vbGVhbjsgdG9rZW46IHN0cmluZyB9PiB7XG4gICAgY29uc3QgeyB0dGwgPSAxMCwgcmV0cmllcyA9IDMsIHJldHJ5RGVsYXkgPSAxMDAgfSA9IG9wdGlvbnNcbiAgICBjb25zdCBsb2NrS2V5ID0gYGxvY2s6JHtrZXl9YFxuICAgIGNvbnN0IHRva2VuID0gYCR7RGF0ZS5ub3coKX0tJHtNYXRoLnJhbmRvbSgpfWBcblxuICAgIC8vIElmIFJlZGlzIGlzIG5vdCBhdmFpbGFibGUsIHVzZSBsb2NhbCBsb2Nrc1xuICAgIGlmICghdGhpcy5yZWRpcykge1xuICAgICAgcmV0dXJuIHRoaXMuYWNxdWlyZUxvY2FsTG9jayhrZXksIHRva2VuKVxuICAgIH1cblxuICAgIGZvciAobGV0IGkgPSAwOyBpIDw9IHJldHJpZXM7IGkrKykge1xuICAgICAgdHJ5IHtcbiAgICAgICAgLy8gVHJ5IHRvIHNldCB0aGUgbG9jayB3aXRoIE5YIChvbmx5IGlmIG5vdCBleGlzdHMpIGFuZCBFWCAoZXhwaXJ5KVxuICAgICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCB0aGlzLnJlZGlzLnNldChsb2NrS2V5LCB0b2tlbiwgJ05YJywgJ0VYJywgdHRsKVxuICAgICAgICBcbiAgICAgICAgaWYgKHJlc3VsdCA9PT0gJ09LJykge1xuICAgICAgICAgIHJldHVybiB7IGFjcXVpcmVkOiB0cnVlLCB0b2tlbiB9XG4gICAgICAgIH1cblxuICAgICAgICAvLyBJZiBub3QgdGhlIGxhc3QgcmV0cnksIHdhaXQgYmVmb3JlIHRyeWluZyBhZ2FpblxuICAgICAgICBpZiAoaSA8IHJldHJpZXMpIHtcbiAgICAgICAgICBhd2FpdCBuZXcgUHJvbWlzZShyZXNvbHZlID0+IHNldFRpbWVvdXQocmVzb2x2ZSwgcmV0cnlEZWxheSkpXG4gICAgICAgIH1cbiAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGFjcXVpcmluZyBsb2NrOicsIGVycm9yKVxuICAgICAgICAvLyBGYWxsIGJhY2sgdG8gbG9jYWwgbG9jayBvbiBSZWRpcyBlcnJvclxuICAgICAgICByZXR1cm4gdGhpcy5hY3F1aXJlTG9jYWxMb2NrKGtleSwgdG9rZW4pXG4gICAgICB9XG4gICAgfVxuXG4gICAgcmV0dXJuIHsgYWNxdWlyZWQ6IGZhbHNlLCB0b2tlbjogJycgfVxuICB9XG5cbiAgLyoqXG4gICAqIFJlbGVhc2UgYSBkaXN0cmlidXRlZCBsb2NrXG4gICAqL1xuICBhc3luYyByZWxlYXNlTG9jayhrZXk6IHN0cmluZywgdG9rZW46IHN0cmluZyk6IFByb21pc2U8Ym9vbGVhbj4ge1xuICAgIGNvbnN0IGxvY2tLZXkgPSBgbG9jazoke2tleX1gXG5cbiAgICBpZiAoIXRoaXMucmVkaXMpIHtcbiAgICAgIHJldHVybiB0aGlzLnJlbGVhc2VMb2NhbExvY2soa2V5KVxuICAgIH1cblxuICAgIHRyeSB7XG4gICAgICAvLyBMdWEgc2NyaXB0IHRvIGVuc3VyZSB3ZSBvbmx5IGRlbGV0ZSBvdXIgb3duIGxvY2tcbiAgICAgIGNvbnN0IHNjcmlwdCA9IGBcbiAgICAgICAgaWYgcmVkaXMuY2FsbChcImdldFwiLCBLRVlTWzFdKSA9PSBBUkdWWzFdIHRoZW5cbiAgICAgICAgICByZXR1cm4gcmVkaXMuY2FsbChcImRlbFwiLCBLRVlTWzFdKVxuICAgICAgICBlbHNlXG4gICAgICAgICAgcmV0dXJuIDBcbiAgICAgICAgZW5kXG4gICAgICBgXG5cbiAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IHRoaXMucmVkaXMuZXZhbChzY3JpcHQsIDEsIGxvY2tLZXksIHRva2VuKSBhcyBudW1iZXJcbiAgICAgIHJldHVybiByZXN1bHQgPT09IDFcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgcmVsZWFzaW5nIGxvY2s6JywgZXJyb3IpXG4gICAgICByZXR1cm4gdGhpcy5yZWxlYXNlTG9jYWxMb2NrKGtleSlcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogRXhlY3V0ZSBhIGZ1bmN0aW9uIHdpdGggZGlzdHJpYnV0ZWQgbG9ja2luZ1xuICAgKi9cbiAgYXN5bmMgd2l0aExvY2s8VD4oXG4gICAga2V5OiBzdHJpbmcsXG4gICAgZm46ICgpID0+IFByb21pc2U8VD4sXG4gICAgb3B0aW9uczogTG9ja09wdGlvbnMgPSB7fVxuICApOiBQcm9taXNlPFQ+IHtcbiAgICBjb25zdCB7IGFjcXVpcmVkLCB0b2tlbiB9ID0gYXdhaXQgdGhpcy5hY3F1aXJlTG9jayhrZXksIG9wdGlvbnMpXG5cbiAgICBpZiAoIWFjcXVpcmVkKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoYEZhaWxlZCB0byBhY3F1aXJlIGxvY2sgZm9yIGtleTogJHtrZXl9YClcbiAgICB9XG5cbiAgICB0cnkge1xuICAgICAgcmV0dXJuIGF3YWl0IGZuKClcbiAgICB9IGZpbmFsbHkge1xuICAgICAgYXdhaXQgdGhpcy5yZWxlYXNlTG9jayhrZXksIHRva2VuKVxuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiBXYWl0IGZvciBhbiBleGlzdGluZyBvcGVyYXRpb24gb3Igc3RhcnQgYSBuZXcgb25lXG4gICAqIFRoaXMgcHJldmVudHMgZHVwbGljYXRlIG9wZXJhdGlvbnMgZm9yIHRoZSBzYW1lIGtleVxuICAgKi9cbiAgYXN5bmMgZGVkdXBsaWNhdGVPcGVyYXRpb248VD4oXG4gICAga2V5OiBzdHJpbmcsXG4gICAgZm46ICgpID0+IFByb21pc2U8VD4sXG4gICAgb3B0aW9uczogTG9ja09wdGlvbnMgPSB7fVxuICApOiBQcm9taXNlPFQ+IHtcbiAgICBjb25zdCBvcGVyYXRpb25LZXkgPSBgb3BlcmF0aW9uOiR7a2V5fWBcblxuICAgIC8vIENoZWNrIGlmIHRoZXJlJ3MgYWxyZWFkeSBhbiBvcGVyYXRpb24gaW4gcHJvZ3Jlc3MgbG9jYWxseVxuICAgIGNvbnN0IGV4aXN0aW5nT3BlcmF0aW9uID0gdGhpcy5sb2NhbExvY2tzLmdldChvcGVyYXRpb25LZXkpXG4gICAgaWYgKGV4aXN0aW5nT3BlcmF0aW9uKSB7XG4gICAgICByZXR1cm4gZXhpc3RpbmdPcGVyYXRpb25cbiAgICB9XG5cbiAgICAvLyBTdGFydCBhIG5ldyBvcGVyYXRpb24gd2l0aCBsb2NraW5nXG4gICAgY29uc3Qgb3BlcmF0aW9uID0gdGhpcy53aXRoTG9jayhrZXksIGZuLCBvcHRpb25zKVxuICAgICAgLmZpbmFsbHkoKCkgPT4ge1xuICAgICAgICAvLyBDbGVhbiB1cCBsb2NhbCBsb2NrIGFmdGVyIG9wZXJhdGlvbiBjb21wbGV0ZXNcbiAgICAgICAgdGhpcy5sb2NhbExvY2tzLmRlbGV0ZShvcGVyYXRpb25LZXkpXG4gICAgICB9KVxuXG4gICAgLy8gU3RvcmUgdGhlIG9wZXJhdGlvbiBwcm9taXNlIGxvY2FsbHlcbiAgICB0aGlzLmxvY2FsTG9ja3Muc2V0KG9wZXJhdGlvbktleSwgb3BlcmF0aW9uKVxuXG4gICAgcmV0dXJuIG9wZXJhdGlvblxuICB9XG5cbiAgLyoqXG4gICAqIExvY2FsIGxvY2sgZmFsbGJhY2sgd2hlbiBSZWRpcyBpcyBub3QgYXZhaWxhYmxlXG4gICAqL1xuICBwcml2YXRlIGFjcXVpcmVMb2NhbExvY2soa2V5OiBzdHJpbmcsIHRva2VuOiBzdHJpbmcpOiB7IGFjcXVpcmVkOiBib29sZWFuOyB0b2tlbjogc3RyaW5nIH0ge1xuICAgIGNvbnN0IGxvY2tLZXkgPSBgbG9jazoke2tleX1gXG4gICAgXG4gICAgaWYgKHRoaXMubG9jYWxMb2Nrcy5oYXMobG9ja0tleSkpIHtcbiAgICAgIHJldHVybiB7IGFjcXVpcmVkOiBmYWxzZSwgdG9rZW46ICcnIH1cbiAgICB9XG5cbiAgICB0aGlzLmxvY2FsTG9ja3Muc2V0KGxvY2tLZXksIFByb21pc2UucmVzb2x2ZSh0b2tlbikpXG4gICAgcmV0dXJuIHsgYWNxdWlyZWQ6IHRydWUsIHRva2VuIH1cbiAgfVxuXG4gIC8qKlxuICAgKiBSZWxlYXNlIGxvY2FsIGxvY2tcbiAgICovXG4gIHByaXZhdGUgcmVsZWFzZUxvY2FsTG9jayhrZXk6IHN0cmluZyk6IGJvb2xlYW4ge1xuICAgIGNvbnN0IGxvY2tLZXkgPSBgbG9jazoke2tleX1gXG4gICAgcmV0dXJuIHRoaXMubG9jYWxMb2Nrcy5kZWxldGUobG9ja0tleSlcbiAgfVxufVxuXG4vLyBFeHBvcnQgc2luZ2xldG9uIGluc3RhbmNlXG5leHBvcnQgY29uc3QgY29uY3VycmVuY3lNYW5hZ2VyID0gbmV3IENvbmN1cnJlbmN5TWFuYWdlcigpIl0sIm5hbWVzIjpbImdldFJlZGlzQ2xpZW50IiwiQ29uY3VycmVuY3lNYW5hZ2VyIiwiaW5pdGlhbGl6ZSIsInJlZGlzIiwiYWNxdWlyZUxvY2siLCJrZXkiLCJvcHRpb25zIiwidHRsIiwicmV0cmllcyIsInJldHJ5RGVsYXkiLCJsb2NrS2V5IiwidG9rZW4iLCJEYXRlIiwibm93IiwiTWF0aCIsInJhbmRvbSIsImFjcXVpcmVMb2NhbExvY2siLCJpIiwicmVzdWx0Iiwic2V0IiwiYWNxdWlyZWQiLCJQcm9taXNlIiwicmVzb2x2ZSIsInNldFRpbWVvdXQiLCJlcnJvciIsImNvbnNvbGUiLCJyZWxlYXNlTG9jayIsInJlbGVhc2VMb2NhbExvY2siLCJzY3JpcHQiLCJldmFsIiwid2l0aExvY2siLCJmbiIsIkVycm9yIiwiZGVkdXBsaWNhdGVPcGVyYXRpb24iLCJvcGVyYXRpb25LZXkiLCJleGlzdGluZ09wZXJhdGlvbiIsImxvY2FsTG9ja3MiLCJnZXQiLCJvcGVyYXRpb24iLCJmaW5hbGx5IiwiZGVsZXRlIiwiaGFzIiwiTWFwIiwiY29uY3VycmVuY3lNYW5hZ2VyIl0sImlnbm9yZUxpc3QiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./src/server/services/concurrencyManager.ts\n");

/***/ }),

/***/ "(rsc)/./src/server/services/inMemoryCache.ts":
/*!**********************************************!*\
  !*** ./src/server/services/inMemoryCache.ts ***!
  \**********************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   InMemoryCache: () => (/* binding */ InMemoryCache),\n/* harmony export */   inMemoryAirportCache: () => (/* binding */ inMemoryAirportCache)\n/* harmony export */ });\n/* harmony import */ var _lib_cache_observability__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../lib/cache/observability */ \"(rsc)/./src/lib/cache/observability/index.ts\");\n// In-memory cache fallback implementation for when Redis is unavailable\n\nconst logger = new _lib_cache_observability__WEBPACK_IMPORTED_MODULE_0__.StructuredLogger('in-memory-cache', {},  false ? 0 : _lib_cache_observability__WEBPACK_IMPORTED_MODULE_0__.prettyTransport);\nclass InMemoryCache {\n    constructor(maxSize = parseInt(process.env.IN_MEMORY_CACHE_MAX_SIZE || '1000', 10), evictionCheckInterval = parseInt(process.env.IN_MEMORY_CACHE_CLEANUP_INTERVAL || '300000', 10) // 5 minutes\n    ){\n        this.cache = new Map();\n        this.stats = {\n            hits: 0,\n            misses: 0,\n            errors: 0,\n            lastReset: Date.now()\n        };\n        this.cleanupInterval = null;\n        this.maxSize = maxSize;\n        this.evictionCheckInterval = evictionCheckInterval;\n        this.startCleanupTimer();\n    }\n    async initialize() {\n        logger.info('In-memory cache initialized', {\n            maxSize: this.maxSize\n        });\n    }\n    async get(key) {\n        try {\n            const entry = this.cache.get(key);\n            if (!entry) {\n                this.stats.misses++;\n                return null;\n            }\n            // Check if expired\n            if (Date.now() > entry.expiresAt) {\n                this.cache.delete(key);\n                this.stats.misses++;\n                logger.debug('Cache entry expired', {\n                    key\n                });\n                return null;\n            }\n            this.stats.hits++;\n            return entry.item;\n        } catch (error) {\n            this.stats.errors++;\n            logger.error('Cache get error', error, {\n                key\n            });\n            return null;\n        }\n    }\n    async set(key, data, ttlSeconds) {\n        try {\n            // Enforce size limit with LRU eviction\n            if (this.cache.size >= this.maxSize) {\n                this.evictOldest();\n            }\n            const now = Date.now();\n            const cacheItem = {\n                data,\n                source: 'in-memory',\n                fetchedAt: now,\n                expiresAt: now + ttlSeconds * 1000\n            };\n            this.cache.set(key, {\n                item: cacheItem,\n                expiresAt: cacheItem.expiresAt\n            });\n            logger.debug('Cache entry set', {\n                key,\n                ttlSeconds\n            });\n        } catch (error) {\n            this.stats.errors++;\n            logger.error('Cache set error', error, {\n                key\n            });\n        }\n    }\n    async delete(key) {\n        try {\n            const existed = this.cache.has(key);\n            this.cache.delete(key);\n            return existed;\n        } catch (error) {\n            this.stats.errors++;\n            logger.error('Cache delete error', error, {\n                key\n            });\n            return false;\n        }\n    }\n    async exists(key) {\n        try {\n            const entry = this.cache.get(key);\n            if (!entry) return false;\n            // Check if expired\n            if (Date.now() > entry.expiresAt) {\n                this.cache.delete(key);\n                return false;\n            }\n            return true;\n        } catch (error) {\n            this.stats.errors++;\n            logger.error('Cache exists error', error, {\n                key\n            });\n            return false;\n        }\n    }\n    async clear(pattern) {\n        try {\n            let deleted = 0;\n            if (!pattern) {\n                deleted = this.cache.size;\n                this.cache.clear();\n            } else {\n                // Simple pattern matching (supports * wildcard at end)\n                const regex = new RegExp('^' + pattern.replace(/\\*/g, '.*') + '$');\n                for (const [key] of this.cache){\n                    if (regex.test(key)) {\n                        this.cache.delete(key);\n                        deleted++;\n                    }\n                }\n            }\n            logger.info('Cache cleared', {\n                pattern,\n                deleted\n            });\n            return deleted;\n        } catch (error) {\n            this.stats.errors++;\n            logger.error('Cache clear error', error, {\n                pattern\n            });\n            return 0;\n        }\n    }\n    async getStats() {\n        return {\n            ...this.stats\n        };\n    }\n    async resetStats() {\n        this.stats = {\n            hits: 0,\n            misses: 0,\n            errors: 0,\n            lastReset: Date.now()\n        };\n    }\n    evictOldest() {\n        let oldestKey = null;\n        let oldestTime = Infinity;\n        // Find the oldest entry\n        for (const [key, entry] of this.cache){\n            if (entry.item.fetchedAt < oldestTime) {\n                oldestTime = entry.item.fetchedAt;\n                oldestKey = key;\n            }\n        }\n        if (oldestKey) {\n            this.cache.delete(oldestKey);\n            logger.debug('Evicted oldest cache entry', {\n                key: oldestKey\n            });\n        }\n    }\n    cleanup() {\n        const now = Date.now();\n        let cleaned = 0;\n        for (const [key, entry] of this.cache){\n            if (now > entry.expiresAt) {\n                this.cache.delete(key);\n                cleaned++;\n            }\n        }\n        if (cleaned > 0) {\n            logger.info('Cleaned up expired entries', {\n                count: cleaned\n            });\n        }\n    }\n    startCleanupTimer() {\n        this.cleanupInterval = setInterval(()=>{\n            this.cleanup();\n        }, this.evictionCheckInterval);\n    }\n    destroy() {\n        if (this.cleanupInterval) {\n            clearInterval(this.cleanupInterval);\n            this.cleanupInterval = null;\n        }\n        this.cache.clear();\n        logger.info('In-memory cache destroyed');\n    }\n}\n// Singleton instance for airport cache\nconst inMemoryAirportCache = new InMemoryCache();\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9zcmMvc2VydmVyL3NlcnZpY2VzL2luTWVtb3J5Q2FjaGUudHMiLCJtYXBwaW5ncyI6Ijs7Ozs7O0FBQUEsd0VBQXdFO0FBSXdCO0FBRWhHLE1BQU1HLFNBQVMsSUFBSUgsc0VBQWdCQSxDQUNqQyxtQkFDQSxDQUFDLEdBQ0RJLE1BQXFDLEdBQUdILENBQWFBLEdBQUdDLHFFQUFlQTtBQVFsRSxNQUFNRztJQVlYQyxZQUNFQyxVQUFVQyxTQUFTSixRQUFRSyxHQUFHLENBQUNDLHdCQUF3QixJQUFJLFFBQVEsR0FBRyxFQUN0RUMsd0JBQXdCSCxTQUFTSixRQUFRSyxHQUFHLENBQUNHLGdDQUFnQyxJQUFJLFVBQVUsSUFBSSxZQUFZO0lBQWIsQ0FDOUY7YUFkTUMsUUFBUSxJQUFJQzthQUNaQyxRQUFvQjtZQUMxQkMsTUFBTTtZQUNOQyxRQUFRO1lBQ1JDLFFBQVE7WUFDUkMsV0FBV0MsS0FBS0MsR0FBRztRQUNyQjthQUNRQyxrQkFBdUM7UUFRN0MsSUFBSSxDQUFDZixPQUFPLEdBQUdBO1FBQ2YsSUFBSSxDQUFDSSxxQkFBcUIsR0FBR0E7UUFDN0IsSUFBSSxDQUFDWSxpQkFBaUI7SUFDeEI7SUFFQSxNQUFNQyxhQUE0QjtRQUNoQ3JCLE9BQU9zQixJQUFJLENBQUMsK0JBQStCO1lBQUVsQixTQUFTLElBQUksQ0FBQ0EsT0FBTztRQUFDO0lBQ3JFO0lBRUEsTUFBTW1CLElBQUlDLEdBQVcsRUFBZ0M7UUFDbkQsSUFBSTtZQUNGLE1BQU1DLFFBQVEsSUFBSSxDQUFDZixLQUFLLENBQUNhLEdBQUcsQ0FBQ0M7WUFFN0IsSUFBSSxDQUFDQyxPQUFPO2dCQUNWLElBQUksQ0FBQ2IsS0FBSyxDQUFDRSxNQUFNO2dCQUNqQixPQUFPO1lBQ1Q7WUFFQSxtQkFBbUI7WUFDbkIsSUFBSUcsS0FBS0MsR0FBRyxLQUFLTyxNQUFNQyxTQUFTLEVBQUU7Z0JBQ2hDLElBQUksQ0FBQ2hCLEtBQUssQ0FBQ2lCLE1BQU0sQ0FBQ0g7Z0JBQ2xCLElBQUksQ0FBQ1osS0FB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QkFDekIsSUFBSSxDQUFDaEIsS0FBSyxDQUFDaUIsTUFBTSxDQUFDSDtnQkFDbEIrQjtZQUNGO1FBQ0Y7UUFFQSxJQUFJQSxVQUFVLEdBQUc7WUFDZnZELE9BQU9zQixJQUFJLENBQUMsOEJBQThCO2dCQUFFa0MsT0FBT0Q7WUFBUTtRQUM3RDtJQUNGO0lBRVFuQyxvQkFBMEI7UUFDaEMsSUFBSSxDQUFDRCxlQUFlLEdBQUdzQyxZQUFZO1lBQ2pDLElBQUksQ0FBQ0gsT0FBTztRQUNkLEdBQUcsSUFBSSxDQUFDOUMscUJBQXFCO0lBQy9CO0lBRUFrRCxVQUFnQjtRQUNkLElBQUksSUFBSSxDQUFDdkMsZUFBZSxFQUFFO1lBQ3hCd0MsY0FBYyxJQUFJLENBQUN4QyxlQUFlO1lBQ2xDLElBQUksQ0FBQ0EsZUFBZSxHQUFHO1FBQ3pCO1FBQ0EsSUFBSSxDQUFDVCxLQUFLLENBQUNnQyxLQUFLO1FBQ2hCMUMsT0FBT3NCLElBQUksQ0FBQztJQUNkO0FBQ0Y7QUFFQSx1Q0FBdUM7QUFDaEMsTUFBTXNDLHVCQUF1QixJQUFJMUQsZ0JBQXdCIiwic291cmNlcyI6WyIvVXNlcnMvcnViZWVuL2Rldi9wZXJzb25hbC9haXJwb3J0LWRiL3NyYy9zZXJ2ZXIvc2VydmljZXMvaW5NZW1vcnlDYWNoZS50cyJdLCJzb3VyY2VzQ29udGVudCI6WyIvLyBJbi1tZW1vcnkgY2FjaGUgZmFsbGJhY2sgaW1wbGVtZW50YXRpb24gZm9yIHdoZW4gUmVkaXMgaXMgdW5hdmFpbGFibGVcblxuaW1wb3J0IHR5cGUgeyBBaXJwb3J0IH0gZnJvbSAnLi4vLi4vdHlwZXMvYWlycG9ydCdcbmltcG9ydCB0eXBlIHsgQ2FjaGVJdGVtLCBDYWNoZVN0YXRzLCBDYWNoZVNlcnZpY2UgfSBmcm9tICcuLi8uLi90eXBlcy9jYWNoZSdcbmltcG9ydCB7IFN0cnVjdHVyZWRMb2dnZXIsIGpzb25UcmFuc3BvcnQsIHByZXR0eVRyYW5zcG9ydCB9IGZyb20gJy4uLy4uL2xpYi9jYWNoZS9vYnNlcnZhYmlsaXR5J1xuXG5jb25zdCBsb2dnZXIgPSBuZXcgU3RydWN0dXJlZExvZ2dlcihcbiAgJ2luLW1lbW9yeS1jYWNoZScsXG4gIHt9LFxuICBwcm9jZXNzLmVudi5OT0RFX0VOViA9PT0gJ3Byb2R1Y3Rpb24nID8ganNvblRyYW5zcG9ydCA6IHByZXR0eVRyYW5zcG9ydFxuKVxuXG5pbnRlcmZhY2UgSW5NZW1vcnlDYWNoZUVudHJ5PFQ+IHtcbiAgaXRlbTogQ2FjaGVJdGVtPFQ+XG4gIGV4cGlyZXNBdDogbnVtYmVyXG59XG5cbmV4cG9ydCBjbGFzcyBJbk1lbW9yeUNhY2hlPFQgPSBhbnk+IGltcGxlbWVudHMgQ2FjaGVTZXJ2aWNlPFQ+IHtcbiAgcHJpdmF0ZSBjYWNoZSA9IG5ldyBNYXA8c3RyaW5nLCBJbk1lbW9yeUNhY2hlRW50cnk8VD4+KClcbiAgcHJpdmF0ZSBzdGF0czogQ2FjaGVTdGF0cyA9IHtcbiAgICBoaXRzOiAwLFxuICAgIG1pc3NlczogMCxcbiAgICBlcnJvcnM6IDAsXG4gICAgbGFzdFJlc2V0OiBEYXRlLm5vdygpXG4gIH1cbiAgcHJpdmF0ZSBjbGVhbnVwSW50ZXJ2YWw6IE5vZGVKUy5UaW1lciB8IG51bGwgPSBudWxsXG4gIHByaXZhdGUgbWF4U2l6ZTogbnVtYmVyXG4gIHByaXZhdGUgZXZpY3Rpb25DaGVja0ludGVydmFsOiBudW1iZXJcblxuICBjb25zdHJ1Y3RvcihcbiAgICBtYXhTaXplID0gcGFyc2VJbnQocHJvY2Vzcy5lbnYuSU5fTUVNT1JZX0NBQ0hFX01BWF9TSVpFIHx8ICcxMDAwJywgMTApLFxuICAgIGV2aWN0aW9uQ2hlY2tJbnRlcnZhbCA9IHBhcnNlSW50KHByb2Nlc3MuZW52LklOX01FTU9SWV9DQUNIRV9DTEVBTlVQX0lOVEVSVkFMIHx8ICczMDAwMDAnLCAxMCkgLy8gNSBtaW51dGVzXG4gICkge1xuICAgIHRoaXMubWF4U2l6ZSA9IG1heFNpemVcbiAgICB0aGlzLmV2aWN0aW9uQ2hlY2tJbnRlcnZhbCA9IGV2aWN0aW9uQ2hlY2tJbnRlcnZhbFxuICAgIHRoaXMuc3RhcnRDbGVhbnVwVGltZXIoKVxuICB9XG5cbiAgYXN5bmMgaW5pdGlhbGl6ZSgpOiBQcm9taXNlPHZvaWQ+IHtcbiAgICBsb2dnZXIuaW5mbygnSW4tbWVtb3J5IGNhY2hlIGluaXRpYWxpemVkJywgeyBtYXhTaXplOiB0aGlzLm1heFNpemUgfSlcbiAgfVxuXG4gIGFzeW5jIGdldChrZXk6IHN0cmluZyk6IFByb21pc2U8Q2FjaGVJdGVtPFQ+IHwgbnVsbD4ge1xuICAgIHRyeSB7XG4gICAgICBjb25zdCBlbnRyeSA9IHRoaXMuY2FjaGUuZ2V0KGtleSlcbiAgICAgIFxuICAgICAgaWYgKCFlbnRyeSkge1xuICAgICAgICB0aGlzLnN0YXRzLm1pc3NlcysrXG4gICAgICAgIHJldHVybiBudWxsXG4gICAgICB9XG5cbiAgICAgIC8vIENoZWNrIGlmIGV4cGlyZWRcbiAgICAgIGlmIChEYXRlLm5vdygpID4gZW50cnkuZXhwaXJlc0F0KSB7XG4gICAgICAgIHRoaXMuY2FjaGUuZGVsZXRlKGtleSlcbiAgICAgICAgdGhpcy5zdGF0cy5taXNzZXMrK1xuICAgICAgICBsb2dnZXIuZGVidWcoJ0NhY2hlIGVudHJ5IGV4cGlyZWQnLCB7IGtleSB9KVxuICAgICAgICByZXR1cm4gbnVsbFxuICAgICAgfVxuXG4gICAgICB0aGlzLnN0YXRzLmhpdHMrK1xuICAgICAgcmV0dXJuIGVudHJ5Lml0ZW1cbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgdGhpcy5zdGF0cy5lcnJvcnMrK1xuICAgICAgbG9nZ2VyLmVycm9yKCdDYWNoZSBnZXQgZXJyb3InLCBlcnJvciBhcyBFcnJvciwgeyBrZXkgfSlcbiAgICAgIHJldHVybiBudWxsXG4gICAgfVxuICB9XG5cbiAgYXN5bmMgc2V0KGtleTogc3RyaW5nLCBkYXRhOiBULCB0dGxTZWNvbmRzOiBudW1iZXIpOiBQcm9taXNlPHZvaWQ+IHtcbiAgICB0cnkge1xuICAgICAgLy8gRW5mb3JjZSBzaXplIGxpbWl0IHdpdGggTFJVIGV2aWN0aW9uXG4gICAgICBpZiAodGhpcy5jYWNoZS5zaXplID49IHRoaXMubWF4U2l6ZSkge1xuICAgICAgICB0aGlzLmV2aWN0T2xkZXN0KClcbiAgICAgIH1cblxuICAgICAgY29uc3Qgbm93ID0gRGF0ZS5ub3coKVxuICAgICAgY29uc3QgY2FjaGVJdGVtOiBDYWNoZUl0ZW08VD4gPSB7XG4gICAgICAgIGRhdGEsXG4gICAgICAgIHNvdXJjZTogJ2luLW1lbW9yeScsXG4gICAgICAgIGZldGNoZWRBdDogbm93LFxuICAgICAgICBleHBpcmVzQXQ6IG5vdyArICh0dGxTZWNvbmRzICogMTAwMClcbiAgICAgIH1cblxuICAgICAgdGhpcy5jYWNoZS5zZXQoa2V5LCB7XG4gICAgICAgIGl0ZW06IGNhY2hlSXRlbSxcbiAgICAgICAgZXhwaXJlc0F0OiBjYWNoZUl0ZW0uZXhwaXJlc0F0XG4gICAgICB9KVxuXG4gICAgICBsb2dnZXIuZGVidWcoJ0NhY2hlIGVudHJ5IHNldCcsIHsga2V5LCB0dGxTZWNvbmRzIH0pXG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIHRoaXMuc3RhdHMuZXJyb3JzKytcbiAgICAgIGxvZ2dlci5lcnJvcignQ2FjaGUgc2V0IGVycm9yJywgZXJyb3IgYXMgRXJyb3IsIHsga2V5IH0pXG4gICAgfVxuICB9XG5cbiAgYXN5bmMgZGVsZXRlKGtleTogc3RyaW5nKTogUHJvbWlzZTxib29sZWFuPiB7XG4gICAgdHJ5IHtcbiAgICAgIGNvbnN0IGV4aXN0ZWQgPSB0aGlzLmNhY2hlLmhhcyhrZXkpXG4gICAgICB0aGlzLmNhY2hlLmRlbGV0ZShrZXkpXG4gICAgICByZXR1cm4gZXhpc3RlZFxuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICB0aGlzLnN0YXRzLmVycm9ycysrXG4gICAgICBsb2dnZXIuZXJyb3IoJ0NhY2hlIGRlbGV0ZSBlcnJvcicsIGVycm9yIGFzIEVycm9yLCB7IGtleSB9KVxuICAgICAgcmV0dXJuIGZhbHNlXG4gICAgfVxuICB9XG5cbiAgYXN5bmMgZXhpc3RzKGtleTogc3RyaW5nKTogUHJvbWlzZTxib29sZWFuPiB7XG4gICAgdHJ5IHtcbiAgICAgIGNvbnN0IGVudHJ5ID0gdGhpcy5jYWNoZS5nZXQoa2V5KVxuICAgICAgaWYgKCFlbnRyeSkgcmV0dXJuIGZhbHNlXG4gICAgICBcbiAgICAgIC8vIENoZWNrIGlmIGV4cGlyZWRcbiAgICAgIGlmIChEYXRlLm5vdygpID4gZW50cnkuZXhwaXJlc0F0KSB7XG4gICAgICAgIHRoaXMuY2FjaGUuZGVsZXRlKGtleSlcbiAgICAgICAgcmV0dXJuIGZhbHNlXG4gICAgICB9XG4gICAgICBcbiAgICAgIHJldHVybiB0cnVlXG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIHRoaXMuc3RhdHMuZXJyb3JzKytcbiAgICAgIGxvZ2dlci5lcnJvcignQ2FjaGUgZXhpc3RzIGVycm9yJywgZXJyb3IgYXMgRXJyb3IsIHsga2V5IH0pXG4gICAgICByZXR1cm4gZmFsc2VcbiAgICB9XG4gIH1cblxuICBhc3luYyBjbGVhcihwYXR0ZXJuPzogc3RyaW5nKTogUHJvbWlzZTxudW1iZXI+IHtcbiAgICB0cnkge1xuICAgICAgbGV0IGRlbGV0ZWQgPSAwXG4gICAgICBcbiAgICAgIGlmICghcGF0dGVybikge1xuICAgICAgICBkZWxldGVkID0gdGhpcy5jYWNoZS5zaXplXG4gICAgICAgIHRoaXMuY2FjaGUuY2xlYXIoKVxuICAgICAgfSBlbHNlIHtcbiAgICAgICAgLy8gU2ltcGxlIHBhdHRlcm4gbWF0Y2hpbmcgKHN1cHBvcnRzICogd2lsZGNhcmQgYXQgZW5kKVxuICAgICAgICBjb25zdCByZWdleCA9IG5ldyBSZWdFeHAoJ14nICsgcGF0dGVybi5yZXBsYWNlKC9cXCovZywgJy4qJykgKyAnJCcpXG4gICAgICAgIGZvciAoY29uc3QgW2tleV0gb2YgdGhpcy5jYWNoZSkge1xuICAgICAgICAgIGlmIChyZWdleC50ZXN0KGtleSkpIHtcbiAgICAgICAgICAgIHRoaXMuY2FjaGUuZGVsZXRlKGtleSlcbiAgICAgICAgICAgIGRlbGV0ZWQrK1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgXG4gICAgICBsb2dnZXIuaW5mbygnQ2FjaGUgY2xlYXJlZCcsIHsgcGF0dGVybiwgZGVsZXRlZCB9KVxuICAgICAgcmV0dXJuIGRlbGV0ZWRcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgdGhpcy5zdGF0cy5lcnJvcnMrK1xuICAgICAgbG9nZ2VyLmVycm9yKCdDYWNoZSBjbGVhciBlcnJvcicsIGVycm9yIGFzIEVycm9yLCB7IHBhdHRlcm4gfSlcbiAgICAgIHJldHVybiAwXG4gICAgfVxuICB9XG5cbiAgYXN5bmMgZ2V0U3RhdHMoKTogUHJvbWlzZTxDYWNoZVN0YXRzPiB7XG4gICAgcmV0dXJuIHsgLi4udGhpcy5zdGF0cyB9XG4gIH1cblxuICBhc3luYyByZXNldFN0YXRzKCk6IFByb21pc2U8dm9pZD4ge1xuICAgIHRoaXMuc3RhdHMgPSB7XG4gICAgICBoaXRzOiAwLFxuICAgICAgbWlzc2VzOiAwLFxuICAgICAgZXJyb3JzOiAwLFxuICAgICAgbGFzdFJlc2V0OiBEYXRlLm5vdygpXG4gICAgfVxuICB9XG5cbiAgcHJpdmF0ZSBldmljdE9sZGVzdCgpOiB2b2lkIHtcbiAgICBsZXQgb2xkZXN0S2V5OiBzdHJpbmcgfCBudWxsID0gbnVsbFxuICAgIGxldCBvbGRlc3RUaW1lID0gSW5maW5pdHlcblxuICAgIC8vIEZpbmQgdGhlIG9sZGVzdCBlbnRyeVxuICAgIGZvciAoY29uc3QgW2tleSwgZW50cnldIG9mIHRoaXMuY2FjaGUpIHtcbiAgICAgIGlmIChlbnRyeS5pdGVtLmZldGNoZWRBdCA8IG9sZGVzdFRpbWUpIHtcbiAgICAgICAgb2xkZXN0VGltZSA9IGVudHJ5Lml0ZW0uZmV0Y2hlZEF0XG4gICAgICAgIG9sZGVzdEtleSA9IGtleVxuICAgICAgfVxuICAgIH1cblxuICAgIGlmIChvbGRlc3RLZXkpIHtcbiAgICAgIHRoaXMuY2FjaGUuZGVsZXRlKG9sZGVzdEtleSlcbiAgICAgIGxvZ2dlci5kZWJ1ZygnRXZpY3RlZCBvbGRlc3QgY2FjaGUgZW50cnknLCB7IGtleTogb2xkZXN0S2V5IH0pXG4gICAgfVxuICB9XG5cbiAgcHJpdmF0ZSBjbGVhbnVwKCk6IHZvaWQge1xuICAgIGNvbnN0IG5vdyA9IERhdGUubm93KClcbiAgICBsZXQgY2xlYW5lZCA9IDBcblxuICAgIGZvciAoY29uc3QgW2tleSwgZW50cnldIG9mIHRoaXMuY2FjaGUpIHtcbiAgICAgIGlmIChub3cgPiBlbnRyeS5leHBpcmVzQXQpIHtcbiAgICAgICAgdGhpcy5jYWNoZS5kZWxldGUoa2V5KVxuICAgICAgICBjbGVhbmVkKytcbiAgICAgIH1cbiAgICB9XG5cbiAgICBpZiAoY2xlYW5lZCA+IDApIHtcbiAgICAgIGxvZ2dlci5pbmZvKCdDbGVhbmVkIHVwIGV4cGlyZWQgZW50cmllcycsIHsgY291bnQ6IGNsZWFuZWQgfSlcbiAgICB9XG4gIH1cblxuICBwcml2YXRlIHN0YXJ0Q2xlYW51cFRpbWVyKCk6IHZvaWQge1xuICAgIHRoaXMuY2xlYW51cEludGVydmFsID0gc2V0SW50ZXJ2YWwoKCkgPT4ge1xuICAgICAgdGhpcy5jbGVhbnVwKClcbiAgICB9LCB0aGlzLmV2aWN0aW9uQ2hlY2tJbnRlcnZhbClcbiAgfVxuXG4gIGRlc3Ryb3koKTogdm9pZCB7XG4gICAgaWYgKHRoaXMuY2xlYW51cEludGVydmFsKSB7XG4gICAgICBjbGVhckludGVydmFsKHRoaXMuY2xlYW51cEludGVydmFsKVxuICAgICAgdGhpcy5jbGVhbnVwSW50ZXJ2YWwgPSBudWxsXG4gICAgfVxuICAgIHRoaXMuY2FjaGUuY2xlYXIoKVxuICAgIGxvZ2dlci5pbmZvKCdJbi1tZW1vcnkgY2FjaGUgZGVzdHJveWVkJylcbiAgfVxufVxuXG4vLyBTaW5nbGV0b24gaW5zdGFuY2UgZm9yIGFpcnBvcnQgY2FjaGVcbmV4cG9ydCBjb25zdCBpbk1lbW9yeUFpcnBvcnRDYWNoZSA9IG5ldyBJbk1lbW9yeUNhY2hlPEFpcnBvcnQ+KCkiXSwibmFtZXMiOlsiU3RydWN0dXJlZExvZ2dlciIsImpzb25UcmFuc3BvcnQiLCJwcmV0dHlUcmFuc3BvcnQiLCJsb2dnZXIiLCJwcm9jZXNzIiwiSW5NZW1vcnlDYWNoZSIsImNvbnN0cnVjdG9yIiwibWF4U2l6ZSIsInBhcnNlSW50IiwiZW52IiwiSU5fTUVNT1JZX0NBQ0hFX01BWF9TSVpFIiwiZXZpY3Rpb25DaGVja0ludGVydmFsIiwiSU5fTUVNT1JZX0NBQ0hFX0NMRUFOVVBfSU5URVJWQUwiLCJjYWNoZSIsIk1hcCIsInN0YXRzIiwiaGl0cyIsIm1pc3NlcyIsImVycm9ycyIsImxhc3RSZXNldCIsIkRhdGUiLCJub3ciLCJjbGVhbnVwSW50ZXJ2YWwiLCJzdGFydENsZWFudXBUaW1lciIsImluaXRpYWxpemUiLCJpbmZvIiwiZ2V0Iiwia2V5IiwiZW50cnkiLCJleHBpcmVzQXQiLCJkZWxldGUiLCJkZWJ1ZyIsIml0ZW0iLCJlcnJvciIsInNldCIsImRhdGEiLCJ0dGxTZWNvbmRzIiwic2l6ZSIsImV2aWN0T2xkZXN0IiwiY2FjaGVJdGVtIiwic291cmNlIiwiZmV0Y2hlZEF0IiwiZXhpc3RlZCIsImhhcyIsImV4aXN0cyIsImNsZWFyIiwicGF0dGVybiIsImRlbGV0ZWQiLCJyZWdleCIsIlJlZ0V4cCIsInJlcGxhY2UiLCJ0ZXN0IiwiZ2V0U3RhdHMiLCJyZXNldFN0YXRzIiwib2xkZXN0S2V5Iiwib2xkZXN0VGltZSIsIkluZmluaXR5IiwiY2xlYW51cCIsImNsZWFuZWQiLCJjb3VudCIsInNldEludGVydmFsIiwiZGVzdHJveSIsImNsZWFySW50ZXJ2YWwiLCJpbk1lbW9yeUFpcnBvcnRDYWNoZSJdLCJpZ25vcmVMaXN0IjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./src/server/services/inMemoryCache.ts\n");

/***/ }),

/***/ "(rsc)/./src/server/services/redisClient.ts":
/*!********************************************!*\
  !*** ./src/server/services/redisClient.ts ***!
  \********************************************/
/***/ ((module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.a(module, async (__webpack_handle_async_dependencies__, __webpack_async_result__) => { try {\n__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   closeRedisClient: () => (/* binding */ closeRedisClient),\n/* harmony export */   getRedisCircuitBreaker: () => (/* binding */ getRedisCircuitBreaker),\n/* harmony export */   getRedisClient: () => (/* binding */ getRedisClient),\n/* harmony export */   getRedisConfig: () => (/* binding */ getRedisConfig)\n/* harmony export */ });\n/* harmony import */ var ioredis__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ioredis */ \"ioredis\");\n/* harmony import */ var ioredis__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(ioredis__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var _lib_cache_observability__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../lib/cache/observability */ \"(rsc)/./src/lib/cache/observability/index.ts\");\n/* harmony import */ var _circuitBreaker__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./circuitBreaker */ \"(rsc)/./src/server/services/circuitBreaker.ts\");\n/* harmony import */ var _secretsManager__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./secretsManager */ \"(rsc)/./src/server/services/secretsManager.ts\");\n// Redis client configuration and initialization\n\n\n\n\n// Load environment variables for server-side only\nif (true) {\n    await __webpack_require__.e(/*! import() */ \"vendor-chunks/dotenv@16.5.0\").then(__webpack_require__.t.bind(__webpack_require__, /*! dotenv */ \"(rsc)/./node_modules/.pnpm/dotenv@16.5.0/node_modules/dotenv/lib/main.js\", 23)).then((mod)=>mod.config());\n}\nconst logger = new _lib_cache_observability__WEBPACK_IMPORTED_MODULE_1__.StructuredLogger('redis', {},  false ? 0 : _lib_cache_observability__WEBPACK_IMPORTED_MODULE_1__.prettyTransport);\nlet redisClient = null;\nlet circuitBreaker = null;\nasync function getRedisConfig() {\n    const config = {};\n    // Initialize secrets manager\n    await _secretsManager__WEBPACK_IMPORTED_MODULE_3__.secretsManager.initialize();\n    const secrets = await _secretsManager__WEBPACK_IMPORTED_MODULE_3__.secretsManager.getAllSecrets();\n    if (true) {\n        config.url = \"redis://localhost:9021\";\n    } else {}\n    // TLS Configuration\n    if (process.env.REDIS_TLS_ENABLED === 'true') {\n        config.tls = {\n            rejectUnauthorized: process.env.REDIS_TLS_REJECT_UNAUTHORIZED !== 'false'\n        };\n        // Use secrets for TLS certificates\n        if (secrets.redisTlsCa) {\n            config.tls.ca = secrets.redisTlsCa;\n        }\n        if (secrets.redisTlsCert) {\n            config.tls.cert = secrets.redisTlsCert;\n        }\n        if (secrets.redisTlsKey) {\n            config.tls.key = secrets.redisTlsKey;\n        }\n        if (process.env.REDIS_TLS_SERVERNAME) {\n            config.tls.servername = process.env.REDIS_TLS_SERVERNAME;\n        }\n    }\n    // Connection resilience settings\n    config.maxRetriesPerRequest = 3;\n    config.enableReadyCheck = true;\n    config.retryStrategy = (times)=>{\n        if (times > 3) {\n            logger.error('Redis connection failed after 3 retries');\n            return null // Stop retrying\n            ;\n        }\n        const delay = Math.min(times * 200, 2000);\n        logger.warn(`Redis connection attempt ${times}, retrying in ${delay}ms`, {\n            attempt: times,\n            delay\n        });\n        return delay;\n    };\n    return config;\n}\n// Initialize circuit breaker for Redis operations\nfunction initializeCircuitBreaker() {\n    if (!circuitBreaker) {\n        circuitBreaker = new _circuitBreaker__WEBPACK_IMPORTED_MODULE_2__.CircuitBreaker({\n            name: 'redis',\n            failureThreshold: parseInt(process.env.REDIS_CIRCUIT_FAILURE_THRESHOLD || '5', 10),\n            resetTimeout: parseInt(process.env.REDIS_CIRCUIT_RESET_TIMEOUT || '60000', 10),\n            halfOpenRequests: parseInt(process.env.REDIS_CIRCUIT_HALF_OPEN_REQUESTS || '3', 10),\n            onStateChange: (oldState, newState)=>{\n                logger.warn('Redis circuit breaker state changed', {\n                    oldState,\n                    newState\n                });\n            }\n        });\n    }\n    return circuitBreaker;\n}\nasync function getRedisClient() {\n    // Only initialize Redis on server\n    if (false) {}\n    if (redisClient && redisClient.status === 'ready') {\n        return redisClient;\n    }\n    // Initialize circuit breaker\n    const breaker = initializeCircuitBreaker();\n    try {\n        // Use circuit breaker for connection attempt\n        return await breaker.execute(async ()=>{\n            const config = await getRedisConfig();\n            logger.info('Initializing Redis connection', {\n                host: config.host,\n                port: config.port,\n                url: config.url ? 'configured' : 'not configured'\n            });\n            redisClient = new (ioredis__WEBPACK_IMPORTED_MODULE_0___default())(config.url || config);\n            redisClient.on('connect', ()=>{\n                logger.info('Redis client connected');\n            });\n            redisClient.on('error', (err)=>{\n                logger.error('Redis client error', err);\n            });\n            redisClient.on('ready', ()=>{\n                logger.info('Redis client ready to accept commands');\n            });\n            redisClient.on('close', ()=>{\n                logger.warn('Redis connection closed');\n            });\n            redisClient.on('reconnecting', (delay)=>{\n                logger.info('Redis reconnecting', {\n                    delay\n                });\n            });\n            // Test the connection\n            await redisClient.ping();\n            logger.info('Redis connection established and tested');\n            return redisClient;\n        });\n    } catch (error) {\n        logger.error('Failed to initialize Redis client', error);\n        redisClient = null;\n        return null;\n    }\n}\nfunction getRedisCircuitBreaker() {\n    return circuitBreaker || initializeCircuitBreaker();\n}\nasync function closeRedisClient() {\n    if (redisClient) {\n        logger.info('Closing Redis connection');\n        await redisClient.quit();\n        redisClient = null;\n    }\n}\n// Graceful shutdown\nif (true) {\n    process.on('SIGTERM', async ()=>{\n        await closeRedisClient();\n    });\n    process.on('SIGINT', async ()=>{\n        await closeRedisClient();\n    });\n}\n\n__webpack_async_result__();\n} catch(e) { __webpack_async_result__(e); } }, 1);//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9zcmMvc2VydmVyL3NlcnZpY2VzL3JlZGlzQ2xpZW50LnRzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7QUFBQSxnREFBZ0Q7QUFFckI7QUFDcUU7QUFDYjtBQUNsQztBQUVqRCxrREFBa0Q7QUFDbEQsSUFBSSxJQUE2QixFQUFFO0lBQ2pDLE1BQU0sd05BQWdCLENBQUNNLElBQUksQ0FBQ0MsQ0FBQUEsTUFBT0EsSUFBSUMsTUFBTTtBQUMvQztBQUVBLE1BQU1DLFNBQVMsSUFBSVIsc0VBQWdCQSxDQUNqQyxTQUNBLENBQUMsR0FDRFMsTUFBcUMsR0FBR1IsQ0FBYUEsR0FBR0MscUVBQWVBO0FBcUJ6RSxJQUFJUSxjQUE0QjtBQUNoQyxJQUFJQyxpQkFBd0M7QUFFckMsZUFBZUM7SUFDcEIsTUFBTUwsU0FBc0IsQ0FBQztJQUU3Qiw2QkFBNkI7SUFDN0IsTUFBTUgsMkRBQWNBLENBQUNTLFVBQVU7SUFDL0IsTUFBTUMsVUFBVSxNQUFNViwyREFBY0EsQ0FBQ1csYUFBYTtJQUVsRCxJQUFJTixJQUFxQixFQUFFO1FBQ3pCRixPQUFPVyxHQUFHLEdBQUdULHdCQUFxQjtJQUNwQyxPQUFPLEVBV047SUFFRCxvQkFBb0I7SUFDcEIsSUFBSUEsUUFBUU8sR0FBRyxDQUFDWSxpQkFBaUIsS0FBSyxRQUFRO1FBQzVDckIsT0FBT3NCLEdBQUcsR0FBRztZQUNYQyxvQkFBb0JyQixRQUFRTyxHQUFHLENBQUNlLDZCQUE2QixLQUFLO1FBQ3BFO1FBRUEsbUNBQW1DO1FBQ25DLElBQUlqQixRQUFRa0IsVUFBVSxFQUFFO1lBQ3RCekIsT0FBT3NCLEdBQUcsQ0FBQ0ksRUFBRSxHQUFHbkIsUUFBUWtCLFVBQVU7UUFDcEM7UUFFQSxJQUFJbEIsUUFBUW9CLFlBQVksRUFBRTtZQUN4QjNCLE9BQU9zQixHQUFHLENBQUNNLElBQUksR0FBR3JCLFFBQVFvQixZQUFZO1FBQ3hDO1FBRUEsSUFBSXBCLFFBQVFzQixXQUFXLEVBQUU7WUFDdkI3QixPQUFPc0IsR0FBRyxD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TzFELGtCQUFrQnVDO0FBQzNCO0FBRU8sZUFBZW9CO0lBQ3BCLElBQUk1RCxhQUFhO1FBQ2ZGLE9BQU95RCxJQUFJLENBQUM7UUFDWixNQUFNdkQsWUFBWTZELElBQUk7UUFDdEI3RCxjQUFjO0lBQ2hCO0FBQ0Y7QUFFQSxvQkFBb0I7QUFDcEIsSUFBSSxJQUE2QixFQUFFO0lBQ2pDRCxRQUFReUQsRUFBRSxDQUFDLFdBQVc7UUFDcEIsTUFBTUk7SUFDUjtJQUVBN0QsUUFBUXlELEVBQUUsQ0FBQyxVQUFVO1FBQ25CLE1BQU1JO0lBQ1I7QUFDRiIsInNvdXJjZXMiOlsiL1VzZXJzL3J1YmVlbi9kZXYvcGVyc29uYWwvYWlycG9ydC1kYi9zcmMvc2VydmVyL3NlcnZpY2VzL3JlZGlzQ2xpZW50LnRzIl0sInNvdXJjZXNDb250ZW50IjpbIi8vIFJlZGlzIGNsaWVudCBjb25maWd1cmF0aW9uIGFuZCBpbml0aWFsaXphdGlvblxuXG5pbXBvcnQgUmVkaXMgZnJvbSAnaW9yZWRpcydcbmltcG9ydCB7IFN0cnVjdHVyZWRMb2dnZXIsIGpzb25UcmFuc3BvcnQsIHByZXR0eVRyYW5zcG9ydCB9IGZyb20gJy4uLy4uL2xpYi9jYWNoZS9vYnNlcnZhYmlsaXR5J1xuaW1wb3J0IHsgQ2lyY3VpdEJyZWFrZXIsIENpcmN1aXRTdGF0ZSwgRXhwb25lbnRpYWxCYWNrb2ZmIH0gZnJvbSAnLi9jaXJjdWl0QnJlYWtlcidcbmltcG9ydCB7IHNlY3JldHNNYW5hZ2VyIH0gZnJvbSAnLi9zZWNyZXRzTWFuYWdlcidcblxuLy8gTG9hZCBlbnZpcm9ubWVudCB2YXJpYWJsZXMgZm9yIHNlcnZlci1zaWRlIG9ubHlcbmlmICh0eXBlb2Ygd2luZG93ID09PSAndW5kZWZpbmVkJykge1xuICBhd2FpdCBpbXBvcnQoJ2RvdGVudicpLnRoZW4obW9kID0+IG1vZC5jb25maWcoKSlcbn1cblxuY29uc3QgbG9nZ2VyID0gbmV3IFN0cnVjdHVyZWRMb2dnZXIoXG4gICdyZWRpcycsXG4gIHt9LFxuICBwcm9jZXNzLmVudi5OT0RFX0VOViA9PT0gJ3Byb2R1Y3Rpb24nID8ganNvblRyYW5zcG9ydCA6IHByZXR0eVRyYW5zcG9ydFxuKVxuXG5leHBvcnQgaW50ZXJmYWNlIFJlZGlzQ29uZmlnIHtcbiAgdXJsPzogc3RyaW5nXG4gIGhvc3Q/OiBzdHJpbmdcbiAgcG9ydD86IG51bWJlclxuICBwYXNzd29yZD86IHN0cmluZ1xuICB1c2VybmFtZT86IHN0cmluZ1xuICBtYXhSZXRyaWVzUGVyUmVxdWVzdD86IG51bWJlclxuICBlbmFibGVSZWFkeUNoZWNrPzogYm9vbGVhblxuICByZXRyeVN0cmF0ZWd5PzogKHRpbWVzOiBudW1iZXIpID0+IG51bWJlciB8IHZvaWRcbiAgdGxzPzoge1xuICAgIGNhPzogc3RyaW5nIHwgQnVmZmVyXG4gICAgY2VydD86IHN0cmluZyB8IEJ1ZmZlclxuICAgIGtleT86IHN0cmluZyB8IEJ1ZmZlclxuICAgIHJlamVjdFVuYXV0aG9yaXplZD86IGJvb2xlYW5cbiAgICBzZXJ2ZXJuYW1lPzogc3RyaW5nXG4gIH1cbn1cblxubGV0IHJlZGlzQ2xpZW50OiBSZWRpcyB8IG51bGwgPSBudWxsXG5sZXQgY2lyY3VpdEJyZWFrZXI6IENpcmN1aXRCcmVha2VyIHwgbnVsbCA9IG51bGxcblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGdldFJlZGlzQ29uZmlnKCk6IFByb21pc2U8UmVkaXNDb25maWc+IHtcbiAgY29uc3QgY29uZmlnOiBSZWRpc0NvbmZpZyA9IHt9XG5cbiAgLy8gSW5pdGlhbGl6ZSBzZWNyZXRzIG1hbmFnZXJcbiAgYXdhaXQgc2VjcmV0c01hbmFnZXIuaW5pdGlhbGl6ZSgpXG4gIGNvbnN0IHNlY3JldHMgPSBhd2FpdCBzZWNyZXRzTWFuYWdlci5nZXRBbGxTZWNyZXRzKClcblxuICBpZiAocHJvY2Vzcy5lbnYuUkVESVNfVVJMKSB7XG4gICAgY29uZmlnLnVybCA9IHByb2Nlc3MuZW52LlJFRElTX1VSTFxuICB9IGVsc2Uge1xuICAgIGNvbmZpZy5ob3N0ID0gcHJvY2Vzcy5lbnYuUkVESVNfSE9TVCB8fCAnbG9jYWxob3N0J1xuICAgIGNvbmZpZy5wb3J0ID0gcGFyc2VJbnQocHJvY2Vzcy5lbnYuUkVESVNfUE9SVCB8fCAnOTAyMScsIDEwKVxuICAgIFxuICAgIC8vIFVzZSBzZWNyZXRzIG1hbmFnZXIgZm9yIGNyZWRlbnRpYWxzXG4gICAgaWYgKHNlY3JldHMucmVkaXNQYXNzd29yZCkge1xuICAgICAgY29uZmlnLnBhc3N3b3JkID0gc2VjcmV0cy5yZWRpc1Bhc3N3b3JkXG4gICAgfVxuICAgIGlmIChzZWNyZXRzLnJlZGlzVXNlcm5hbWUpIHtcbiAgICAgIGNvbmZpZy51c2VybmFtZSA9IHNlY3JldHMucmVkaXNVc2VybmFtZVxuICAgIH1cbiAgfVxuXG4gIC8vIFRMUyBDb25maWd1cmF0aW9uXG4gIGlmIChwcm9jZXNzLmVudi5SRURJU19UTFNfRU5BQkxFRCA9PT0gJ3RydWUnKSB7XG4gICAgY29uZmlnLnRscyA9IHtcbiAgICAgIHJlamVjdFVuYXV0aG9yaXplZDogcHJvY2Vzcy5lbnYuUkVESVNfVExTX1JFSkVDVF9VTkFVVEhPUklaRUQgIT09ICdmYWxzZSdcbiAgICB9XG5cbiAgICAvLyBVc2Ugc2VjcmV0cyBmb3IgVExTIGNlcnRpZmljYXRlc1xuICAgIGlmIChzZWNyZXRzLnJlZGlzVGxzQ2EpIHtcbiAgICAgIGNvbmZpZy50bHMuY2EgPSBzZWNyZXRzLnJlZGlzVGxzQ2FcbiAgICB9XG5cbiAgICBpZiAoc2VjcmV0cy5yZWRpc1Rsc0NlcnQpIHtcbiAgICAgIGNvbmZpZy50bHMuY2VydCA9IHNlY3JldHMucmVkaXNUbHNDZXJ0XG4gICAgfVxuXG4gICAgaWYgKHNlY3JldHMucmVkaXNUbHNLZXkpIHtcbiAgICAgIGNvbmZpZy50bHMua2V5ID0gc2VjcmV0cy5yZWRpc1Rsc0tleVxuICAgIH1cblxuICAgIGlmIChwcm9jZXNzLmVudi5SRURJU19UTFNfU0VSVkVSTkFNRSkge1xuICAgICAgY29uZmlnLnRscy5zZXJ2ZXJuYW1lID0gcHJvY2Vzcy5lbnYuUkVESVNfVExTX1NFUlZFUk5BTUVcbiAgICB9XG4gIH1cblxuICAvLyBDb25uZWN0aW9uIHJlc2lsaWVuY2Ugc2V0dGluZ3NcbiAgY29uZmlnLm1heFJldHJpZXNQZXJSZXF1ZXN0ID0gM1xuICBjb25maWcuZW5hYmxlUmVhZHlDaGVjayA9IHRydWVcbiAgY29uZmlnLnJldHJ5U3RyYXRlZ3kgPSAodGltZXM6IG51bWJlcikgPT4ge1xuICAgIGlmICh0aW1lcyA+IDMpIHtcbiAgICAgIGxvZ2dlci5lcnJvcignUmVkaXMgY29ubmVjdGlvbiBmYWlsZWQgYWZ0ZXIgMyByZXRyaWVzJylcbiAgICAgIHJldHVybiBudWxsIC8vIFN0b3AgcmV0cnlpbmdcbiAgICB9XG4gICAgY29uc3QgZGVsYXkgPSBNYXRoLm1pbih0aW1lcyAqIDIwMCwgMjAwMClcbiAgICBsb2dnZXIud2FybihgUmVkaXMgY29ubmVjdGlvbiBhdHRlbXB0ICR7dGltZXN9LCByZXRyeWluZyBpbiAke2RlbGF5fW1zYCwgeyBhdHRlbXB0OiB0aW1lcywgZGVsYXkgfSlcbiAgICByZXR1cm4gZGVsYXlcbiAgfVxuXG4gIHJldHVybiBjb25maWdcbn1cblxuLy8gSW5pdGlhbGl6ZSBjaXJjdWl0IGJyZWFrZXIgZm9yIFJlZGlzIG9wZXJhdGlvbnNcbmZ1bmN0aW9uIGluaXRpYWxpemVDaXJjdWl0QnJlYWtlcigpOiBDaXJjdWl0QnJlYWtlciB7XG4gIGlmICghY2lyY3VpdEJyZWFrZXIpIHtcbiAgICBjaXJjdWl0QnJlYWtlciA9IG5ldyBDaXJjdWl0QnJlYWtlcih7XG4gICAgICBuYW1lOiAncmVkaXMnLFxuICAgICAgZmFpbHVyZVRocmVzaG9sZDogcGFyc2VJbnQocHJvY2Vzcy5lbnYuUkVESVNfQ0lSQ1VJVF9GQUlMVVJFX1RIUkVTSE9MRCB8fCAnNScsIDEwKSxcbiAgICAgIHJlc2V0VGltZW91dDogcGFyc2VJbnQocHJvY2Vzcy5lbnYuUkVESVNfQ0lSQ1VJVF9SRVNFVF9USU1FT1VUIHx8ICc2MDAwMCcsIDEwKSxcbiAgICAgIGhhbGZPcGVuUmVxdWVzdHM6IHBhcnNlSW50KHByb2Nlc3MuZW52LlJFRElTX0NJUkNVSVRfSEFMRl9PUEVOX1JFUVVFU1RTIHx8ICczJywgMTApLFxuICAgICAgb25TdGF0ZUNoYW5nZTogKG9sZFN0YXRlLCBuZXdTdGF0ZSkgPT4ge1xuICAgICAgICBsb2dnZXIud2FybignUmVkaXMgY2lyY3VpdCBicmVha2VyIHN0YXRlIGNoYW5nZWQnLCB7IG9sZFN0YXRlLCBuZXdTdGF0ZSB9KVxuICAgICAgfVxuICAgIH0pXG4gIH1cbiAgcmV0dXJuIGNpcmN1aXRCcmVha2VyXG59XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBnZXRSZWRpc0NsaWVudCgpOiBQcm9taXNlPFJlZGlzIHwgbnVsbD4ge1xuICAvLyBPbmx5IGluaXRpYWxpemUgUmVkaXMgb24gc2VydmVyXG4gIGlmICh0eXBlb2Ygd2luZG93ICE9PSAndW5kZWZpbmVkJykge1xuICAgIHJldHVybiBudWxsXG4gIH1cblxuICBpZiAocmVkaXNDbGllbnQgJiYgcmVkaXNDbGllbnQuc3RhdHVzID09PSAncmVhZHknKSB7XG4gICAgcmV0dXJuIHJlZGlzQ2xpZW50XG4gIH1cblxuICAvLyBJbml0aWFsaXplIGNpcmN1aXQgYnJlYWtlclxuICBjb25zdCBicmVha2VyID0gaW5pdGlhbGl6ZUNpcmN1aXRCcmVha2VyKClcblxuICB0cnkge1xuICAgIC8vIFVzZSBjaXJjdWl0IGJyZWFrZXIgZm9yIGNvbm5lY3Rpb24gYXR0ZW1wdFxuICAgIHJldHVybiBhd2FpdCBicmVha2VyLmV4ZWN1dGUoYXN5bmMgKCkgPT4ge1xuICAgICAgY29uc3QgY29uZmlnID0gYXdhaXQgZ2V0UmVkaXNDb25maWcoKVxuICAgICAgXG4gICAgICBsb2dnZXIuaW5mbygnSW5pdGlhbGl6aW5nIFJlZGlzIGNvbm5lY3Rpb24nLCB7IFxuICAgICAgICBob3N0OiBjb25maWcuaG9zdCwgXG4gICAgICAgIHBvcnQ6IGNvbmZpZy5wb3J0LFxuICAgICAgICB1cmw6IGNvbmZpZy51cmwgPyAnY29uZmlndXJlZCcgOiAnbm90IGNvbmZpZ3VyZWQnXG4gICAgICB9KVxuICAgICAgXG4gICAgICByZWRpc0NsaWVudCA9IG5ldyBSZWRpcyhjb25maWcudXJsIHx8IGNvbmZpZylcblxuICAgICAgcmVkaXNDbGllbnQub24oJ2Nvbm5lY3QnLCAoKSA9PiB7XG4gICAgICAgIGxvZ2dlci5pbmZvKCdSZWRpcyBjbGllbnQgY29ubmVjdGVkJylcbiAgICAgIH0pXG5cbiAgICAgIHJlZGlzQ2xpZW50Lm9uKCdlcnJvcicsIChlcnIpID0+IHtcbiAgICAgICAgbG9nZ2VyLmVycm9yKCdSZWRpcyBjbGllbnQgZXJyb3InLCBlcnIpXG4gICAgICB9KVxuXG4gICAgICByZWRpc0NsaWVudC5vbigncmVhZHknLCAoKSA9PiB7XG4gICAgICAgIGxvZ2dlci5pbmZvKCdSZWRpcyBjbGllbnQgcmVhZHkgdG8gYWNjZXB0IGNvbW1hbmRzJylcbiAgICAgIH0pXG5cbiAgICAgIHJlZGlzQ2xpZW50Lm9uKCdjbG9zZScsICgpID0+IHtcbiAgICAgICAgbG9nZ2VyLndhcm4oJ1JlZGlzIGNvbm5lY3Rpb24gY2xvc2VkJylcbiAgICAgIH0pXG5cbiAgICAgIHJlZGlzQ2xpZW50Lm9uKCdyZWNvbm5lY3RpbmcnLCAoZGVsYXk6IG51bWJlcikgPT4ge1xuICAgICAgICBsb2dnZXIuaW5mbygnUmVkaXMgcmVjb25uZWN0aW5nJywgeyBkZWxheSB9KVxuICAgICAgfSlcblxuICAgICAgLy8gVGVzdCB0aGUgY29ubmVjdGlvblxuICAgICAgYXdhaXQgcmVkaXNDbGllbnQucGluZygpXG4gICAgICBsb2dnZXIuaW5mbygnUmVkaXMgY29ubmVjdGlvbiBlc3RhYmxpc2hlZCBhbmQgdGVzdGVkJylcbiAgICAgIFxuICAgICAgcmV0dXJuIHJlZGlzQ2xpZW50XG4gICAgfSlcbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICBsb2dnZXIuZXJyb3IoJ0ZhaWxlZCB0byBpbml0aWFsaXplIFJlZGlzIGNsaWVudCcsIGVycm9yIGFzIEVycm9yKVxuICAgIHJlZGlzQ2xpZW50ID0gbnVsbFxuICAgIHJldHVybiBudWxsXG4gIH1cbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGdldFJlZGlzQ2lyY3VpdEJyZWFrZXIoKTogQ2lyY3VpdEJyZWFrZXIgfCBudWxsIHtcbiAgcmV0dXJuIGNpcmN1aXRCcmVha2VyIHx8IGluaXRpYWxpemVDaXJjdWl0QnJlYWtlcigpXG59XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBjbG9zZVJlZGlzQ2xpZW50KCk6IFByb21pc2U8dm9pZD4ge1xuICBpZiAocmVkaXNDbGllbnQpIHtcbiAgICBsb2dnZXIuaW5mbygnQ2xvc2luZyBSZWRpcyBjb25uZWN0aW9uJylcbiAgICBhd2FpdCByZWRpc0NsaWVudC5xdWl0KClcbiAgICByZWRpc0NsaWVudCA9IG51bGxcbiAgfVxufVxuXG4vLyBHcmFjZWZ1bCBzaHV0ZG93blxuaWYgKHR5cGVvZiB3aW5kb3cgPT09ICd1bmRlZmluZWQnKSB7XG4gIHByb2Nlc3Mub24oJ1NJR1RFUk0nLCBhc3luYyAoKSA9PiB7XG4gICAgYXdhaXQgY2xvc2VSZWRpc0NsaWVudCgpXG4gIH0pXG4gIFxuICBwcm9jZXNzLm9uKCdTSUdJTlQnLCBhc3luYyAoKSA9PiB7XG4gICAgYXdhaXQgY2xvc2VSZWRpc0NsaWVudCgpXG4gIH0pXG59Il0sIm5hbWVzIjpbIlJlZGlzIiwiU3RydWN0dXJlZExvZ2dlciIsImpzb25UcmFuc3BvcnQiLCJwcmV0dHlUcmFuc3BvcnQiLCJDaXJjdWl0QnJlYWtlciIsInNlY3JldHNNYW5hZ2VyIiwidGhlbiIsIm1vZCIsImNvbmZpZyIsImxvZ2dlciIsInByb2Nlc3MiLCJyZWRpc0NsaWVudCIsImNpcmN1aXRCcmVha2VyIiwiZ2V0UmVkaXNDb25maWciLCJpbml0aWFsaXplIiwic2VjcmV0cyIsImdldEFsbFNlY3JldHMiLCJlbnYiLCJSRURJU19VUkwiLCJ1cmwiLCJob3N0IiwiUkVESVNfSE9TVCIsInBvcnQiLCJwYXJzZUludCIsIlJFRElTX1BPUlQiLCJyZWRpc1Bhc3N3b3JkIiwicGFzc3dvcmQiLCJyZWRpc1VzZXJuYW1lIiwidXNlcm5hbWUiLCJSRURJU19UTFNfRU5BQkxFRCIsInRscyIsInJlamVjdFVuYXV0aG9yaXplZCIsIlJFRElTX1RMU19SRUpFQ1RfVU5BVVRIT1JJWkVEIiwicmVkaXNUbHNDYSIsImNhIiwicmVkaXNUbHNDZXJ0IiwiY2VydCIsInJlZGlzVGxzS2V5Iiwia2V5IiwiUkVESVNfVExTX1NFUlZFUk5BTUUiLCJzZXJ2ZXJuYW1lIiwibWF4UmV0cmllc1BlclJlcXVlc3QiLCJlbmFibGVSZWFkeUNoZWNrIiwicmV0cnlTdHJhdGVneSIsInRpbWVzIiwiZXJyb3IiLCJkZWxheSIsIk1hdGgiLCJtaW4iLCJ3YXJuIiwiYXR0ZW1wdCIsImluaXRpYWxpemVDaXJjdWl0QnJlYWtlciIsIm5hbWUiLCJmYWlsdXJlVGhyZXNob2xkIiwiUkVESVNfQ0lSQ1VJVF9GQUlMVVJFX1RIUkVTSE9MRCIsInJlc2V0VGltZW91dCIsIlJFRElTX0NJUkNVSVRfUkVTRVRfVElNRU9VVCIsImhhbGZPcGVuUmVxdWVzdHMiLCJSRURJU19DSVJDVUlUX0hBTEZfT1BFTl9SRVFVRVNUUyIsIm9uU3RhdGVDaGFuZ2UiLCJvbGRTdGF0ZSIsIm5ld1N0YXRlIiwiZ2V0UmVkaXNDbGllbnQiLCJzdGF0dXMiLCJicmVha2VyIiwiZXhlY3V0ZSIsImluZm8iLCJvbiIsImVyciIsInBpbmciLCJnZXRSZWRpc0NpcmN1aXRCcmVha2VyIiwiY2xvc2VSZWRpc0NsaWVudCIsInF1aXQiXSwiaWdub3JlTGlzdCI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./src/server/services/redisClient.ts\n");

/***/ }),

/***/ "(rsc)/./src/server/services/secretsManager.ts":
/*!***********************************************!*\
  !*** ./src/server/services/secretsManager.ts ***!
  \***********************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   secretsManager: () => (/* binding */ secretsManager)\n/* harmony export */ });\n/* harmony import */ var fs_promises__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! fs/promises */ \"fs/promises\");\n/* harmony import */ var fs_promises__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(fs_promises__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var path__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! path */ \"path\");\n/* harmony import */ var path__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(path__WEBPACK_IMPORTED_MODULE_1__);\n/* harmony import */ var crypto__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! crypto */ \"crypto\");\n/* harmony import */ var crypto__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(crypto__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var _lib_cache_observability__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../lib/cache/observability */ \"(rsc)/./src/lib/cache/observability/index.ts\");\n// Secrets Manager for Redis and other sensitive credentials\n// Supports multiple secret sources: environment variables, files, and external services\n\n\n\n\nconst logger = new _lib_cache_observability__WEBPACK_IMPORTED_MODULE_3__.StructuredLogger('secrets-manager', {},  false ? 0 : _lib_cache_observability__WEBPACK_IMPORTED_MODULE_3__.prettyTransport);\nclass SecretsManager {\n    constructor(){\n        this.cache = new Map();\n        this.secretsPath = process.env.SECRETS_PATH || path__WEBPACK_IMPORTED_MODULE_1__.join(process.cwd(), '.secrets');\n        // Initialize encryption key from environment or generate one\n        if (process.env.SECRETS_ENCRYPTION_KEY) {\n            this.encryptionKey = Buffer.from(process.env.SECRETS_ENCRYPTION_KEY, 'hex');\n        }\n    }\n    async initialize() {\n        // Create secrets directory if it doesn't exist\n        try {\n            await fs_promises__WEBPACK_IMPORTED_MODULE_0__.mkdir(this.secretsPath, {\n                recursive: true,\n                mode: 448\n            });\n        } catch (error) {\n            logger.error('Failed to create secrets directory', error);\n        }\n    }\n    // Get secret from various sources\n    async getSecret(name, config) {\n        const cacheKey = `${config.source}:${name}`;\n        // Check cache first\n        if (this.cache.has(cacheKey)) {\n            return this.cache.get(cacheKey);\n        }\n        let secret;\n        switch(config.source){\n            case 'env':\n                secret = process.env[config.key || name];\n                break;\n            case 'file':\n                secret = await this.readSecretFromFile(config.path || name);\n                break;\n            case 'vault':\n                secret = await this.readFromHashicorpVault(name, config);\n                break;\n            case 'aws-secrets-manager':\n                secret = await this.readFromAWSSecretsManager(name, config);\n                break;\n            case 'gcp-secret-manager':\n                secret = await this.readFromGCPSecretManager(name, config);\n                break;\n        }\n        // Decrypt if needed\n        if (secret && config.decrypt && this.encryptionKey) {\n            secret = this.decrypt(secret);\n        }\n        // Cache the secret\n        if (secret) {\n            this.cache.set(cacheKey, secret);\n        }\n        return secret;\n    }\n    // Read secret from file\n    async readSecretFromFile(filename) {\n        try {\n            const filePath = path__WEBPACK_IMPORTED_MODULE_1__.isAbsolute(filename) ? filename : path__WEBPACK_IMPORTED_MODULE_1__.join(this.secretsPath, filename);\n            const content = await fs_promises__WEBPACK_IMPORTED_MODULE_0__.readFile(filePath, 'utf8');\n            return content.trim();\n        } catch (error) {\n            if (error.code !== 'ENOENT') {\n                logger.error(`Failed to read secret from file: ${filename}`, error);\n            }\n            return undefined;\n        }\n    }\n    // Placeholder for HashiCorp Vault integration\n    async readFromHashicorpVault(name, config) {\n        // Implementation would require vault client library\n        logger.warn('HashiCorp Vault integration not implemented', {\n            name\n        });\n        return undefined;\n    }\n    // Placeholder for AWS Secrets Manager integration\n    async readFromAWSSecretsManager(name, config) {\n        // Implementation would require AWS SDK\n        logger.warn('AWS Secrets Manager integration not implemented', {\n            name\n        });\n        return undefined;\n    }\n    // Placeholder for GCP Secret Manager integration\n    async readFromGCPSecretManager(name, config) {\n        // Implementation would require GCP client library\n        logger.warn('GCP Secret Manager integration not implemented', {\n            name\n        });\n        return undefined;\n    }\n    // Get all secrets with fallback to environment variables\n    async getAllSecrets() {\n        const secrets = {};\n        // Redis credentials\n        secrets.redisPassword = await this.getSecret('REDIS_PASSWORD', {\n            source: process.env.SECRETS_SOURCE || 'env',\n            key: 'REDIS_PASSWORD'\n        }) || process.env.REDIS_PASSWORD;\n        secrets.redisUsername = await this.getSecret('REDIS_USERNAME', {\n            source: process.env.SECRETS_SOURCE || 'env',\n            key: 'REDIS_USERNAME'\n        }) || process.env.REDIS_USERNAME || 'airport-app';\n        // TLS certificates\n        if (process.env.REDIS_TLS_ENABLED === 'true') {\n            secrets.redisTlsCa = await this.getSecret('REDIS_TLS_CA', {\n                source: 'file',\n                path: process.env.REDIS_TLS_CA || 'redis/tls/ca.crt'\n            });\n            secrets.redisTlsCert = await this.getSecret('REDIS_TLS_CERT', {\n                source: 'file',\n                path: process.env.REDIS_TLS_CERT || 'redis/tls/client.crt'\n            });\n            secrets.redisTlsKey = await this.getSecret('REDIS_TLS_KEY', {\n                source: 'file',\n                path: process.env.REDIS_TLS_KEY || 'redis/tls/client.key'\n            });\n        }\n        // API keys\n        secrets.apiNinjasKey = await this.getSecret('VITE_API_NINJAS_API_KEY', {\n            source: process.env.SECRETS_SOURCE || 'env',\n            key: 'VITE_API_NINJAS_API_KEY'\n        });\n        secrets.openSkyUsername = await this.getSecret('VITE_OPENSKY_USERNAME', {\n            source: process.env.SECRETS_SOURCE || 'env',\n            key: 'VITE_OPENSKY_USERNAME'\n        });\n        secrets.openSkyPassword = await this.getSecret('VITE_OPENSKY_PASSWORD', {\n            source: process.env.SECRETS_SOURCE || 'env',\n            key: 'VITE_OPENSKY_PASSWORD'\n        });\n        return secrets;\n    }\n    // Generate secure random password\n    generatePassword(length = 32) {\n        const charset = 'abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789!@#$%^&*()_+-=';\n        const randomBytes = crypto__WEBPACK_IMPORTED_MODULE_2__.randomBytes(length);\n        let password = '';\n        for(let i = 0; i < length; i++){\n            password += charset[randomBytes[i] % charset.length];\n        }\n        return password;\n    }\n    // Save secret to file (for development/setup)\n    async saveSecret(name, value, encrypt = false) {\n        const filePath = path__WEBPACK_IMPORTED_MODULE_1__.join(this.secretsPath, name);\n        let content = value;\n        if (encrypt && this.encryptionKey) {\n            content = this.encrypt(value);\n        }\n        await fs_promises__WEBPACK_IMPORTED_MODULE_0__.writeFile(filePath, content, {\n            mode: 384\n        });\n        logger.info(`Secret saved: ${name}`);\n    }\n    // Simple encryption for at-rest protection\n    encrypt(text) {\n        if (!this.encryptionKey) {\n            throw new Error('Encryption key not configured');\n        }\n        const iv = crypto__WEBPACK_IMPORTED_MODULE_2__.randomBytes(16);\n        const cipher = crypto__WEBPACK_IMPORTED_MODULE_2__.createCipheriv('aes-256-gcm', this.encryptionKey, iv);\n        let encrypted = cipher.update(text, 'utf8', 'hex');\n        encrypted += cipher.final('hex');\n        const authTag = cipher.getAuthTag();\n        return iv.toString('hex') + ':' + authTag.toString('hex') + ':' + encrypted;\n    }\n    // Decrypt encrypted secrets\n    decrypt(encryptedText) {\n        if (!this.encryptionKey) {\n            throw new Error('Encryption key not configured');\n        }\n        const parts = encryptedText.split(':');\n        if (parts.length !== 3) {\n            throw new Error('Invalid encrypted format');\n        }\n        const iv = Buffer.from(parts[0], 'hex');\n        const authTag = Buffer.from(parts[1], 'hex');\n        const encrypted = parts[2];\n        const decipher = crypto__WEBPACK_IMPORTED_MODULE_2__.createDecipheriv('aes-256-gcm', this.encryptionKey, iv);\n        decipher.setAuthTag(authTag);\n        let decrypted = decipher.update(encrypted, 'hex', 'utf8');\n        decrypted += decipher.final('utf8');\n        return decrypted;\n    }\n    // Clear cached secrets\n    clearCache() {\n        this.cache.clear();\n        logger.info('Secrets cache cleared');\n    }\n    // Rotate encryption key\n    async rotateEncryptionKey(newKey) {\n        const oldKey = this.encryptionKey;\n        this.encryptionKey = newKey;\n        // Re-encrypt all file-based secrets\n        const files = await fs_promises__WEBPACK_IMPORTED_MODULE_0__.readdir(this.secretsPath);\n        for (const file of files){\n            if (file.startsWith('.')) continue;\n            try {\n                const filePath = path__WEBPACK_IMPORTED_MODULE_1__.join(this.secretsPath, file);\n                const content = await fs_promises__WEBPACK_IMPORTED_MODULE_0__.readFile(filePath, 'utf8');\n                // Try to decrypt with old key\n                if (oldKey) {\n                    this.encryptionKey = oldKey;\n                    const decrypted = this.decrypt(content);\n                    // Re-encrypt with new key\n                    this.encryptionKey = newKey;\n                    const encrypted = this.encrypt(decrypted);\n                    await fs_promises__WEBPACK_IMPORTED_MODULE_0__.writeFile(filePath, encrypted, {\n                        mode: 384\n                    });\n                }\n            } catch (error) {\n                logger.error(`Failed to rotate key for ${file}`, error);\n            }\n        }\n        logger.info('Encryption key rotated successfully');\n    }\n}\n// Export singleton instance\nconst secretsManager = new SecretsManager();\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9zcmMvc2VydmVyL3NlcnZpY2VzL3NlY3JldHNNYW5hZ2VyLnRzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7O0FBQUEsNERBQTREO0FBQzVELHdGQUF3RjtBQUV2RDtBQUNMO0FBQ0k7QUFDZ0U7QUFFaEcsTUFBTU0sU0FBUyxJQUFJSCxzRUFBZ0JBLENBQ2pDLG1CQUNBLENBQUMsR0FDREksTUFBcUMsR0FBR0gsQ0FBYUEsR0FBR0MscUVBQWVBO0FBc0J6RSxNQUFNRztJQUtKQyxhQUFjO2FBSk5DLFFBQTZCLElBQUlDO1FBS3ZDLElBQUksQ0FBQ0MsV0FBVyxHQUFHTCxRQUFRTSxHQUFHLENBQUNDLFlBQVksSUFBSWIsc0NBQVMsQ0FBQ00sUUFBUVMsR0FBRyxJQUFJO1FBRXhFLDZEQUE2RDtRQUM3RCxJQUFJVCxRQUFRTSxHQUFHLENBQUNJLHNCQUFzQixFQUFFO1lBQ3RDLElBQUksQ0FBQ0MsYUFBYSxHQUFHQyxPQUFPQyxJQUFJLENBQUNiLFFBQVFNLEdBQUcsQ0FBQ0ksc0JBQXNCLEVBQUU7UUFDdkU7SUFDRjtJQUVBLE1BQU1JLGFBQTRCO1FBQ2hDLCtDQUErQztRQUMvQyxJQUFJO1lBQ0YsTUFBTXJCLDhDQUFRLENBQUMsSUFBSSxDQUFDWSxXQUFXLEVBQUU7Z0JBQUVXLFdBQVc7Z0JBQU1DLE1BQU07WUFBTTtRQUNsRSxFQUFFLE9BQU9DLE9BQU87WUFDZG5CLE9BQU9tQixLQUFLLENBQUMsc0NBQXNDQTtRQUNyRDtJQUNGO0lBRUEsa0NBQWtDO0lBQ2xDLE1BQU1DLFVBQVVDLElBQVksRUFBRUMsTUFBb0IsRUFBK0I7UUFDL0UsTUFBTUMsV0FBVyxHQUFHRCxPQUFPRSxNQUFNLENBQUMsQ0FBQyxFQUFFSCxNQUFNO1FBRTNDLG9CQUFvQjtRQUNwQixJQUFJLElBQUksQ0FBQ2pCLEtBQUssQ0FBQ3FCLEdBQUcsQ0FBQ0YsV0FBVztZQUM1QixPQUFPLElBQUksQ0FBQ25CLEtBQUssQ0FBQ3NCLEdBQUcsQ0FBQ0g7UUFDeEI7UUFFQSxJQUFJ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R2lGO29CQUNyQixNQUFNaEIsWUFBWSxJQUFJLENBQUNSLE9BQU8sQ0FBQ29CO29CQUUvQixNQUFNL0Ysa0RBQVksQ0FBQzBDLFVBQVV5QyxXQUFXO3dCQUFFM0QsTUFBTTtvQkFBTTtnQkFDeEQ7WUFDRixFQUFFLE9BQU9DLE9BQU87Z0JBQ2RuQixPQUFPbUIsS0FBSyxDQUFDLENBQUMseUJBQXlCLEVBQUU4RSxNQUFNLEVBQUU5RTtZQUNuRDtRQUNGO1FBRUFuQixPQUFPdUUsSUFBSSxDQUFDO0lBQ2Q7QUFDRjtBQUVBLDRCQUE0QjtBQUNyQixNQUFNNEIsaUJBQWlCLElBQUlqRyxpQkFBZ0IiLCJzb3VyY2VzIjpbIi9Vc2Vycy9ydWJlZW4vZGV2L3BlcnNvbmFsL2FpcnBvcnQtZGIvc3JjL3NlcnZlci9zZXJ2aWNlcy9zZWNyZXRzTWFuYWdlci50cyJdLCJzb3VyY2VzQ29udGVudCI6WyIvLyBTZWNyZXRzIE1hbmFnZXIgZm9yIFJlZGlzIGFuZCBvdGhlciBzZW5zaXRpdmUgY3JlZGVudGlhbHNcbi8vIFN1cHBvcnRzIG11bHRpcGxlIHNlY3JldCBzb3VyY2VzOiBlbnZpcm9ubWVudCB2YXJpYWJsZXMsIGZpbGVzLCBhbmQgZXh0ZXJuYWwgc2VydmljZXNcblxuaW1wb3J0ICogYXMgZnMgZnJvbSAnZnMvcHJvbWlzZXMnXG5pbXBvcnQgKiBhcyBwYXRoIGZyb20gJ3BhdGgnXG5pbXBvcnQgKiBhcyBjcnlwdG8gZnJvbSAnY3J5cHRvJ1xuaW1wb3J0IHsgU3RydWN0dXJlZExvZ2dlciwganNvblRyYW5zcG9ydCwgcHJldHR5VHJhbnNwb3J0IH0gZnJvbSAnLi4vLi4vbGliL2NhY2hlL29ic2VydmFiaWxpdHknXG5cbmNvbnN0IGxvZ2dlciA9IG5ldyBTdHJ1Y3R1cmVkTG9nZ2VyKFxuICAnc2VjcmV0cy1tYW5hZ2VyJyxcbiAge30sXG4gIHByb2Nlc3MuZW52Lk5PREVfRU5WID09PSAncHJvZHVjdGlvbicgPyBqc29uVHJhbnNwb3J0IDogcHJldHR5VHJhbnNwb3J0XG4pXG5cbmV4cG9ydCBpbnRlcmZhY2UgU2VjcmV0Q29uZmlnIHtcbiAgc291cmNlOiAnZW52JyB8ICdmaWxlJyB8ICd2YXVsdCcgfCAnYXdzLXNlY3JldHMtbWFuYWdlcicgfCAnZ2NwLXNlY3JldC1tYW5hZ2VyJ1xuICBwYXRoPzogc3RyaW5nXG4gIGtleT86IHN0cmluZ1xuICBlbmNvZGluZz86IEJ1ZmZlckVuY29kaW5nXG4gIGRlY3J5cHQ/OiBib29sZWFuXG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgU2VjcmV0cyB7XG4gIHJlZGlzUGFzc3dvcmQ/OiBzdHJpbmdcbiAgcmVkaXNVc2VybmFtZT86IHN0cmluZ1xuICByZWRpc1Rsc0NhPzogc3RyaW5nXG4gIHJlZGlzVGxzQ2VydD86IHN0cmluZ1xuICByZWRpc1Rsc0tleT86IHN0cmluZ1xuICBhcGlOaW5qYXNLZXk/OiBzdHJpbmdcbiAgb3BlblNreVVzZXJuYW1lPzogc3RyaW5nXG4gIG9wZW5Ta3lQYXNzd29yZD86IHN0cmluZ1xufVxuXG5jbGFzcyBTZWNyZXRzTWFuYWdlciB7XG4gIHByaXZhdGUgY2FjaGU6IE1hcDxzdHJpbmcsIHN0cmluZz4gPSBuZXcgTWFwKClcbiAgcHJpdmF0ZSBzZWNyZXRzUGF0aDogc3RyaW5nXG4gIHByaXZhdGUgZW5jcnlwdGlvbktleT86IEJ1ZmZlclxuXG4gIGNvbnN0cnVjdG9yKCkge1xuICAgIHRoaXMuc2VjcmV0c1BhdGggPSBwcm9jZXNzLmVudi5TRUNSRVRTX1BBVEggfHwgcGF0aC5qb2luKHByb2Nlc3MuY3dkKCksICcuc2VjcmV0cycpXG4gICAgXG4gICAgLy8gSW5pdGlhbGl6ZSBlbmNyeXB0aW9uIGtleSBmcm9tIGVudmlyb25tZW50IG9yIGdlbmVyYXRlIG9uZVxuICAgIGlmIChwcm9jZXNzLmVudi5TRUNSRVRTX0VOQ1JZUFRJT05fS0VZKSB7XG4gICAgICB0aGlzLmVuY3J5cHRpb25LZXkgPSBCdWZmZXIuZnJvbShwcm9jZXNzLmVudi5TRUNSRVRTX0VOQ1JZUFRJT05fS0VZLCAnaGV4JylcbiAgICB9XG4gIH1cblxuICBhc3luYyBpbml0aWFsaXplKCk6IFByb21pc2U8dm9pZD4ge1xuICAgIC8vIENyZWF0ZSBzZWNyZXRzIGRpcmVjdG9yeSBpZiBpdCBkb2Vzbid0IGV4aXN0XG4gICAgdHJ5IHtcbiAgICAgIGF3YWl0IGZzLm1rZGlyKHRoaXMuc2VjcmV0c1BhdGgsIHsgcmVjdXJzaXZlOiB0cnVlLCBtb2RlOiAwbzcwMCB9KVxuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBsb2dnZXIuZXJyb3IoJ0ZhaWxlZCB0byBjcmVhdGUgc2VjcmV0cyBkaXJlY3RvcnknLCBlcnJvciBhcyBFcnJvcilcbiAgICB9XG4gIH1cblxuICAvLyBHZXQgc2VjcmV0IGZyb20gdmFyaW91cyBzb3VyY2VzXG4gIGFzeW5jIGdldFNlY3JldChuYW1lOiBzdHJpbmcsIGNvbmZpZzogU2VjcmV0Q29uZmlnKTogUHJvbWlzZTxzdHJpbmcgfCB1bmRlZmluZWQ+IHtcbiAgICBjb25zdCBjYWNoZUtleSA9IGAke2NvbmZpZy5zb3VyY2V9OiR7bmFtZX1gXG4gICAgXG4gICAgLy8gQ2hlY2sgY2FjaGUgZmlyc3RcbiAgICBpZiAodGhpcy5jYWNoZS5oYXMoY2FjaGVLZXkpKSB7XG4gICAgICByZXR1cm4gdGhpcy5jYWNoZS5nZXQoY2FjaGVLZXkpXG4gICAgfVxuXG4gICAgbGV0IHNlY3JldDogc3RyaW5nIHwgdW5kZWZpbmVkXG5cbiAgICBzd2l0Y2ggKGNvbmZpZy5zb3VyY2UpIHtcbiAgICAgIGNhc2UgJ2Vudic6XG4gICAgICAgIHNlY3JldCA9IHByb2Nlc3MuZW52W2NvbmZpZy5rZXkgfHwgbmFtZV1cbiAgICAgICAgYnJlYWtcblxuICAgICAgY2FzZSAnZmlsZSc6XG4gICAgICAgIHNlY3JldCA9IGF3YWl0IHRoaXMucmVhZFNlY3JldEZyb21GaWxlKGNvbmZpZy5wYXRoIHx8IG5hbWUpXG4gICAgICAgIGJyZWFrXG5cbiAgICAgIGNhc2UgJ3ZhdWx0JzpcbiAgICAgICAgc2VjcmV0ID0gYXdhaXQgdGhpcy5yZWFkRnJvbUhhc2hpY29ycFZhdWx0KG5hbWUsIGNvbmZpZylcbiAgICAgICAgYnJlYWtcblxuICAgICAgY2FzZSAnYXdzLXNlY3JldHMtbWFuYWdlcic6XG4gICAgICAgIHNlY3JldCA9IGF3YWl0IHRoaXMucmVhZEZyb21BV1NTZWNyZXRzTWFuYWdlcihuYW1lLCBjb25maWcpXG4gICAgICAgIGJyZWFrXG5cbiAgICAgIGNhc2UgJ2djcC1zZWNyZXQtbWFuYWdlcic6XG4gICAgICAgIHNlY3JldCA9IGF3YWl0IHRoaXMucmVhZEZyb21HQ1BTZWNyZXRNYW5hZ2VyKG5hbWUsIGNvbmZpZylcbiAgICAgICAgYnJlYWtcbiAgICB9XG5cbiAgICAvLyBEZWNyeXB0IGlmIG5lZWRlZFxuICAgIGlmIChzZWNyZXQgJiYgY29uZmlnLmRlY3J5cHQgJiYgdGhpcy5lbmNyeXB0aW9uS2V5KSB7XG4gICAgICBzZWNyZXQgPSB0aGlzLmRlY3J5cHQoc2VjcmV0KVxuICAgIH1cblxuICAgIC8vIENhY2hlIHRoZSBzZWNyZXRcbiAgICBpZiAoc2VjcmV0KSB7XG4gICAgICB0aGlzLmNhY2hlLnNldChjYWNoZUtleSwgc2VjcmV0KVxuICAgIH1cblxuICAgIHJldHVybiBzZWNyZXRcbiAgfVxuXG4gIC8vIFJlYWQgc2VjcmV0IGZyb20gZmlsZVxuICBwcml2YXRlIGFzeW5jIHJlYWRTZWNyZXRGcm9tRmlsZShmaWxlbmFtZTogc3RyaW5nKTogUHJvbWlzZTxzdHJpbmcgfCB1bmRlZmluZWQ+IHtcbiAgICB0cnkge1xuICAgICAgY29uc3QgZmlsZVBhdGggPSBwYXRoLmlzQWJzb2x1dGUoZmlsZW5hbWUpIFxuICAgICAgICA/IGZpbGVuYW1lIFxuICAgICAgICA6IHBhdGguam9pbih0aGlzLnNlY3JldHNQYXRoLCBmaWxlbmFtZSlcbiAgICAgIFxuICAgICAgY29uc3QgY29udGVudCA9IGF3YWl0IGZzLnJlYWRGaWxlKGZpbGVQYXRoLCAndXRmOCcpXG4gICAgICByZXR1cm4gY29udGVudC50cmltKClcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgaWYgKChlcnJvciBhcyBhbnkpLmNvZGUgIT09ICdFTk9FTlQnKSB7XG4gICAgICAgIGxvZ2dlci5lcnJvcihgRmFpbGVkIHRvIHJlYWQgc2VjcmV0IGZyb20gZmlsZTogJHtmaWxlbmFtZX1gLCBlcnJvciBhcyBFcnJvcilcbiAgICAgIH1cbiAgICAgIHJldHVybiB1bmRlZmluZWRcbiAgICB9XG4gIH1cblxuICAvLyBQbGFjZWhvbGRlciBmb3IgSGFzaGlDb3JwIFZhdWx0IGludGVncmF0aW9uXG4gIHByaXZhdGUgYXN5bmMgcmVhZEZyb21IYXNoaWNvcnBWYXVsdChuYW1lOiBzdHJpbmcsIGNvbmZpZzogU2VjcmV0Q29uZmlnKTogUHJvbWlzZTxzdHJpbmcgfCB1bmRlZmluZWQ+IHtcbiAgICAvLyBJbXBsZW1lbnRhdGlvbiB3b3VsZCByZXF1aXJlIHZhdWx0IGNsaWVudCBsaWJyYXJ5XG4gICAgbG9nZ2VyLndhcm4oJ0hhc2hpQ29ycCBWYXVsdCBpbnRlZ3JhdGlvbiBub3QgaW1wbGVtZW50ZWQnLCB7IG5hbWUgfSlcbiAgICByZXR1cm4gdW5kZWZpbmVkXG4gIH1cblxuICAvLyBQbGFjZWhvbGRlciBmb3IgQVdTIFNlY3JldHMgTWFuYWdlciBpbnRlZ3JhdGlvblxuICBwcml2YXRlIGFzeW5jIHJlYWRGcm9tQVdTU2VjcmV0c01hbmFnZXIobmFtZTogc3RyaW5nLCBjb25maWc6IFNlY3JldENvbmZpZyk6IFByb21pc2U8c3RyaW5nIHwgdW5kZWZpbmVkPiB7XG4gICAgLy8gSW1wbGVtZW50YXRpb24gd291bGQgcmVxdWlyZSBBV1MgU0RLXG4gICAgbG9nZ2VyLndhcm4oJ0FXUyBTZWNyZXRzIE1hbmFnZXIgaW50ZWdyYXRpb24gbm90IGltcGxlbWVudGVkJywgeyBuYW1lIH0pXG4gICAgcmV0dXJuIHVuZGVmaW5lZFxuICB9XG5cbiAgLy8gUGxhY2Vob2xkZXIgZm9yIEdDUCBTZWNyZXQgTWFuYWdlciBpbnRlZ3JhdGlvblxuICBwcml2YXRlIGFzeW5jIHJlYWRGcm9tR0NQU2VjcmV0TWFuYWdlcihuYW1lOiBzdHJpbmcsIGNvbmZpZzogU2VjcmV0Q29uZmlnKTogUHJvbWlzZTxzdHJpbmcgfCB1bmRlZmluZWQ+IHtcbiAgICAvLyBJbXBsZW1lbnRhdGlvbiB3b3VsZCByZXF1aXJlIEdDUCBjbGllbnQgbGlicmFyeVxuICAgIGxvZ2dlci53YXJuKCdHQ1AgU2VjcmV0IE1hbmFnZXIgaW50ZWdyYXRpb24gbm90IGltcGxlbWVudGVkJywgeyBuYW1lIH0pXG4gICAgcmV0dXJuIHVuZGVmaW5lZFxuICB9XG5cbiAgLy8gR2V0IGFsbCBzZWNyZXRzIHdpdGggZmFsbGJhY2sgdG8gZW52aXJvbm1lbnQgdmFyaWFibGVzXG4gIGFzeW5jIGdldEFsbFNlY3JldHMoKTogUHJvbWlzZTxTZWNyZXRzPiB7XG4gICAgY29uc3Qgc2VjcmV0czogU2VjcmV0cyA9IHt9XG5cbiAgICAvLyBSZWRpcyBjcmVkZW50aWFsc1xuICAgIHNlY3JldHMucmVkaXNQYXNzd29yZCA9IGF3YWl0IHRoaXMuZ2V0U2VjcmV0KCdSRURJU19QQVNTV09SRCcsIHtcbiAgICAgIHNvdXJjZTogcHJvY2Vzcy5lbnYuU0VDUkVUU19TT1VSQ0UgYXMgYW55IHx8ICdlbnYnLFxuICAgICAga2V5OiAnUkVESVNfUEFTU1dPUkQnXG4gICAgfSkgfHwgcHJvY2Vzcy5lbnYuUkVESVNfUEFTU1dPUkRcblxuICAgIHNlY3JldHMucmVkaXNVc2VybmFtZSA9IGF3YWl0IHRoaXMuZ2V0U2VjcmV0KCdSRURJU19VU0VSTkFNRScsIHtcbiAgICAgIHNvdXJjZTogcHJvY2Vzcy5lbnYuU0VDUkVUU19TT1VSQ0UgYXMgYW55IHx8ICdlbnYnLFxuICAgICAga2V5OiAnUkVESVNfVVNFUk5BTUUnXG4gICAgfSkgfHwgcHJvY2Vzcy5lbnYuUkVESVNfVVNFUk5BTUUgfHwgJ2FpcnBvcnQtYXBwJ1xuXG4gICAgLy8gVExTIGNlcnRpZmljYXRlc1xuICAgIGlmIChwcm9jZXNzLmVudi5SRURJU19UTFNfRU5BQkxFRCA9PT0gJ3RydWUnKSB7XG4gICAgICBzZWNyZXRzLnJlZGlzVGxzQ2EgPSBhd2FpdCB0aGlzLmdldFNlY3JldCgnUkVESVNfVExTX0NBJywge1xuICAgICAgICBzb3VyY2U6ICdmaWxlJyxcbiAgICAgICAgcGF0aDogcHJvY2Vzcy5lbnYuUkVESVNfVExTX0NBIHx8ICdyZWRpcy90bHMvY2EuY3J0J1xuICAgICAgfSlcblxuICAgICAgc2VjcmV0cy5yZWRpc1Rsc0NlcnQgPSBhd2FpdCB0aGlzLmdldFNlY3JldCgnUkVESVNfVExTX0NFUlQnLCB7XG4gICAgICAgIHNvdXJjZTogJ2ZpbGUnLFxuICAgICAgICBwYXRoOiBwcm9jZXNzLmVudi5SRURJU19UTFNfQ0VSVCB8fCAncmVkaXMvdGxzL2NsaWVudC5jcnQnXG4gICAgICB9KVxuXG4gICAgICBzZWNyZXRzLnJlZGlzVGxzS2V5ID0gYXdhaXQgdGhpcy5nZXRTZWNyZXQoJ1JFRElTX1RMU19LRVknLCB7XG4gICAgICAgIHNvdXJjZTogJ2ZpbGUnLFxuICAgICAgICBwYXRoOiBwcm9jZXNzLmVudi5SRURJU19UTFNfS0VZIHx8ICdyZWRpcy90bHMvY2xpZW50LmtleSdcbiAgICAgIH0pXG4gICAgfVxuXG4gICAgLy8gQVBJIGtleXNcbiAgICBzZWNyZXRzLmFwaU5pbmphc0tleSA9IGF3YWl0IHRoaXMuZ2V0U2VjcmV0KCdWSVRFX0FQSV9OSU5KQVNfQVBJX0tFWScsIHtcbiAgICAgIHNvdXJjZTogcHJvY2Vzcy5lbnYuU0VDUkVUU19TT1VSQ0UgYXMgYW55IHx8ICdlbnYnLFxuICAgICAga2V5OiAnVklURV9BUElfTklOSkFTX0FQSV9LRVknXG4gICAgfSlcblxuICAgIHNlY3JldHMub3BlblNreVVzZXJuYW1lID0gYXdhaXQgdGhpcy5nZXRTZWNyZXQoJ1ZJVEVfT1BFTlNLWV9VU0VSTkFNRScsIHtcbiAgICAgIHNvdXJjZTogcHJvY2Vzcy5lbnYuU0VDUkVUU19TT1VSQ0UgYXMgYW55IHx8ICdlbnYnLFxuICAgICAga2V5OiAnVklURV9PUEVOU0tZX1VTRVJOQU1FJ1xuICAgIH0pXG5cbiAgICBzZWNyZXRzLm9wZW5Ta3lQYXNzd29yZCA9IGF3YWl0IHRoaXMuZ2V0U2VjcmV0KCdWSVRFX09QRU5TS1lfUEFTU1dPUkQnLCB7XG4gICAgICBzb3VyY2U6IHByb2Nlc3MuZW52LlNFQ1JFVFNfU09VUkNFIGFzIGFueSB8fCAnZW52JyxcbiAgICAgIGtleTogJ1ZJVEVfT1BFTlNLWV9QQVNTV09SRCdcbiAgICB9KVxuXG4gICAgcmV0dXJuIHNlY3JldHNcbiAgfVxuXG4gIC8vIEdlbmVyYXRlIHNlY3VyZSByYW5kb20gcGFzc3dvcmRcbiAgZ2VuZXJhdGVQYXNzd29yZChsZW5ndGg6IG51bWJlciA9IDMyKTogc3RyaW5nIHtcbiAgICBjb25zdCBjaGFyc2V0ID0gJ2FiY2RlZmdoaWprbG1ub3BxcnN0dXZ3eHl6QUJDREVGR0hJSktMTU5PUFFSU1RVVldYWVowMTIzNDU2Nzg5IUAjJCVeJiooKV8rLT0nXG4gICAgY29uc3QgcmFuZG9tQnl0ZXMgPSBjcnlwdG8ucmFuZG9tQnl0ZXMobGVuZ3RoKVxuICAgIGxldCBwYXNzd29yZCA9ICcnXG4gICAgXG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCBsZW5ndGg7IGkrKykge1xuICAgICAgcGFzc3dvcmQgKz0gY2hhcnNldFtyYW5kb21CeXRlc1tpXSAlIGNoYXJzZXQubGVuZ3RoXVxuICAgIH1cbiAgICBcbiAgICByZXR1cm4gcGFzc3dvcmRcbiAgfVxuXG4gIC8vIFNhdmUgc2VjcmV0IHRvIGZpbGUgKGZvciBkZXZlbG9wbWVudC9zZXR1cClcbiAgYXN5bmMgc2F2ZVNlY3JldChuYW1lOiBzdHJpbmcsIHZhbHVlOiBzdHJpbmcsIGVuY3J5cHQ6IGJvb2xlYW4gPSBmYWxzZSk6IFByb21pc2U8dm9pZD4ge1xuICAgIGNvbnN0IGZpbGVQYXRoID0gcGF0aC5qb2luKHRoaXMuc2VjcmV0c1BhdGgsIG5hbWUpXG4gICAgXG4gICAgbGV0IGNvbnRlbnQgPSB2YWx1ZVxuICAgIGlmIChlbmNyeXB0ICYmIHRoaXMuZW5jcnlwdGlvbktleSkge1xuICAgICAgY29udGVudCA9IHRoaXMuZW5jcnlwdCh2YWx1ZSlcbiAgICB9XG5cbiAgICBhd2FpdCBmcy53cml0ZUZpbGUoZmlsZVBhdGgsIGNvbnRlbnQsIHsgbW9kZTogMG82MDAgfSlcbiAgICBsb2dnZXIuaW5mbyhgU2VjcmV0IHNhdmVkOiAke25hbWV9YClcbiAgfVxuXG4gIC8vIFNpbXBsZSBlbmNyeXB0aW9uIGZvciBhdC1yZXN0IHByb3RlY3Rpb25cbiAgcHJpdmF0ZSBlbmNyeXB0KHRleHQ6IHN0cmluZyk6IHN0cmluZyB7XG4gICAgaWYgKCF0aGlzLmVuY3J5cHRpb25LZXkpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcignRW5jcnlwdGlvbiBrZXkgbm90IGNvbmZpZ3VyZWQnKVxuICAgIH1cblxuICAgIGNvbnN0IGl2ID0gY3J5cHRvLnJhbmRvbUJ5dGVzKDE2KVxuICAgIGNvbnN0IGNpcGhlciA9IGNyeXB0by5jcmVhdGVDaXBoZXJpdignYWVzLTI1Ni1nY20nLCB0aGlzLmVuY3J5cHRpb25LZXksIGl2KVxuICAgIFxuICAgIGxldCBlbmNyeXB0ZWQgPSBjaXBoZXIudXBkYXRlKHRleHQsICd1dGY4JywgJ2hleCcpXG4gICAgZW5jcnlwdGVkICs9IGNpcGhlci5maW5hbCgnaGV4JylcbiAgICBcbiAgICBjb25zdCBhdXRoVGFnID0gY2lwaGVyLmdldEF1dGhUYWcoKVxuICAgIFxuICAgIHJldHVybiBpdi50b1N0cmluZygnaGV4JykgKyAnOicgKyBhdXRoVGFnLnRvU3RyaW5nKCdoZXgnKSArICc6JyArIGVuY3J5cHRlZFxuICB9XG5cbiAgLy8gRGVjcnlwdCBlbmNyeXB0ZWQgc2VjcmV0c1xuICBwcml2YXRlIGRlY3J5cHQoZW5jcnlwdGVkVGV4dDogc3RyaW5nKTogc3RyaW5nIHtcbiAgICBpZiAoIXRoaXMuZW5jcnlwdGlvbktleSkge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKCdFbmNyeXB0aW9uIGtleSBub3QgY29uZmlndXJlZCcpXG4gICAgfVxuXG4gICAgY29uc3QgcGFydHMgPSBlbmNyeXB0ZWRUZXh0LnNwbGl0KCc6JylcbiAgICBpZiAocGFydHMubGVuZ3RoICE9PSAzKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoJ0ludmFsaWQgZW5jcnlwdGVkIGZvcm1hdCcpXG4gICAgfVxuXG4gICAgY29uc3QgaXYgPSBCdWZmZXIuZnJvbShwYXJ0c1swXSwgJ2hleCcpXG4gICAgY29uc3QgYXV0aFRhZyA9IEJ1ZmZlci5mcm9tKHBhcnRzWzFdLCAnaGV4JylcbiAgICBjb25zdCBlbmNyeXB0ZWQgPSBwYXJ0c1syXVxuXG4gICAgY29uc3QgZGVjaXBoZXIgPSBjcnlwdG8uY3JlYXRlRGVjaXBoZXJpdignYWVzLTI1Ni1nY20nLCB0aGlzLmVuY3J5cHRpb25LZXksIGl2KVxuICAgIGRlY2lwaGVyLnNldEF1dGhUYWcoYXV0aFRhZylcblxuICAgIGxldCBkZWNyeXB0ZWQgPSBkZWNpcGhlci51cGRhdGUoZW5jcnlwdGVkLCAnaGV4JywgJ3V0ZjgnKVxuICAgIGRlY3J5cHRlZCArPSBkZWNpcGhlci5maW5hbCgndXRmOCcpXG5cbiAgICByZXR1cm4gZGVjcnlwdGVkXG4gIH1cblxuICAvLyBDbGVhciBjYWNoZWQgc2VjcmV0c1xuICBjbGVhckNhY2hlKCk6IHZvaWQge1xuICAgIHRoaXMuY2FjaGUuY2xlYXIoKVxuICAgIGxvZ2dlci5pbmZvKCdTZWNyZXRzIGNhY2hlIGNsZWFyZWQnKVxuICB9XG5cbiAgLy8gUm90YXRlIGVuY3J5cHRpb24ga2V5XG4gIGFzeW5jIHJvdGF0ZUVuY3J5cHRpb25LZXkobmV3S2V5OiBCdWZmZXIpOiBQcm9taXNlPHZvaWQ+IHtcbiAgICBjb25zdCBvbGRLZXkgPSB0aGlzLmVuY3J5cHRpb25LZXlcbiAgICB0aGlzLmVuY3J5cHRpb25LZXkgPSBuZXdLZXlcblxuICAgIC8vIFJlLWVuY3J5cHQgYWxsIGZpbGUtYmFzZWQgc2VjcmV0c1xuICAgIGNvbnN0IGZpbGVzID0gYXdhaXQgZnMucmVhZGRpcih0aGlzLnNlY3JldHNQYXRoKVxuICAgIFxuICAgIGZvciAoY29uc3QgZmlsZSBvZiBmaWxlcykge1xuICAgICAgaWYgKGZpbGUuc3RhcnRzV2l0aCgnLicpKSBjb250aW51ZVxuICAgICAgXG4gICAgICB0cnkge1xuICAgICAgICBjb25zdCBmaWxlUGF0aCA9IHBhdGguam9pbih0aGlzLnNlY3JldHNQYXRoLCBmaWxlKVxuICAgICAgICBjb25zdCBjb250ZW50ID0gYXdhaXQgZnMucmVhZEZpbGUoZmlsZVBhdGgsICd1dGY4JylcbiAgICAgICAgXG4gICAgICAgIC8vIFRyeSB0byBkZWNyeXB0IHdpdGggb2xkIGtleVxuICAgICAgICBpZiAob2xkS2V5KSB7XG4gICAgICAgICAgdGhpcy5lbmNyeXB0aW9uS2V5ID0gb2xkS2V5XG4gICAgICAgICAgY29uc3QgZGVjcnlwdGVkID0gdGhpcy5kZWNyeXB0KGNvbnRlbnQpXG4gICAgICAgICAgXG4gICAgICAgICAgLy8gUmUtZW5jcnlwdCB3aXRoIG5ldyBrZXlcbiAgICAgICAgICB0aGlzLmVuY3J5cHRpb25LZXkgPSBuZXdLZXlcbiAgICAgICAgICBjb25zdCBlbmNyeXB0ZWQgPSB0aGlzLmVuY3J5cHQoZGVjcnlwdGVkKVxuICAgICAgICAgIFxuICAgICAgICAgIGF3YWl0IGZzLndyaXRlRmlsZShmaWxlUGF0aCwgZW5jcnlwdGVkLCB7IG1vZGU6IDBvNjAwIH0pXG4gICAgICAgIH1cbiAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgIGxvZ2dlci5lcnJvcihgRmFpbGVkIHRvIHJvdGF0ZSBrZXkgZm9yICR7ZmlsZX1gLCBlcnJvciBhcyBFcnJvcilcbiAgICAgIH1cbiAgICB9XG5cbiAgICBsb2dnZXIuaW5mbygnRW5jcnlwdGlvbiBrZXkgcm90YXRlZCBzdWNjZXNzZnVsbHknKVxuICB9XG59XG5cbi8vIEV4cG9ydCBzaW5nbGV0b24gaW5zdGFuY2VcbmV4cG9ydCBjb25zdCBzZWNyZXRzTWFuYWdlciA9IG5ldyBTZWNyZXRzTWFuYWdlcigpIl0sIm5hbWVzIjpbImZzIiwicGF0aCIsImNyeXB0byIsIlN0cnVjdHVyZWRMb2dnZXIiLCJqc29uVHJhbnNwb3J0IiwicHJldHR5VHJhbnNwb3J0IiwibG9nZ2VyIiwicHJvY2VzcyIsIlNlY3JldHNNYW5hZ2VyIiwiY29uc3RydWN0b3IiLCJjYWNoZSIsIk1hcCIsInNlY3JldHNQYXRoIiwiZW52IiwiU0VDUkVUU19QQVRIIiwiam9pbiIsImN3ZCIsIlNFQ1JFVFNfRU5DUllQVElPTl9LRVkiLCJlbmNyeXB0aW9uS2V5IiwiQnVmZmVyIiwiZnJvbSIsImluaXRpYWxpemUiLCJta2RpciIsInJlY3Vyc2l2ZSIsIm1vZGUiLCJlcnJvciIsImdldFNlY3JldCIsIm5hbWUiLCJjb25maWciLCJjYWNoZUtleSIsInNvdXJjZSIsImhhcyIsImdldCIsInNlY3JldCIsImtleSIsInJlYWRTZWNyZXRGcm9tRmlsZSIsInJlYWRGcm9tSGFzaGljb3JwVmF1bHQiLCJyZWFkRnJvbUFXU1NlY3JldHNNYW5hZ2VyIiwicmVhZEZyb21HQ1BTZWNyZXRNYW5hZ2VyIiwiZGVjcnlwdCIsInNldCIsImZpbGVuYW1lIiwiZmlsZVBhdGgiLCJpc0Fic29sdXRlIiwiY29udGVudCIsInJlYWRGaWxlIiwidHJpbSIsImNvZGUiLCJ1bmRlZmluZWQiLCJ3YXJuIiwiZ2V0QWxsU2VjcmV0cyIsInNlY3JldHMiLCJyZWRpc1Bhc3N3b3JkIiwiU0VDUkVUU19TT1VSQ0UiLCJSRURJU19QQVNTV09SRCIsInJlZGlzVXNlcm5hbWUiLCJSRURJU19VU0VSTkFNRSIsIlJFRElTX1RMU19FTkFCTEVEIiwicmVkaXNUbHNDYSIsIlJFRElTX1RMU19DQSIsInJlZGlzVGxzQ2VydCIsIlJFRElTX1RMU19DRVJUIiwicmVkaXNUbHNLZXkiLCJSRURJU19UTFNfS0VZIiwiYXBpTmluamFzS2V5Iiwib3BlblNreVVzZXJuYW1lIiwib3BlblNreVBhc3N3b3JkIiwiZ2VuZXJhdGVQYXNzd29yZCIsImxlbmd0aCIsImNoYXJzZXQiLCJyYW5kb21CeXRlcyIsInBhc3N3b3JkIiwiaSIsInNhdmVTZWNyZXQiLCJ2YWx1ZSIsImVuY3J5cHQiLCJ3cml0ZUZpbGUiLCJpbmZvIiwidGV4dCIsIkVycm9yIiwiaXYiLCJjaXBoZXIiLCJjcmVhdGVDaXBoZXJpdiIsImVuY3J5cHRlZCIsInVwZGF0ZSIsImZpbmFsIiwiYXV0aFRhZyIsImdldEF1dGhUYWciLCJ0b1N0cmluZyIsImVuY3J5cHRlZFRleHQiLCJwYXJ0cyIsInNwbGl0IiwiZGVjaXBoZXIiLCJjcmVhdGVEZWNpcGhlcml2Iiwic2V0QXV0aFRhZyIsImRlY3J5cHRlZCIsImNsZWFyQ2FjaGUiLCJjbGVhciIsInJvdGF0ZUVuY3J5cHRpb25LZXkiLCJuZXdLZXkiLCJvbGRLZXkiLCJmaWxlcyIsInJlYWRkaXIiLCJmaWxlIiwic3RhcnRzV2l0aCIsInNlY3JldHNNYW5hZ2VyIl0sImlnbm9yZUxpc3QiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./src/server/services/secretsManager.ts\n");

/***/ })

};
;

// load runtime
var __webpack_require__ = require("../../../../webpack-runtime.js");
__webpack_require__.C(exports);
var __webpack_exec__ = (moduleId) => (__webpack_require__(__webpack_require__.s = moduleId))
var __webpack_exports__ = __webpack_require__.X(0, ["vendor-chunks/next@15.1.5_@babel+core@7.27.4_react-dom@19.1.0_react@19.1.0__react@19.1.0"], () => (__webpack_exec__("(rsc)/./node_modules/.pnpm/next@15.1.5_@babel+core@7.27.4_react-dom@19.1.0_react@19.1.0__react@19.1.0/node_modules/next/dist/build/webpack/loaders/next-app-loader/index.js?name=app%2Fapi%2Fairports%2F%5Bcode%5D%2Froute&page=%2Fapi%2Fairports%2F%5Bcode%5D%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fairports%2F%5Bcode%5D%2Froute.ts&appDir=%2FUsers%2Frubeen%2Fdev%2Fpersonal%2Fairport-db%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2FUsers%2Frubeen%2Fdev%2Fpersonal%2Fairport-db&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!")));
module.exports = __webpack_exports__;

})();