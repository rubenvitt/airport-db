import{r,j as e,f as _,B as u,X as I,R as L,p as A,q as E,C as b,h as S,i as y,l as T,m as C,L as D}from"./main-D3FOYopS.js";import{u as O,a as $,T as M}from"./useFlights-voAEGlpF.js";import{I as z}from"./input-Bman6Bvm.js";import{S as B}from"./search-BuBZSaYo.js";import{L as P,E as R,a as V}from"./config-B6oVgUCR.js";import{E as U}from"./EmptyState-BqxN_i0f.js";import{B as q}from"./badge-DHI6-K75.js";import{S as G,a as H,b as X,c as J,d as j}from"./select-CUUmJHIj.js";import{N as K}from"./navigation-CW6negEh.js";import{C as Q}from"./circle-alert-2nbFJPbt.js";import"./useQuery-Z-_QmTXa.js";function W({onSearch:o,placeholder:p="Search...",defaultValue:h="",isLoading:t=!1,className:f,debounceMs:l=300,minLength:i=2,showClearButton:n=!0,autoFocus:g=!1}){const[a,c]=r.useState(h),[d,m]=r.useState(h);r.useEffect(()=>{const x=setTimeout(()=>{m(a)},l);return()=>clearTimeout(x)},[a,l]),r.useEffect(()=>{(d.length>=i||d.length===0)&&o(d)},[d,i,o]);const v=r.useCallback(()=>{c(""),m(""),o("")},[o]),N=r.useCallback(x=>{x.preventDefault(),(a.length>=i||a.length===0)&&(m(a),o(a))},[a,i,o]);return e.jsx("form",{onSubmit:N,className:_("relative flex items-center",f),children:e.jsxs("div",{className:"relative flex-1",children:[e.jsx(B,{className:"absolute left-3 top-1/2 h-4 w-4 -translate-y-1/2 text-muted-foreground"}),e.jsx(z,{type:"text",value:a,onChange:x=>c(x.target.value),placeholder:p,className:"pl-10 pr-10",autoFocus:g,"aria-label":"Search"}),e.jsx("div",{className:"absolute right-2 top-1/2 -translate-y-1/2",children:t?e.jsx(P,{className:"h-4 w-4 animate-spin text-muted-foreground"}):n&&a&&e.jsx(u,{type:"button",variant:"ghost",size:"icon",className:"h-6 w-6",onClick:v,"aria-label":"Clear search",children:e.jsx(I,{className:"h-4 w-4"})})})]})})}const oe=function(){const{airport:p,filter:h}=L.useSearch(),[t,f]=r.useState(p),[l,i]=r.useState(h||"all"),[n,g]=r.useState(3e4),{data:a,isLoading:c,error:d,refetch:m}=t&&t.length===3?O(t,{type:l==="all"?void 0:l,enabled:!!t}):$();r.useEffect(()=>{if(n&&!c){const s=setInterval(()=>{m()},n);return()=>clearInterval(s)}},[n,m,c]);const v=s=>new Date(s*1e3).toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit"}),N=s=>s?`${Math.round(s*3.28084).toLocaleString()} ft`:"Ground",x=s=>s?`${Math.round(s*1.94384)} kts`:"N/A",F=s=>s.on_ground?{label:"On Ground",variant:"secondary"}:!s.velocity||s.velocity<50?{label:"Stationary",variant:"outline"}:s.vertical_rate&&s.vertical_rate>5?{label:"Climbing",variant:"default"}:s.vertical_rate&&s.vertical_rate<-5?{label:"Descending",variant:"default"}:{label:"Cruising",variant:"default"};return e.jsxs("div",{className:"container py-8 max-w-7xl mx-auto",children:[e.jsxs("div",{className:"mb-8",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(A,{className:"h-8 w-8 text-primary"}),e.jsx("h1",{className:"text-3xl font-bold",children:"Live Flight Tracker"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(G,{value:(n==null?void 0:n.toString())||"off",onValueChange:s=>g(s==="off"?null:Number(s)),children:[e.jsx(H,{className:"w-[140px]",children:e.jsx(X,{})}),e.jsxs(J,{children:[e.jsx(j,{value:"off",children:"No refresh"}),e.jsx(j,{value:"10000",children:"10 seconds"}),e.jsx(j,{value:"30000",children:"30 seconds"}),e.jsx(j,{value:"60000",children:"1 minute"})]})]}),e.jsxs(u,{onClick:()=>m(),variant:"outline",size:"sm",children:[e.jsx(E,{className:"h-4 w-4 mr-2"}),"Refresh"]})]})]}),e.jsxs("p",{className:"text-muted-foreground",children:["Track flights in real-time with data from OpenSky Network.",t?` Showing flights for ${t}.`:" Showing all active flights."]})]}),e.jsxs(b,{className:"mb-8",children:[e.jsxs(S,{children:[e.jsx(y,{children:"Filter Flights"}),e.jsx(T,{children:"Search by airport IATA code or view all flights"})]}),e.jsxs(C,{className:"space-y-4",children:[e.jsxs("div",{className:"flex gap-4",children:[e.jsx("div",{className:"flex-1",children:e.jsx(W,{onSearch:f,placeholder:"Filter by airport IATA code (e.g., LAX, JFK)",isLoading:c,value:t})}),t&&e.jsx(u,{variant:"outline",onClick:()=>f(""),children:"Clear Filter"})]}),t&&e.jsxs("div",{className:"flex gap-2",children:[e.jsx(u,{variant:l==="all"?"default":"outline",size:"sm",onClick:()=>i("all"),children:"All Flights"}),e.jsx(u,{variant:l==="arrivals"?"default":"outline",size:"sm",onClick:()=>i("arrivals"),children:"Arrivals Only"}),e.jsx(u,{variant:l==="departures"?"default":"outline",size:"sm",onClick:()=>i("departures"),children:"Departures Only"})]})]})]}),d&&e.jsx(R,{title:"Unable to load flights",message:"There was an error loading flight data. Please try again.",error:d}),c&&e.jsx("div",{className:"flex justify-center py-12",children:e.jsx(V,{text:"Loading live flight data..."})}),a&&a.length>0&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("h2",{className:"text-xl font-semibold",children:[a.length," Active Flight",a.length!==1?"s":""]}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:["Last updated: ",new Date().toLocaleTimeString()]})]}),e.jsx("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-3",children:a.slice(0,50).map(s=>{var k;const w=F(s);return e.jsxs(b,{className:"hover:shadow-lg transition-shadow",children:[e.jsx(S,{className:"pb-3",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{children:[e.jsxs(y,{className:"text-lg flex items-center gap-2",children:[((k=s.callsign)==null?void 0:k.trim())||s.icao24,s.callsign&&e.jsx(D,{to:"/flights/$flightId",params:{flightId:s.icao24},className:"text-primary hover:underline",children:e.jsx(K,{className:"h-4 w-4"})})]}),e.jsx(T,{children:s.origin_country})]}),e.jsx(q,{variant:w.variant,children:w.label})]})}),e.jsxs(C,{className:"space-y-3",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-3 text-sm",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-muted-foreground",children:"Altitude"}),e.jsx("p",{className:"font-medium",children:N(s.geo_altitude)})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-muted-foreground",children:"Speed"}),e.jsx("p",{className:"font-medium",children:x(s.velocity)})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-muted-foreground",children:"Heading"}),e.jsx("p",{className:"font-medium",children:s.true_track?`${Math.round(s.true_track)}Â°`:"N/A"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-muted-foreground",children:"Last Contact"}),e.jsx("p",{className:"font-medium",children:v(s.last_contact)})]})]}),s.vertical_rate&&Math.abs(s.vertical_rate)>0&&e.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[e.jsx(M,{className:`h-4 w-4 ${s.vertical_rate>0?"text-green-600":"text-red-600 rotate-180"}`}),e.jsxs("span",{className:"text-muted-foreground",children:[Math.abs(Math.round(s.vertical_rate*196.85))," ft/min"]})]})]})]},s.icao24)})}),a.length>50&&e.jsx("div",{className:"text-center py-4",children:e.jsxs("p",{className:"text-sm text-muted-foreground",children:["Showing first 50 flights of ",a.length," total"]})})]}),a&&a.length===0&&!c&&e.jsx(U,{title:"No flights found",message:t?`No active flights found for airport ${t}`:"No active flights found. This might be due to API limitations or temporary data unavailability.",icon:A}),e.jsxs(b,{className:"mt-8 border-amber-200 bg-amber-50 dark:border-amber-900 dark:bg-amber-950",children:[e.jsx(S,{className:"pb-3",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Q,{className:"h-5 w-5 text-amber-600"}),e.jsx(y,{className:"text-base",children:"OpenSky Network API Information"})]})}),e.jsx(C,{children:e.jsx("p",{className:"text-sm text-muted-foreground",children:"This tracker uses the free OpenSky Network API. Anonymous users are limited to 10 calls per day. For better performance and more frequent updates, consider registering for a free OpenSky account."})})]})]})};export{oe as component};
