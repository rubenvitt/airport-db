import{r as l,j as e,f as F,B as h,X as I,R as L,p as A,q as E,C as b,h as y,i as S,l as T,m as C,L as D}from"./main-C72e0wOY.js";import{u as O,a as $,T as M}from"./useFlights-Ji1xa5Ep.js";import{I as z}from"./input-Dcuoicru.js";import{S as B}from"./search-NRKEvCcW.js";import{L as P,a as R,N as V,B as U}from"./badge-D_v6iEMF.js";import{E as q}from"./config-CNtJ7dC6.js";import{S as G,a as H,b as X,c as J,d as p}from"./select-DoP4Ndxy.js";import{C as K}from"./circle-alert-Cyw8mw0u.js";function Q({onSearch:r,placeholder:j="Search...",defaultValue:o="",isLoading:t=!1,className:f,debounceMs:i=300,minLength:n=2,showClearButton:c=!0,autoFocus:g=!1}){const[a,d]=l.useState(o),[m,x]=l.useState(o);l.useEffect(()=>{const u=setTimeout(()=>{x(a)},i);return()=>clearTimeout(u)},[a,i]),l.useEffect(()=>{(m.length>=n||m.length===0)&&r(m)},[m,n,r]);const v=l.useCallback(()=>{d(""),x(""),r("")},[r]),N=l.useCallback(u=>{u.preventDefault(),(a.length>=n||a.length===0)&&(x(a),r(a))},[a,n,r]);return e.jsx("form",{onSubmit:N,className:F("relative flex items-center",f),children:e.jsxs("div",{className:"relative flex-1",children:[e.jsx(B,{className:"absolute left-3 top-1/2 h-4 w-4 -translate-y-1/2 text-muted-foreground"}),e.jsx(z,{type:"text",value:a,onChange:u=>d(u.target.value),placeholder:j,className:"pl-10 pr-10",autoFocus:g,"aria-label":"Search"}),e.jsx("div",{className:"absolute right-2 top-1/2 -translate-y-1/2",children:t?e.jsx(P,{className:"h-4 w-4 animate-spin text-muted-foreground"}):c&&a&&e.jsx(h,{type:"button",variant:"ghost",size:"icon",className:"h-6 w-6",onClick:v,"aria-label":"Clear search",children:e.jsx(I,{className:"h-4 w-4"})})})]})})}function W({icon:r,title:j,description:o,action:t,className:f}){return e.jsxs("div",{className:F("flex flex-col items-center justify-center space-y-4 py-12 text-center",f),children:[r&&e.jsx("div",{className:"rounded-full bg-muted p-4",children:e.jsx(r,{className:"h-8 w-8 text-muted-foreground"})}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("h3",{className:"text-lg font-semibold",children:j}),o&&e.jsx("p",{className:"text-sm text-muted-foreground max-w-sm mx-auto",children:o})]}),t&&e.jsx(h,{onClick:t.onClick,variant:"outline",children:t.label})]})}const ie=function(){const{airport:j,filter:o}=L.useSearch(),[t,f]=l.useState(j),[i,n]=l.useState(o||"all"),[c,g]=l.useState(3e4),{data:a,isLoading:d,error:m,refetch:x}=t&&t.length===3?O(t,{type:i==="all"?void 0:i,enabled:!!t}):$();l.useEffect(()=>{if(c&&!d){const s=setInterval(()=>{x()},c);return()=>clearInterval(s)}},[c,x,d]);const v=s=>new Date(s*1e3).toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit"}),N=s=>s?`${Math.round(s*3.28084).toLocaleString()} ft`:"Ground",u=s=>s?`${Math.round(s*1.94384)} kts`:"N/A",_=s=>s.on_ground?{label:"On Ground",variant:"secondary"}:!s.velocity||s.velocity<50?{label:"Stationary",variant:"outline"}:s.vertical_rate&&s.vertical_rate>5?{label:"Climbing",variant:"default"}:s.vertical_rate&&s.vertical_rate<-5?{label:"Descending",variant:"default"}:{label:"Cruising",variant:"default"};return e.jsxs("div",{className:"container py-8 max-w-7xl mx-auto",children:[e.jsxs("div",{className:"mb-8",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(A,{className:"h-8 w-8 text-primary"}),e.jsx("h1",{className:"text-3xl font-bold",children:"Live Flight Tracker"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(G,{value:(c==null?void 0:c.toString())||"off",onValueChange:s=>g(s==="off"?null:Number(s)),children:[e.jsx(H,{className:"w-[140px]",children:e.jsx(X,{})}),e.jsxs(J,{children:[e.jsx(p,{value:"off",children:"No refresh"}),e.jsx(p,{value:"10000",children:"10 seconds"}),e.jsx(p,{value:"30000",children:"30 seconds"}),e.jsx(p,{value:"60000",children:"1 minute"})]})]}),e.jsxs(h,{onClick:()=>x(),variant:"outline",size:"sm",children:[e.jsx(E,{className:"h-4 w-4 mr-2"}),"Refresh"]})]})]}),e.jsxs("p",{className:"text-muted-foreground",children:["Track flights in real-time with data from OpenSky Network.",t?` Showing flights for ${t}.`:" Showing all active flights."]})]}),e.jsxs(b,{className:"mb-8",children:[e.jsxs(y,{children:[e.jsx(S,{children:"Filter Flights"}),e.jsx(T,{children:"Search by airport IATA code or view all flights"})]}),e.jsxs(C,{className:"space-y-4",children:[e.jsxs("div",{className:"flex gap-4",children:[e.jsx("div",{className:"flex-1",children:e.jsx(Q,{onSearch:f,placeholder:"Filter by airport IATA code (e.g., LAX, JFK)",isLoading:d,value:t})}),t&&e.jsx(h,{variant:"outline",onClick:()=>f(""),children:"Clear Filter"})]}),t&&e.jsxs("div",{className:"flex gap-2",children:[e.jsx(h,{variant:i==="all"?"default":"outline",size:"sm",onClick:()=>n("all"),children:"All Flights"}),e.jsx(h,{variant:i==="arrivals"?"default":"outline",size:"sm",onClick:()=>n("arrivals"),children:"Arrivals Only"}),e.jsx(h,{variant:i==="departures"?"default":"outline",size:"sm",onClick:()=>n("departures"),children:"Departures Only"})]})]})]}),m&&e.jsx(q,{title:"Unable to load flights",message:"There was an error loading flight data. Please try again.",error:m}),d&&e.jsx("div",{className:"flex justify-center py-12",children:e.jsx(R,{text:"Loading live flight data..."})}),a&&a.length>0&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("h2",{className:"text-xl font-semibold",children:[a.length," Active Flight",a.length!==1?"s":""]}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:["Last updated: ",new Date().toLocaleTimeString()]})]}),e.jsx("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-3",children:a.slice(0,50).map(s=>{var k;const w=_(s);return e.jsxs(b,{className:"hover:shadow-lg transition-shadow",children:[e.jsx(y,{className:"pb-3",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{children:[e.jsxs(S,{className:"text-lg flex items-center gap-2",children:[((k=s.callsign)==null?void 0:k.trim())||s.icao24,s.callsign&&e.jsx(D,{to:"/flights/$flightId",params:{flightId:s.icao24},className:"text-primary hover:underline",children:e.jsx(V,{className:"h-4 w-4"})})]}),e.jsx(T,{children:s.origin_country})]}),e.jsx(U,{variant:w.variant,children:w.label})]})}),e.jsxs(C,{className:"space-y-3",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-3 text-sm",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-muted-foreground",children:"Altitude"}),e.jsx("p",{className:"font-medium",children:N(s.geo_altitude)})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-muted-foreground",children:"Speed"}),e.jsx("p",{className:"font-medium",children:u(s.velocity)})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-muted-foreground",children:"Heading"}),e.jsx("p",{className:"font-medium",children:s.true_track?`${Math.round(s.true_track)}Â°`:"N/A"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-muted-foreground",children:"Last Contact"}),e.jsx("p",{className:"font-medium",children:v(s.last_contact)})]})]}),s.vertical_rate&&Math.abs(s.vertical_rate)>0&&e.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[e.jsx(M,{className:`h-4 w-4 ${s.vertical_rate>0?"text-green-600":"text-red-600 rotate-180"}`}),e.jsxs("span",{className:"text-muted-foreground",children:[Math.abs(Math.round(s.vertical_rate*196.85))," ft/min"]})]})]})]},s.icao24)})}),a.length>50&&e.jsx("div",{className:"text-center py-4",children:e.jsxs("p",{className:"text-sm text-muted-foreground",children:["Showing first 50 flights of ",a.length," total"]})})]}),a&&a.length===0&&!d&&e.jsx(W,{title:"No flights found",message:t?`No active flights found for airport ${t}`:"No active flights found. This might be due to API limitations or temporary data unavailability.",icon:A}),e.jsxs(b,{className:"mt-8 border-amber-200 bg-amber-50 dark:border-amber-900 dark:bg-amber-950",children:[e.jsx(y,{className:"pb-3",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(K,{className:"h-5 w-5 text-amber-600"}),e.jsx(S,{className:"text-base",children:"OpenSky Network API Information"})]})}),e.jsx(C,{children:e.jsx("p",{className:"text-sm text-muted-foreground",children:"This tracker uses the free OpenSky Network API. Anonymous users are limited to 10 calls per day. For better performance and more frequent updates, consider registering for a free OpenSky account."})})]})]})};export{ie as component};
