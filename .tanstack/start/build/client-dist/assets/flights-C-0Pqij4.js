import{R as T,r as c,j as e,p as N,B as n,C as x,h,i as u,l as b,m as p,L}from"./main-CFvVkEqF.js";import{u as _,a as I,T as E}from"./useFlights-DNiIIlpO.js";import{S as M}from"./SearchBar-DjQTFqut.js";import{E as O,L as $}from"./config-rvPVdp9M.js";import{E as B}from"./EmptyState-jxTgstOS.js";import{B as D}from"./badge-Dc-pGAuT.js";import{S as P,a as R,b as z,c as U,d as o}from"./select-CHeCbzJO.js";import{C as G}from"./clock-B7djlEqd.js";import{N as H}from"./navigation-CTHDuNs-.js";import{C as V}from"./circle-alert-rxN8EaoI.js";import"./useQuery-BtUuMQTT.js";import"./input-DBD37HuN.js";import"./search-zl_FgLu0.js";const le=function(){const{airport:S,filter:y}=T.useSearch(),[a,f]=c.useState(S),[i,d]=c.useState(y||"all"),[r,k]=c.useState(3e4),{data:t,isLoading:l,error:j,refetch:m}=a&&a.length===3?_(a,{type:i==="all"?void 0:i,enabled:!!a}):I();c.useEffect(()=>{if(r&&!l){const s=setInterval(()=>{m()},r);return()=>clearInterval(s)}},[r,m,l]);const w=s=>new Date(s*1e3).toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit"}),C=s=>s?`${Math.round(s*3.28084).toLocaleString()} ft`:"Ground",A=s=>s?`${Math.round(s*1.94384)} kts`:"N/A",F=s=>s.on_ground?{label:"On Ground",variant:"secondary"}:!s.velocity||s.velocity<50?{label:"Stationary",variant:"outline"}:s.vertical_rate&&s.vertical_rate>5?{label:"Climbing",variant:"default"}:s.vertical_rate&&s.vertical_rate<-5?{label:"Descending",variant:"default"}:{label:"Cruising",variant:"default"};return e.jsxs("div",{className:"container py-8 max-w-7xl mx-auto",children:[e.jsxs("div",{className:"mb-8",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(N,{className:"h-8 w-8 text-primary"}),e.jsx("h1",{className:"text-3xl font-bold",children:"Live Flight Tracker"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(P,{value:(r==null?void 0:r.toString())||"off",onValueChange:s=>k(s==="off"?null:Number(s)),children:[e.jsx(R,{className:"w-[140px]",children:e.jsx(z,{})}),e.jsxs(U,{children:[e.jsx(o,{value:"off",children:"No refresh"}),e.jsx(o,{value:"10000",children:"10 seconds"}),e.jsx(o,{value:"30000",children:"30 seconds"}),e.jsx(o,{value:"60000",children:"1 minute"})]})]}),e.jsxs(n,{onClick:()=>m(),variant:"outline",size:"sm",children:[e.jsx(G,{className:"h-4 w-4 mr-2"}),"Refresh"]})]})]}),e.jsxs("p",{className:"text-muted-foreground",children:["Track flights in real-time with data from OpenSky Network.",a?` Showing flights for ${a}.`:" Showing all active flights."]})]}),e.jsxs(x,{className:"mb-8",children:[e.jsxs(h,{children:[e.jsx(u,{children:"Filter Flights"}),e.jsx(b,{children:"Search by airport IATA code or view all flights"})]}),e.jsxs(p,{className:"space-y-4",children:[e.jsxs("div",{className:"flex gap-4",children:[e.jsx("div",{className:"flex-1",children:e.jsx(M,{onSearch:f,placeholder:"Filter by airport IATA code (e.g., LAX, JFK)",isLoading:l,value:a})}),a&&e.jsx(n,{variant:"outline",onClick:()=>f(""),children:"Clear Filter"})]}),a&&e.jsxs("div",{className:"flex gap-2",children:[e.jsx(n,{variant:i==="all"?"default":"outline",size:"sm",onClick:()=>d("all"),children:"All Flights"}),e.jsx(n,{variant:i==="arrivals"?"default":"outline",size:"sm",onClick:()=>d("arrivals"),children:"Arrivals Only"}),e.jsx(n,{variant:i==="departures"?"default":"outline",size:"sm",onClick:()=>d("departures"),children:"Departures Only"})]})]})]}),j&&e.jsx(O,{title:"Unable to load flights",message:"There was an error loading flight data. Please try again.",error:j}),l&&e.jsx("div",{className:"flex justify-center py-12",children:e.jsx($,{text:"Loading live flight data..."})}),t&&t.length>0&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("h2",{className:"text-xl font-semibold",children:[t.length," Active Flight",t.length!==1?"s":""]}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:["Last updated: ",new Date().toLocaleTimeString()]})]}),e.jsx("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-3",children:t.slice(0,50).map(s=>{var v;const g=F(s);return e.jsxs(x,{className:"hover:shadow-lg transition-shadow",children:[e.jsx(h,{className:"pb-3",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{children:[e.jsxs(u,{className:"text-lg flex items-center gap-2",children:[((v=s.callsign)==null?void 0:v.trim())||s.icao24,s.callsign&&e.jsx(L,{to:"/flights/$flightId",params:{flightId:s.icao24},className:"text-primary hover:underline",children:e.jsx(H,{className:"h-4 w-4"})})]}),e.jsx(b,{children:s.origin_country})]}),e.jsx(D,{variant:g.variant,children:g.label})]})}),e.jsxs(p,{className:"space-y-3",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-3 text-sm",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-muted-foreground",children:"Altitude"}),e.jsx("p",{className:"font-medium",children:C(s.geo_altitude)})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-muted-foreground",children:"Speed"}),e.jsx("p",{className:"font-medium",children:A(s.velocity)})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-muted-foreground",children:"Heading"}),e.jsx("p",{className:"font-medium",children:s.true_track?`${Math.round(s.true_track)}Â°`:"N/A"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-muted-foreground",children:"Last Contact"}),e.jsx("p",{className:"font-medium",children:w(s.last_contact)})]})]}),s.vertical_rate&&Math.abs(s.vertical_rate)>0&&e.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[e.jsx(E,{className:`h-4 w-4 ${s.vertical_rate>0?"text-green-600":"text-red-600 rotate-180"}`}),e.jsxs("span",{className:"text-muted-foreground",children:[Math.abs(Math.round(s.vertical_rate*196.85))," ft/min"]})]})]})]},s.icao24)})}),t.length>50&&e.jsx("div",{className:"text-center py-4",children:e.jsxs("p",{className:"text-sm text-muted-foreground",children:["Showing first 50 flights of ",t.length," total"]})})]}),t&&t.length===0&&!l&&e.jsx(B,{title:"No flights found",message:a?`No active flights found for airport ${a}`:"No active flights found. This might be due to API limitations or temporary data unavailability.",icon:N}),e.jsxs(x,{className:"mt-8 border-amber-200 bg-amber-50 dark:border-amber-900 dark:bg-amber-950",children:[e.jsx(h,{className:"pb-3",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(V,{className:"h-5 w-5 text-amber-600"}),e.jsx(u,{className:"text-base",children:"OpenSky Network API Information"})]})}),e.jsx(p,{children:e.jsx("p",{className:"text-sm text-muted-foreground",children:"This tracker uses the free OpenSky Network API. Anonymous users are limited to 10 calls per day. For better performance and more frequent updates, consider registering for a free OpenSky account."})})]})]})};export{le as component};
